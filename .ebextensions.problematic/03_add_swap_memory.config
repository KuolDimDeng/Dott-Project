commands:
  01_add_swap:
    command: |
      #!/bin/bash
      SWAPFILE=/var/swapfile
      if [ ! -f $SWAPFILE ]; then
        echo "Creating 1GB swap file..."
        dd if=/dev/zero of=$SWAPFILE bs=1M count=1024
        chmod 600 $SWAPFILE
        mkswap $SWAPFILE
        swapon $SWAPFILE
        echo "$SWAPFILE swap swap defaults 0 0" >> /etc/fstab
        echo "Swap file created and enabled"
      else
        echo "Swap file already exists"
      fi
    ignoreErrors: true
    
  02_optimize_system:
    command: |
      #!/bin/bash
      # Optimize system for better performance on t3.small
      echo "vm.swappiness=10" >> /etc/sysctl.conf
      echo "vm.vfs_cache_pressure=50" >> /etc/sysctl.conf
      sysctl -p
    ignoreErrors: true 