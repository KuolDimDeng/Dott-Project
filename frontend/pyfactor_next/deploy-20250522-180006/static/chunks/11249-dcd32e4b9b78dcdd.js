"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[11249],{19596:(e,t,o)=>{o.d(t,{kd:()=>a});let a={BUSINESS_INFO:"business-info",SUBSCRIPTION:"subscription",PAYMENT:"payment",SETUP:"setup",COMPLETE:"complete",DASHBOARD:"dashboard"}},25465:(e,t,o)=>{o.d(t,{L8:()=>s});var a=o(52584),n=o(24818),r=o(42749);async function s(){try{let e=performance.now(),t=!1,o=crypto.randomUUID();r.vF.debug("[OnboardingUtils] Starting onboarding completion",{requestId:o,timestamp:new Date().toISOString()});let s={"custom:onboarding":"complete","custom:setupdone":"true","custom:updated_at":new Date().toISOString(),"custom:onboardingCompletedAt":new Date().toISOString()};try{await (0,a.u)({userAttributes:s}),t=!0,window.__APP_CACHE=window.__APP_CACHE||{},window.__APP_CACHE.onboarding=window.__APP_CACHE.onboarding||{},window.__APP_CACHE.onboarding.status="complete",window.__APP_CACHE.onboarding.step="complete",window.__APP_CACHE.onboarding.completed=!0,r.vF.debug("[OnboardingUtils] Attributes updated via Amplify",{requestId:o,method:"direct_amplify",elapsedMs:performance.now()-e})}catch(a){r.vF.error("[OnboardingUtils] Amplify update failed",{requestId:o,error:a.message,code:a.code,elapsedMs:performance.now()-e});try{let{tokens:a}=await (0,n.$)(),i=await fetch("/api/user/update-attributes",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a.accessToken),"X-Request-ID":o},body:JSON.stringify({attributes:s,forceUpdate:!0})});if(i.ok){let a=await i.json();t=!0,r.vF.debug("[OnboardingUtils] Attributes updated via API call",{requestId:o,method:"api_call",result:a,elapsedMs:performance.now()-e})}else throw Error("API returned status ".concat(i.status))}catch(a){r.vF.error("[OnboardingUtils] API update failed",{requestId:o,error:a.message,elapsedMs:performance.now()-e});try{let a=await fetch("/api/onboarding/complete",{method:"POST",headers:{"Content-Type":"application/json","X-Request-ID":o}});if(a.ok)t=!0,r.vF.debug("[OnboardingUtils] Completion via dedicated endpoint succeeded",{requestId:o,method:"complete_endpoint",elapsedMs:performance.now()-e});else throw Error("Complete endpoint returned status ".concat(a.status))}catch(t){throw r.vF.error("[OnboardingUtils] All update methods failed",{requestId:o,completeError:t.message,elapsedMs:performance.now()-e}),Error("Failed to complete onboarding after multiple attempts")}}}return r.vF.debug("[OnboardingUtils] Onboarding completion process finished",{requestId:o,success:t,elapsedMs:performance.now()-e}),t}catch(e){throw r.vF.error("[OnboardingUtils] Failed to complete onboarding:",{error:e.message,code:e.code,stack:e.stack}),e}}o(28835),o(39786),o(60584),o(19596),o(99944),o(29670)},77657:(e,t,o)=>{o.d(t,{A:()=>n});var a=o(95155);function n(e){let{size:t="medium",fullscreen:o=!1,message:n="Loading...",color:r="currentColor"}=e,s={small:{spinner:"h-4 w-4",text:"text-sm"},medium:{spinner:"h-8 w-8",text:"text-base"},large:{spinner:"h-12 w-12",text:"text-lg"}},i=s[t]||s.medium;return(0,a.jsx)("div",{className:o?"fixed inset-0 z-50 flex items-center justify-center bg-white bg-opacity-80":"flex flex-col items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("div",{className:"".concat(i.spinner," animate-spin"),style:{color:r},children:(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:"opacity-25",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),n&&(0,a.jsx)("div",{className:"mt-3 ".concat(i.text," text-gray-700"),children:n})]})})}o(12115)}}]);