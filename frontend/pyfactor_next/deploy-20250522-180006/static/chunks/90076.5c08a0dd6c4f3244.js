"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[90076],{90076:(e,s,a)=>{a.r(s),a.d(s,{default:()=>n});var t=a(95155),l=a(12115);function n(){let[e,s]=(0,l.useState)(null),[a,n]=(0,l.useState)(null),[r,c]=(0,l.useState)(!1),[d,o]=(0,l.useState)("both"),[i,m]=(0,l.useState)(null),b=async()=>{c(!0),m(null);try{let e=await fetch("/api/tenant/test-database"),a=await e.json();s(a)}catch(e){m("Error testing databases: ".concat(e.message)),console.error("Database test error:",e)}finally{c(!1)}},h=async()=>{c(!0),m(null),n(null);try{let e=await fetch("/api/tenant/sync-databases?direction=".concat(d)),s=await e.json();n(s)}catch(e){m("Error synchronizing databases: ".concat(e.message)),console.error("Database sync error:",e)}finally{c(!1)}};return(0,t.jsxs)("div",{className:"p-4 bg-white rounded-lg shadow",children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Database Administration"}),(0,t.jsxs)("div",{className:"mb-6 border-b pb-4",children:[(0,t.jsx)("h3",{className:"text-lg font-medium mb-3",children:"Test Database Connections"}),(0,t.jsx)("button",{onClick:b,disabled:r,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:r?"Testing...":"Test Connections"}),e&&(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("h4",{className:"font-medium",children:"Test Results:"}),(0,t.jsxs)("div",{className:"mt-2 grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"p-3 rounded-lg ".concat(e.localDatabase.success?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"),children:[(0,t.jsx)("h5",{className:"font-medium",children:"Local Database"}),(0,t.jsxs)("p",{className:"text-sm",children:["Host: ",e.localDatabase.config.host]}),(0,t.jsxs)("p",{className:"text-sm",children:["Database: ",e.localDatabase.config.database]}),(0,t.jsxs)("p",{className:"text-sm",children:["Status: ",e.localDatabase.success?"✅ Connected":"❌ Failed"]}),!e.localDatabase.success&&(0,t.jsx)("p",{className:"text-sm text-red-600",children:e.localDatabase.error})]}),(0,t.jsxs)("div",{className:"p-3 rounded-lg ".concat(e.djangoDatabase.success?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"),children:[(0,t.jsx)("h5",{className:"font-medium",children:"Django Database (AWS RDS)"}),(0,t.jsxs)("p",{className:"text-sm",children:["Host: ",e.djangoDatabase.config.host]}),(0,t.jsxs)("p",{className:"text-sm",children:["Database: ",e.djangoDatabase.config.database]}),(0,t.jsxs)("p",{className:"text-sm",children:["Status: ",e.djangoDatabase.success?"✅ Connected":"❌ Failed"]}),!e.djangoDatabase.success&&(0,t.jsx)("p",{className:"text-sm text-red-600",children:e.djangoDatabase.error})]})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-medium mb-3",children:"Synchronize Tenant Data"}),(0,t.jsxs)("div",{className:"flex items-center mb-4",children:[(0,t.jsx)("label",{className:"mr-3",children:"Direction:"}),(0,t.jsxs)("select",{value:d,onChange:e=>o(e.target.value),className:"px-3 py-2 border rounded",children:[(0,t.jsx)("option",{value:"both",children:"Both Ways"}),(0,t.jsx)("option",{value:"to-django",children:"Local → Django"}),(0,t.jsx)("option",{value:"to-local",children:"Django → Local"})]})]}),(0,t.jsx)("button",{onClick:h,disabled:r,className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 disabled:opacity-50",children:r?"Synchronizing...":"Synchronize Databases"}),a&&(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("h4",{className:"font-medium",children:"Synchronization Results:"}),(0,t.jsxs)("div",{className:"mt-2 p-3 bg-gray-50 rounded-lg border",children:[(0,t.jsxs)("p",{children:["Status: ",a.success?"✅ Success":"❌ Failed"]}),a.success&&a.output&&(0,t.jsx)("pre",{className:"mt-2 p-2 bg-gray-100 rounded text-xs max-h-40 overflow-auto",children:a.output}),a.warnings&&(0,t.jsxs)("div",{className:"mt-2",children:[(0,t.jsx)("p",{className:"text-yellow-600 font-medium",children:"Warnings:"}),(0,t.jsx)("pre",{className:"p-2 bg-yellow-50 rounded text-xs max-h-20 overflow-auto",children:a.warnings})]}),!a.success&&a.error&&(0,t.jsx)("p",{className:"mt-2 text-red-600",children:a.error})]})]})]}),i&&(0,t.jsx)("div",{className:"mt-4 p-3 bg-red-50 text-red-700 rounded-lg border border-red-200",children:i})]})}}}]);