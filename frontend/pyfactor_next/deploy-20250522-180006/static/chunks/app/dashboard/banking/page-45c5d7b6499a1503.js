(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[79401,85572],{11811:(e,t,a)=>{Promise.resolve().then(a.bind(a,13198))},13198:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});var r=a(95155);a(12115);var n=a(79401);function s(){return(0,r.jsx)("div",{className:"flex flex-col items-stretch w-full h-full p-4",children:(0,r.jsx)(n.default,{})})}},36465:(e,t,a)=>{"use strict";function r(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},s=Object.keys(e);for(r=0;r<s.length;r++)a=s[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)a=s[r],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}a.r(t),a.d(t,{_:()=>r})},37811:e=>{var t,a,r,n=e.exports={};function s(){throw Error("setTimeout has not been defined")}function l(){throw Error("clearTimeout has not been defined")}try{t="function"==typeof setTimeout?setTimeout:s}catch(e){t=s}try{a="function"==typeof clearTimeout?clearTimeout:l}catch(e){a=l}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===s||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(a){try{return t.call(null,e,0)}catch(a){return t.call(this,e,0)}}}var o=[],c=!1,d=-1;function u(){c&&r&&(c=!1,r.length?o=r.concat(o):d=-1,o.length&&h())}function h(){if(!c){var e=i(u);c=!0;for(var t=o.length;t;){for(r=o,o=[];++d<t;)r&&r[d].run();d=-1,t=o.length}r=null,c=!1,function(e){if(a===clearTimeout)return clearTimeout(e);if((a===l||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(e);try{a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}(e)}}function x(e,t){this.fun=e,this.array=t}function m(){}n.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var a=1;a<arguments.length;a++)t[a-1]=arguments[a];o.push(new x(e,t)),1!==o.length||c||i(h)},x.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=m,n.addListener=m,n.once=m,n.off=m,n.removeListener=m,n.removeAllListeners=m,n.emit=m,n.prependListener=m,n.prependOnceListener=m,n.listeners=function(e){return[]},n.binding=function(e){throw Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw Error("process.chdir is not supported")},n.umask=function(){return 0}},79401:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>o});var r=a(95155),n=a(12115),s=a(29729),l=a(6874),i=a.n(l);let o=()=>{let[e,t]=(0,n.useState)([]),[a,l]=(0,n.useState)([]),[o,c]=(0,n.useState)(!0),[d,u]=(0,n.useState)(null),[h,x]=(0,n.useState)(""),[m,g]=(0,n.useState)(""),[f,p]=(0,n.useState)(""),[b,v]=(0,n.useState)(null),w=(0,n.useCallback)(async()=>{try{c(!0);let e=await s.SP.get("/api/banking/accounts/");e.data.accounts&&Array.isArray(e.data.accounts)?(t(e.data.accounts),e.data.accounts.length>0?v(e.data.accounts[0].name.split(" ")[0]):v(null)):(t([]),v(null))}catch(e){console.error("Error fetching banking accounts:",e),u("Failed to fetch banking accounts. Please try again later."),v(null)}finally{c(!1)}},[]),y=(0,n.useCallback)(async()=>{if(!b)return void l([]);try{let e=await s.SP.get("/api/banking/recent-transactions/",{params:{limit:10}});e.data.transactions&&Array.isArray(e.data.transactions)?l(e.data.transactions):l([])}catch(e){console.error("Error fetching recent transactions:",e),u("Failed to fetch recent transactions. Please try again later.")}},[b]);(0,n.useEffect)(()=>{w()},[w]),(0,n.useEffect)(()=>{y()},[y]);let j=async()=>{if(!b)return void u("Please connect a bank account before downloading transactions.");try{let e=await s.SP.get("/api/banking/download-transactions/",{params:{start_date:h,end_date:m},responseType:"blob"}),t=window.URL.createObjectURL(new Blob([e.data])),a=document.createElement("a");a.href=t,a.setAttribute("download","transactions_".concat(h,"_to_").concat(m,".csv")),document.body.appendChild(a),a.click()}catch(e){console.error("Error downloading transactions:",e),u("Failed to download transactions. Please try again.")}},N=a.filter(e=>e.description.toLowerCase().includes(f.toLowerCase()));return o?(0,r.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):d?(0,r.jsx)("div",{className:"text-red-600 p-4",children:d}):(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center mb-2",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 mr-3 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 14v3m4-3v3m4-3v3M3 21h18M3 10h18M3 7l9-4 9 4M4 10h16v11H4V10z"})}),(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"Banking Dashboard"})]}),(0,r.jsx)("p",{className:"ml-12 mb-6 text-gray-600",children:"Manage your accounts, download transactions, and view recent activity"}),(0,r.jsxs)("h2",{className:"text-xl font-semibold mb-4 text-indigo-600",children:["Connected Bank: ",b||"None",!b&&(0,r.jsxs)("span",{className:"ml-2 font-normal text-base text-gray-700",children:["Please link a banking institution",(0,r.jsx)(i(),{href:"/connect-bank",className:"ml-1 text-blue-600 hover:underline",children:"here"}),"."]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsx)("div",{className:"col-span-1",children:(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg h-full flex flex-col justify-between",children:[(0,r.jsxs)("div",{className:"p-6 flex-grow",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Bank Accounts"}),e.length>0?(0,r.jsx)("ul",{className:"divide-y divide-gray-200",children:e.map(e=>{var t;return(0,r.jsxs)("li",{className:"py-3",children:[(0,r.jsx)("p",{className:"font-medium",children:e.name}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Balance: $",(null==(t=e.balances)?void 0:t.current)||"N/A"]})]},e.account_id)})}):(0,r.jsx)("p",{children:"No accounts found. Please connect a bank account to get started."})]}),(0,r.jsx)("div",{className:"px-6 py-4 border-t border-gray-200",children:(0,r.jsxs)("button",{onClick:w,className:"flex items-center text-indigo-600 hover:text-indigo-800 border border-indigo-600 px-4 py-2 rounded-md",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z",clipRule:"evenodd"})}),"Refresh Accounts"]})})]})}),(0,r.jsx)("div",{className:"col-span-1",children:(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg h-full flex flex-col justify-between",children:[(0,r.jsxs)("div",{className:"p-6 flex-grow",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Download Transactions"}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),(0,r.jsx)("input",{type:"date",value:h,onChange:e=>x(e.target.value),className:"w-full p-2 border border-gray-300 rounded-md ".concat(b?"focus:ring-indigo-500 focus:border-indigo-500":"bg-gray-100 cursor-not-allowed"),disabled:!b})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),(0,r.jsx)("input",{type:"date",value:m,onChange:e=>g(e.target.value),className:"w-full p-2 border border-gray-300 rounded-md ".concat(b?"focus:ring-indigo-500 focus:border-indigo-500":"bg-gray-100 cursor-not-allowed"),disabled:!b})]})]}),(0,r.jsx)("div",{className:"px-6 py-4 border-t border-gray-200",children:(0,r.jsxs)("button",{onClick:j,disabled:!b||!h||!m,className:"w-full flex justify-center items-center px-4 py-2 rounded-md ".concat(b&&h&&m?"bg-indigo-600 hover:bg-indigo-700 text-white":"bg-indigo-300 cursor-not-allowed text-white"),children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})}),"Download Transactions"]})})]})}),(0,r.jsx)("div",{className:"col-span-1 md:col-span-2",children:(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg h-full flex flex-col justify-between",children:[(0,r.jsxs)("div",{className:"p-6 flex-grow",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Recent Transactions"}),(0,r.jsxs)("div",{className:"relative mb-4",children:[(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"})})}),(0,r.jsx)("input",{type:"text",placeholder:"Search transactions...",value:f,onChange:e=>p(e.target.value),className:"w-full pl-10 p-2 border border-gray-300 rounded-md ".concat(b?"focus:ring-indigo-500 focus:border-indigo-500":"bg-gray-100 cursor-not-allowed"),disabled:!b})]}),b?(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:N.length>0?N.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.description}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-right",children:new Date(e.date).toLocaleDateString()}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-right",children:["$",e.amount.toFixed(2)]})]},e.id)):(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:3,className:"px-6 py-4 text-center text-sm text-gray-500",children:"No transactions found."})})})]})}):(0,r.jsx)("p",{className:"text-gray-600",children:"Please connect a bank account to view recent transactions."})]}),(0,r.jsx)("div",{className:"px-6 py-4 border-t border-gray-200",children:(0,r.jsxs)("button",{onClick:y,disabled:!b,className:"flex items-center px-4 py-2 rounded-md ".concat(b?"text-indigo-600 hover:text-indigo-800 border border-indigo-600":"border border-gray-300 text-gray-400 cursor-not-allowed"),children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z",clipRule:"evenodd"})}),"Refresh Transactions"]})})]})})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[54940,20171,79189,6874,29729,28441,31684,77358],()=>t(11811)),_N_E=e.O()}]);