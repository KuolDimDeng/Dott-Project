(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[46501],{18669:(e,t,a)=>{"use strict";var n=a(42749)},28696:(e,t,a)=>{Promise.resolve().then(a.bind(a,44875))},44875:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>l});var n=a(95155),r=a(12115),c=a(51221),s=a(29729),i=a(18669);let o=()=>{let[e,t]=(0,r.useState)("connect"),[a,o]=(0,r.useState)(""),[l,d]=(0,r.useState)(null),[x,u]=(0,r.useState)([]),[m,h]=(0,r.useState)(!0),[p,y]=(0,r.useState)(null);(0,r.useEffect)(()=>{let e=async()=>{try{let e=await (0,i.getAttributeValue)("custom:businesscountry");return o(e||"US"),e||"US"}catch(e){return console.error("Error fetching business country:",e),o("US"),"US"}},t=async()=>{try{h(!0);let e=await s.SP.get("/api/banking/connected-accounts/");e.data&&Array.isArray(e.data.accounts)?u(e.data.accounts):u([])}catch(e){console.error("Error fetching connected accounts:",e),y("Failed to fetch connected accounts. Please try again later.")}finally{h(!1)}},a=async e=>{try{let t=await s.SP.get("/api/banking/payment-gateway/?country=".concat(e));if(!t.data||!t.data.primary)return console.warn("No payment gateway found for country ".concat(e,", using default")),d("plaid"),"plaid";{let a=t.data.primary.toLowerCase();return d(a),console.log("Using payment gateway for ".concat(e,": ").concat(a)),a}}catch(e){return console.error("Error fetching payment gateway:",e),d("plaid"),"plaid"}};(async()=>{let n=await e();await a(n),await t()})()},[]);let g=e=>{t(e)},b=async e=>{if(window.confirm("Are you sure you want to disconnect this account?"))try{await s.SP.delete("/api/banking/connected-accounts/".concat(e,"/")),u(x.filter(t=>t.id!==e))}catch(e){console.error("Error disconnecting account:",e),y("Failed to disconnect account. Please try again later.")}};return(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-sm",children:[(0,n.jsx)("div",{className:"flex items-center border-b border-gray-200 mb-4",children:(0,n.jsx)("h1",{className:"text-2xl font-bold p-6",children:"Banking Connection Manager"})}),(0,n.jsx)("div",{className:"border-b border-gray-200",children:(0,n.jsxs)("nav",{className:"flex -mb-px",children:[(0,n.jsx)("button",{className:"py-4 px-6 text-center border-b-2 font-medium text-sm ".concat("connect"===e?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),onClick:()=>g("connect"),children:"Connect Bank"}),(0,n.jsx)("button",{className:"py-4 px-6 text-center border-b-2 font-medium text-sm ".concat("manage"===e?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),onClick:()=>g("manage"),children:"Manage Connections"})]})}),(0,n.jsx)("div",{className:"p-4",children:(()=>{switch(e){case"connect":return(0,n.jsx)(c.default,{preferredProvider:l,businessCountry:a,autoConnect:!0});case"manage":return(0,n.jsxs)("div",{className:"p-4",children:[(0,n.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Manage Connected Accounts"}),m?(0,n.jsx)("div",{className:"flex justify-center",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-blue-500"})}):p?(0,n.jsx)("div",{className:"text-red-500",children:p}):0===x.length?(0,n.jsxs)("div",{className:"text-center py-10",children:[(0,n.jsx)("p",{className:"text-gray-500",children:"No bank accounts connected yet."}),(0,n.jsx)("button",{className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",onClick:()=>t("connect"),children:"Connect Your First Account"})]}):(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,n.jsx)("thead",{className:"bg-gray-50",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Bank"}),(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Account Type"}),(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Balance"}),(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Provider"}),(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,n.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map((e,t)=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.name}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.account_type||"Unknown"}),(0,n.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["$",e.balance.toFixed(2)]}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.provider}),(0,n.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[(0,n.jsx)("button",{className:"text-indigo-600 hover:text-indigo-900 mr-2",children:"View"}),(0,n.jsx)("button",{className:"text-red-600 hover:text-red-900",onClick:()=>b(e.id),children:"Disconnect"})]})]},t))})]})}),(0,n.jsx)("button",{className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",onClick:()=>t("connect"),children:"Connect Another Account"})]})]});default:return null}})()})]})};function l(){return(0,n.jsx)("div",{className:"flex flex-col items-stretch w-full h-full p-4",children:(0,n.jsx)(o,{})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[54940,20171,79189,10849,29729,51221,28441,31684,77358],()=>t(28696)),_N_E=e.O()}]);