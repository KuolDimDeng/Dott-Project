(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[21954,47856],{12743:(e,t,n)=>{"use strict";n.d(t,{A:()=>o}),n(95155);var r=n(12115),a=n(29729);function o(){let[e,t]=(0,r.useState)(!1),[n,o]=(0,r.useState)("");return(0,r.useEffect)(()=>(t("https:"===window.location.protocol),window.__resetCircuitBreakers=a.resetCircuitBreakers,window.resetCircuitBreakers=()=>((0,a.resetCircuitBreakers)(),console.log("[HttpsConfig] Circuit breakers manually reset"),!0),"https:"===window.location.protocol&&((0,a.resetCircuitBreakers)(),console.log("[HttpsConfig] Circuit breakers auto-reset for HTTPS mode")),()=>{delete window.__resetCircuitBreakers}),[]),null}},14729:(e,t,n)=>{"use strict";n.d(t,{VV:()=>r});let r=()=>new Promise((e,t)=>{if(window.Stripe)return void e();let n=document.createElement("script");n.src="https://js.stripe.com/v3/",n.async=!0,n.onload=()=>e(),n.onerror=()=>t(Error("Failed to load Stripe.js")),document.body.appendChild(n)})},15343:(e,t,n)=>{"use strict";n.d(t,{A:()=>r.A});var r=n(14745)},15827:(e,t,n)=>{"use strict";n.d(t,{default:()=>s});var r=n(12115),a=n(35695),o=n(25578),i=n(51174);function s(){let e=(0,a.useRouter)();return(0,r.useEffect)(()=>{(async()=>{let e=new URL(window.location);if("/dashboard"===e.pathname&&("true"===e.searchParams.get("fromAuth")||"true"===e.searchParams.get("fromSignIn"))){o.v.info("[MiddlewareHeaderHandler] Detected auth response, checking for tenant ID");try{let t=await (0,i.getTenantIdFromCognito)();if(t){o.v.info("[MiddlewareHeaderHandler] Found tenant ID after auth: ".concat(t));let n={};e.searchParams.forEach((e,t)=>{n[t]=e}),n.direct="true";let r=Object.entries(n).map(e=>{let[t,n]=e;return"".concat(t,"=").concat(encodeURIComponent(n))}).join("&"),a="/".concat(t,"/dashboard").concat(r?"?".concat(r):"");o.v.info("[MiddlewareHeaderHandler] Redirecting to tenant URL after auth: ".concat(a)),setTimeout(()=>{window.location.href=a},100);return}}catch(e){o.v.error("[MiddlewareHeaderHandler] Error checking tenant ID from Cognito:",e)}}let t=document.querySelectorAll('meta[http-equiv^="x-"]'),n={};if(t.forEach(e=>{let t=e.getAttribute("http-equiv"),r=e.getAttribute("content");n[t]=r,o.v.info("[MiddlewareHeaderHandler] Found meta tag: ".concat(t," = ").concat(r))}),"true"===n["x-reset-navigation"]){o.v.info("[MiddlewareHeaderHandler] Resetting navigation state"),localStorage.removeItem("lastRedirect"),localStorage.removeItem("redirectAttempts");try{let e=await (0,i.getTenantIdFromCognito)();setTimeout(()=>{e?window.location.href="/".concat(e,"/dashboard?direct=true&fromSignIn=true"):window.location.href="/dashboard?fromSignIn=true"},500)}catch(e){o.v.error("[MiddlewareHeaderHandler] Error getting tenant ID during reset:",e),window.location.href="/dashboard?fromSignIn=true"}return}let r="true"===n["x-should-redirect"],a=n["x-redirect-path"];if(n["x-tenant-id"]){let e=n["x-tenant-id"];if(e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)){o.v.info("[MiddlewareHeaderHandler] Storing tenant ID in Cognito: ".concat(e));try{await (0,i.updateTenantIdInCognito)(e)}catch(e){o.v.error("[MiddlewareHeaderHandler] Error storing tenant ID in Cognito:",e)}}}if(r&&a&&window.location.pathname!==a.split("?")[0]){o.v.info("[MiddlewareHeaderHandler] Should redirect to: ".concat(a));try{let e=await (0,i.getTenantIdFromCognito)(),t=a.match(/^\/([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})\//i);if(e&&!t&&a.startsWith("/dashboard")){let t="/".concat(e,"/dashboard?direct=true&fromSignIn=true");o.v.info("[MiddlewareHeaderHandler] Adding tenant ID to path: ".concat(t)),window.location.href=t;return}let n=localStorage.getItem("lastRedirect"),r=parseInt(localStorage.getItem("redirectAttempts")||"0");if(n===a){if(r++,localStorage.setItem("redirectAttempts",r.toString()),r>=2){o.v.warn("[MiddlewareHeaderHandler] Detected redirect loop, breaking cycle"),localStorage.removeItem("lastRedirect"),localStorage.removeItem("redirectAttempts");let t=a.match(/^\/([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})\//i);if(t&&t[1]){let e=t[1];window.location.href="/".concat(e,"/dashboard?direct=true&fromSignIn=true")}else e?window.location.href="/".concat(e,"/dashboard?direct=true&fromSignIn=true"):window.location.href="/dashboard?fromSignIn=true&reset=true";return}}else r=1,localStorage.setItem("redirectAttempts","1");localStorage.setItem("lastRedirect",a),a&&(window.location.href=a)}catch(e){o.v.error("[MiddlewareHeaderHandler] Error during redirection:",e),a&&(window.location.href=a)}}})()},[e]),null}},19596:(e,t,n)=>{"use strict";n.d(t,{kd:()=>r});let r={BUSINESS_INFO:"business-info",SUBSCRIPTION:"subscription",PAYMENT:"payment",SETUP:"setup",COMPLETE:"complete",DASHBOARD:"dashboard"}},21102:(e,t,n)=>{"use strict";n.d(t,{fetchCurrentUserMenuPrivileges:()=>s});var r=n(99783),a=n(29670),o=n(42749);let i=["dashboard","settings"];async function s(){try{o.vF.info("[fetchMenuPrivileges] Fetching current user menu privileges");let e=(0,a.gd)("currentUserMenuPrivileges"),t=(0,a.gd)("menuPrivilegesTimestamp"),n=Date.now();if(e&&t&&n-parseInt(t)<3e5)return o.vF.info("[fetchMenuPrivileges] Using cached menu privileges"),e;let s=await r.Ay.get("/users/api/menu-privileges/current_user/");if(s&&s.menu_items&&Array.isArray(s.menu_items))return(0,a.mm)("currentUserMenuPrivileges",s.menu_items),(0,a.mm)("menuPrivilegesTimestamp",n.toString()),o.vF.info("[fetchMenuPrivileges] Successfully fetched menu privileges",s.menu_items),s.menu_items;return o.vF.warn("[fetchMenuPrivileges] Invalid or empty response, using default menu items"),(0,a.mm)("currentUserMenuPrivileges",i),(0,a.mm)("menuPrivilegesTimestamp",n.toString()),i}catch(t){o.vF.error("[fetchMenuPrivileges] Error fetching menu privileges:",t);let e=Date.now();return(0,a.mm)("currentUserMenuPrivileges",i),(0,a.mm)("menuPrivilegesTimestamp",e.toString()),i}}},25578:(e,t,n)=>{"use strict";n.d(t,{v:()=>c});var r=n(29670);let a={DEBUG:0,INFO:1,WARN:2,ERROR:3},o=a.INFO,i=()=>{try{{let e=(0,r.gd)("logLevel");if(e&&void 0!==a[e])return a[e]}}catch(e){}return o},s=()=>new Date().toISOString(),l=(e,t)=>{let n=s();return"[".concat(n,"] [").concat(e,"] ").concat(t)},c={debug:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];i()<=a.DEBUG&&console.debug(l("DEBUG",e),...n)},info:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];i()<=a.INFO&&console.info(l("INFO",e),...n)},warn:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];i()<=a.WARN&&console.warn(l("WARN",e),...n)},error:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];i()<=a.ERROR&&console.error(l("ERROR",e),...n)},setLogLevel:e=>{try{void 0!==a[e]&&(0,r.mm)("logLevel",e)}catch(e){}}}},47856:(e,t,n)=>{"use strict";n.d(t,{E6:()=>s,J_:()=>l,Yc:()=>c,ed:()=>i});var r=n(42749);n(68084);var a=n(51174);n(12115);let o=null;function i(e){if(!e)return void r.vF.warn("[tenantContext] Attempted to set empty tenant ID");o!==e&&(r.vF.info("[tenantContext] Tenant ID updated: ".concat(e)),o=e)}function s(){return o}let l=e=>{let t;e&&e.headers&&((t="function"==typeof e.headers.get?e.headers.get("x-tenant-id"):e.headers["x-tenant-id"])||!e.data||!e.data.businessId||(t=e.data.businessId),t&&(r.vF.debug("[TenantContext] Extracted tenant ID from response: ".concat(t)),i(t)))},c=async()=>{r.vF.debug("[TenantContext] Initializing tenant context");try{r.vF.info("[TenantContext] Initializing tenant context");let e=await (0,a.Nf)();return e?(i(e),r.vF.info("[TenantContext] Tenant context initialized with ID: ".concat(e))):r.vF.warn("[TenantContext] No valid tenant ID found during initialization"),e}catch(t){r.vF.error("[TenantContext] Error getting tenant context:",t);let e="18609ed2-1a46-4d50-bc4e-483d6e3405ff";return r.vF.warn("[TenantContext] Error during initialization, using fallback: ".concat(e)),i(e),e}}},51174:(e,t,n)=>{"use strict";n.d(t,{$_:()=>c,BI:()=>v,FB:()=>b,Nf:()=>f,Pc:()=>u,fy:()=>x,getTenantId:()=>s,getTenantIdFromCognito:()=>g,h_:()=>m,isValidUUID:()=>l,jW:()=>w,oA:()=>d,pm:()=>p,updateTenantIdInCognito:()=>h});var r=n(81746),a=n(24818),o=n(62052);let i="tenantId",s=async()=>{try{var e,t,n,s,l,c;let d=await o.l.getItem(i);if(d)return d;let u=await (0,r.H)(),h=await (0,a.$)(),m=(null==u||null==(e=u.attributes)?void 0:e["custom:tenant_ID"])||(null==u||null==(t=u.attributes)?void 0:t["custom:tenantId"])||(null==h||null==(s=h.accessToken)||null==(n=s.payload)?void 0:n["custom:tenant_ID"])||(null==h||null==(c=h.accessToken)||null==(l=c.payload)?void 0:l["custom:tenantId"]);if(!m)throw Error("Tenant ID not found in user attributes or session");return await o.l.setItem(i,m),m}catch(e){throw console.error("Error getting tenant ID:",e),e}},l=e=>/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e),c=async e=>{try{await o.l.setItem(i,e)}catch(e){throw console.error("Error storing tenant ID:",e),e}},d=async e=>{let{tenantId:t,metadata:n={}}=e;try{if(!t)return void console.error("Cannot store tenant info: No tenant ID provided");await o.l.setItem(i,t),window.__APP_CACHE||(window.__APP_CACHE={}),window.__APP_CACHE.tenant||(window.__APP_CACHE.tenant={}),window.__APP_CACHE.tenant.id=t,window.__APP_CACHE.tenant.metadata=n,window.__APP_CACHE.tenant.timestamp=Date.now();try{sessionStorage.setItem("tenant_id",t),sessionStorage.setItem("tenant_info",JSON.stringify({id:t,metadata:n,timestamp:Date.now()}))}catch(e){console.debug("Could not store tenant info in sessionStorage:",e)}console.debug("[TenantUtils] Stored tenant info for ID: ".concat(t))}catch(e){console.error("Error storing tenant info:",e)}},u=e=>e?e.charAt(0).toUpperCase()+e.slice(1).toLowerCase():e,h=async e=>{try{let{updateUserAttributes:t}=await Promise.all([n.e(58430),n.e(84620),n.e(23639),n.e(38501),n.e(31861),n.e(94901)]).then(n.bind(n,55158));await t({userAttributes:{"custom:tenant_ID":e}}),await c(e),console.debug("[TenantUtils] Updated tenant ID in Cognito: ".concat(e))}catch(t){console.error("Error updating tenant ID in Cognito:",t),await c(e)}},m=async e=>{try{await o.l.setItem("auth_tokens",e)}catch(e){throw console.error("Error setting tokens:",e),e}},g=async()=>{try{var e,t,n,s,l,c;let d=await o.l.getItem(i);if(d)return d;let u=await (0,r.H)(),h=await (0,a.$)(),m=(null==u||null==(e=u.attributes)?void 0:e["custom:tenant_ID"])||(null==u||null==(t=u.attributes)?void 0:t["custom:tenantId"])||(null==h||null==(s=h.accessToken)||null==(n=s.payload)?void 0:n["custom:tenant_ID"])||(null==h||null==(c=h.accessToken)||null==(l=c.payload)?void 0:l["custom:tenantId"]);if(!m)return null;return await o.l.setItem(i,m),m}catch(e){return console.error("Error getting tenant ID from Cognito:",e),null}},f=async e=>{try{if(!l(e))return!1;return(await fetch("/api/tenants/".concat(e,"/validate"))).ok}catch(e){return console.error("Error validating tenant ID:",e),!1}},p=e=>{let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t&=t;return"00000000-0000-4000-a000-".concat(Math.abs(t).toString(16).padStart(12,"0"))},w=async()=>{try{let e=await s();if(!l(e))return console.error("Invalid tenant ID format:",e),null;return e}catch(e){return console.error("Error getting secure tenant ID:",e),null}},v=e=>l(e),b=e=>e?"tenant_".concat(e.replace(/-/g,"_")):"public",x=async()=>{try{let e=await s(),t={"Content-Type":"application/json","x-tenant-id":e};try{let{getCurrentUser:e}=await Promise.all([n.e(58430),n.e(84620),n.e(23639),n.e(38501),n.e(31861),n.e(94901)]).then(n.bind(n,55158)),r=await e();r&&r.userId&&(t["x-user-id"]=r.userId)}catch(e){}return t}catch(e){return console.error("Error getting tenant headers:",e),{"Content-Type":"application/json"}}}},51472:(e,t,n)=>{Promise.resolve().then(n.bind(n,54594)),Promise.resolve().then(n.bind(n,94482)),Promise.resolve().then(n.bind(n,15827))},53498:(e,t,n)=>{"use strict";n.d(t,{A:()=>w});var r=n(95155),a=n(11518),o=n.n(a),i=n(12115),s=n(35695),l=n(42749);n(55028),n(66766);var c=n(15343);n(19596);var d=n(51174),u=n(12743),h=n(55166),m=n(68387);async function g(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.startsWith("/")?e.substring(1):e,r=(0,m._)((0,h._)({},t),{headers:(0,h._)({"Content-Type":"application/json"},t.headers)});try{let e=await fetch("/api/proxy/".concat(n),r);if(!e.ok)throw Error("API request failed with status ".concat(e.status));return await e.json()}catch(t){throw console.error("[proxyFetch] Error fetching ".concat(e,":"),t),t}}let f={get:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return g(e,(0,h._)({method:"GET"},t))},resetCircuitBreakers:function(){let e=Object.keys(localStorage).filter(e=>e.startsWith("circuitBreaker:"));return e.forEach(e=>{console.log("[resetCircuitBreakers] Removing ".concat(e," from localStorage")),localStorage.removeItem(e)}),console.log("[resetCircuitBreakers] Reset ".concat(e.length," circuit breakers")),window.__resetCircuitBreakers&&(window.__resetCircuitBreakers(),console.log("[resetCircuitBreakers] Called global reset function")),e.length}};function p(){let[e,t]=(0,i.useState)(null),[n,a]=(0,i.useState)(null),[o,s]=(0,i.useState)(!1),[l,c]=(0,i.useState)(!1),[d,u]=(0,i.useState)("hr/employees"),[h,m]=(0,i.useState)(""),g=async()=>{s(!0);try{try{let e={"Content-Type":"application/json"};h&&(e.Authorization="Bearer ".concat(h));let t=await fetch("https://127.0.0.1:8000/api/".concat(d,"/"),{method:"GET",headers:e});console.log("[HttpsDebugger] Direct API response:",t)}catch(e){console.warn("[HttpsDebugger] Direct API request failed:",e)}let e={};h&&(e={headers:{Authorization:"Bearer ".concat(h)}});let n=await f.get(d,e);t({success:!0,message:"API connection successful",data:n})}catch(e){t({success:!1,message:"API connection failed",error:e.message})}finally{s(!1)}};return(0,r.jsxs)("div",{className:"bg-white shadow-md rounded-lg p-4 my-4 max-w-xl mx-auto",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"HTTPS Debug Tools"}),(0,r.jsx)("button",{onClick:()=>c(!l),className:"text-gray-600 hover:text-blue-500",children:l?"Collapse":"Expand"})]}),l&&(0,r.jsxs)("div",{className:"mt-4 space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"mb-4 space-y-2",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:["API Endpoint",(0,r.jsx)("input",{type:"text",value:d,onChange:e=>u(e.target.value),placeholder:"e.g., hr/employees",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"})]}),(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:["Auth Token (optional)",(0,r.jsx)("input",{type:"text",value:h,onChange:e=>m(e.target.value),placeholder:"Bearer token for authenticated endpoints",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"})]})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{onClick:g,disabled:o,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50",children:o?"Testing...":"Test API Connection"}),(0,r.jsx)("button",{onClick:()=>{try{let e=f.resetCircuitBreakers();a({success:!0,message:"Reset ".concat(e," circuit breakers")})}catch(e){a({success:!1,message:"Failed to reset circuit breakers",error:e.message})}},className:"px-4 py-2 bg-yellow-500 text-white rounded hover:bg-yellow-600",children:"Reset Circuit Breakers"})]}),e&&(0,r.jsxs)("div",{className:"p-3 rounded ".concat(e.success?"bg-green-100":"bg-red-100"),children:[(0,r.jsx)("p",{className:"font-semibold",children:e.message}),!e.success&&(0,r.jsx)("p",{className:"text-red-600 text-sm",children:e.error}),e.success&&e.data&&(0,r.jsx)("pre",{className:"mt-2 p-2 bg-gray-100 rounded text-sm overflow-auto max-h-40",children:JSON.stringify(e.data,null,2)})]}),n&&(0,r.jsxs)("div",{className:"p-3 rounded ".concat(n.success?"bg-green-100":"bg-red-100"),children:[(0,r.jsx)("p",{className:"font-semibold",children:n.message}),!n.success&&(0,r.jsx)("p",{className:"text-red-600 text-sm",children:n.error})]})]}),(0,r.jsxs)("div",{className:"border-t pt-4",children:[(0,r.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Connection Information"}),(0,r.jsxs)("ul",{className:"text-sm space-y-1 text-gray-600",children:[(0,r.jsxs)("li",{children:[(0,r.jsx)("strong",{children:"Frontend URL:"})," ",window.location.origin]}),(0,r.jsxs)("li",{children:[(0,r.jsx)("strong",{children:"API Proxy:"})," ",window.location.origin,"/api/proxy/"]}),(0,r.jsxs)("li",{children:[(0,r.jsx)("strong",{children:"Backend URL:"})," https://127.0.0.1:8000/api/"]}),(0,r.jsxs)("li",{children:[(0,r.jsx)("strong",{children:"HTTPS Mode:"})," ",window.__HTTPS_ENABLED?"Enabled":"Disabled"]})]})]}),(0,r.jsxs)("div",{className:"mt-4 border-t pt-4",children:[(0,r.jsx)("h4",{className:"font-medium text-gray-700 mb-2",children:"Common API Endpoints"}),(0,r.jsxs)("div",{className:"text-sm space-y-1 text-gray-600",children:[(0,r.jsx)("button",{onClick:()=>u("hr/employees"),className:"block text-blue-500 hover:underline",children:"HR Employees"}),(0,r.jsx)("button",{onClick:()=>u("finance/transactions"),className:"block text-blue-500 hover:underline",children:"Finance Transactions"}),(0,r.jsx)("button",{onClick:()=>u("database/health-check"),className:"block text-blue-500 hover:underline",children:"Database Health Check"})]})]}),(0,r.jsx)("div",{className:"text-xs text-gray-500 mt-2",children:(0,r.jsx)("p",{children:"* This component is for development debugging only."})})]})]})}function w(e){let{children:t,newAccount:n,plan:a,tenantId:h}=e,m=(0,s.useRouter)(),[g,f]=(0,i.useState)(!1),[w,v]=(0,i.useState)(!1),[b,x]=(0,i.useState)(h),[y,I]=(0,i.useState)("initial"),C=(0,i.useRef)(0);return(0,i.useEffect)(()=>{var e;let t=()=>{C.current+=1,I("navigation-".concat(C.current))};return null==(e=m.events)||e.on("routeChangeComplete",t),()=>{var e;null==(e=m.events)||e.off("routeChangeComplete",t)}},[m]),(0,i.useEffect)(()=>{if(h)return void x(h);let e=(()=>{let e=document.cookie.split(";"),t=null;for(let n of e){let[e,r]=n.trim().split("=");if("tenantId"===e){t=r;break}}if(t)return t;try{return localStorage.getItem("tenantId")||sessionStorage.getItem("tenantId")}catch(e){return null}})();e&&(l.vF.info("[DashboardWrapper] Using tenant ID from cache: ".concat(e)),x(e))},[h]),(0,i.useEffect)(()=>{b&&(0,d.isValidUUID)(b)?(l.vF.info("[DashboardWrapper] Storing valid tenant ID: ".concat(b)),(0,d.$_)(b)):b&&l.vF.warn("[DashboardWrapper] Invalid tenant ID format: ".concat(b))},[b]),(0,r.jsxs)("div",{className:"jsx-2ea202641b209f13 flex flex-col min-h-screen bg-gray-50",children:[(0,r.jsx)(o(),{id:"2ea202641b209f13",children:'html,body{height:100%;min-height:100%;width:100%;overflow-x:hidden}body{font-family:var(--font-family,ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif);margin:0;padding:0}::-moz-selection{background-color:rgba(67,56,202,.3)}::selection{background-color:rgba(67,56,202,.3)}'}),(0,r.jsxs)("main",{className:"jsx-2ea202641b209f13 flex-1",children:[(0,r.jsx)(p,{}),(0,r.jsx)(c.A,{tenantId:b,newAccount:n,plan:a,children:t},y)]}),(0,r.jsx)(u.A,{})]})}},54594:(e,t,n)=>{"use strict";n.d(t,{default:()=>A});var r=n(95155),a=n(11518),o=n.n(a),i=n(55028),s=n(12115),l=n(42749),c=n(35695),d=n(24818),u=n(55166),h=n(68387),m=n(81746),g=n(11024);let f=(0,s.createContext)(null);function p(e){let{children:t}=e,[n,a]=(0,s.useState)(null),[o,i]=(0,s.useState)(null),[c,p]=(0,s.useState)(!0),[w,v]=(0,s.useState)(null),[b,x]=(0,s.useState)(!1),y=async()=>{if(b)return void l.vF.debug("[useSession] Refresh already in progress, skipping");x(!0),l.vF.debug("[useSession] Refreshing session");try{let e=await (0,d.$)(),t=await (0,m.H)(),n=await (0,g.T)();a(e),i((0,h._)((0,u._)({},t),{attributes:n})),v(null)}catch(e){l.vF.error("[useSession] Error refreshing session:",e),v(e)}finally{x(!1),p(!1)}};return(0,s.useEffect)(()=>{y();let e=setInterval(()=>{y()},9e5);return()=>clearInterval(e)},[]),(0,r.jsx)(f.Provider,{value:{session:n,user:o,loading:c,error:w,refreshSession:y},children:t})}var w=n(99944),v=n(29670);let b=(0,s.createContext)(null),x="light",y="dark",I="system";function C(e){let{children:t}=e,[n,a]=(0,s.useState)(x),[o,i]=(0,s.useState)(x),l=()=>window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?y:x;return(0,s.useEffect)(()=>{let e=(0,v.gd)("theme"),t=l();i(t),e?a(e===I?t:e):(async()=>{try{let e=await (0,w.zz)(I);a(e===I?t:e)}catch(e){console.error("Failed to get theme preference from Cognito:",e),a(t)}})();let r=window.matchMedia("(prefers-color-scheme: dark)"),o=e=>{let t=e.matches?y:x;i(t),n===I&&a(t)};return r.addEventListener?r.addEventListener("change",o):r.addListener(o),()=>{r.removeEventListener?r.removeEventListener("change",o):r.removeListener(o)}},[]),(0,s.useEffect)(()=>{(n===I?o:n)===y?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[n,o]),(0,r.jsx)(b.Provider,{value:{theme:n,systemTheme:o,updateTheme:e=>{a(e),(e===I?o:e)===y?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),(0,w.of)(e).catch(e=>{console.error("Failed to save theme preference to Cognito:",e)}),(0,v.mm)("theme",e)},LIGHT_THEME:x,DARK_THEME:y,SYSTEM_THEME:I},children:t})}n(53498),n(19596),n(47611);var _=n(33339);function S(){let[e,t]=(0,s.useState)(!1),r=(0,c.useRouter)(),a=(0,c.useSearchParams)();return(0,s.useEffect)(()=>{(async()=>{try{let e=(null==a?void 0:a.get("fromAuth"))==="true"||(null==a?void 0:a.get("fromSignIn"))==="true",{getTenantIdFromCognito:r,updateTenantIdInCognito:o}=await Promise.resolve().then(n.bind(n,51174)),i=await r(),{fetchCurrentUserMenuPrivileges:s}=await Promise.resolve().then(n.bind(n,21102));if(await s(),i&&e&&"/dashboard"===window.location.pathname){l.vF.info("[ClientDataSync] Auth flow detected with tenant ID, redirecting to tenant URL");let e={};a.forEach((t,n)=>{e[n]=t}),e.direct="true";let t=Object.entries(e).map(e=>{let[t,n]=e;return"".concat(t,"=").concat(encodeURIComponent(n))}).join("&"),n="/".concat(i,"/dashboard").concat(t?"?".concat(t):"");window.location.href=n;return}t(!0)}catch(e){l.vF.error("[ClientDataSync] Error syncing client data:",e),t(!0)}})()},[a,r]),null}n(47070),n(91607),n(12743),(0,i.default)(()=>n.e(90076).then(n.bind(n,90076)),{loadableGenerated:{webpack:()=>[90076]},loading:()=>(0,r.jsx)("div",{children:"Loading database tools..."}),ssr:!1});n(21102);var k=n(14729),E=n(62052);let j=e=>e?e.charAt(0).toUpperCase()+e.slice(1).toLowerCase():e,D=async e=>{try{let t=j(e);await E.l.setItem("userRole",t)}catch(e){throw console.error("Error storing normalized role:",e),e}};function A(e){let{children:t}=e;return(0,s.useEffect)(()=>{(async()=>{try{var e,t;await (0,k.VV)();let n=await (0,d.$)(),r=null==n||null==(t=n.accessToken)||null==(e=t.payload)?void 0:e["custom:role"];r&&await D(r)}catch(e){console.error("Error initializing features:",e)}})()},[]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o(),{id:"3fe29898342ae3e0",children:"html{height:100%;min-height:100%;width:100%;overflow-x:hidden}body{height:100%;min-height:100%;width:100%;font-family:var(--font-family);overflow-x:hidden!important;margin:0;padding:0}#app-root{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;min-height:100%;width:100%}::-moz-selection{background-color:rgba(67,56,202,.3)}::selection{background-color:rgba(67,56,202,.3)}.full-height{height:100%;min-height:100%}.full-width{width:100%}"}),(0,r.jsx)(p,{children:(0,r.jsx)(C,{children:(0,r.jsxs)(_.p,{children:[(0,r.jsx)(S,{}),t]})})})]})}(0,i.default)(()=>n.e(77745).then(n.bind(n,77745)).then(e=>e),{loadableGenerated:{webpack:()=>[77745]},ssr:!1,loading:()=>null}),(0,i.default)(()=>n.e(88156).then(n.bind(n,88156)).then(e=>e),{loadableGenerated:{webpack:()=>[88156]},ssr:!1,loading:()=>null}),(0,i.default)(()=>n.e(23317).then(n.bind(n,23317)).catch(e=>(console.error("Failed to load FixInputEvent component:",e),null)),{loadableGenerated:{webpack:()=>[23317]}})},68084:(e,t,n)=>{"use strict";n.d(t,{P:()=>r});let r=(0,n(61421).vt)(e=>({isAuthenticated:!1,user:null,token:null,signOut:()=>e({isAuthenticated:!1,user:null,token:null}),setUser:t=>e({isAuthenticated:!0,user:t}),setToken:t=>e({token:t})}))},91607:e=>{e.exports={container:"DashboardClient_container__EQuPD",main:"DashboardClient_main__c4cc7",content:"DashboardClient_content__NDXwr",header:"DashboardClient_header__Wb0pz",title:"DashboardClient_title__MH_U2",loadingContainer:"DashboardClient_loadingContainer__cokzx",tenant:"DashboardClient_tenant__IUjc_",userInfo:"DashboardClient_userInfo__KoBfk",avatar:"DashboardClient_avatar___VEsC",sidebar:"DashboardClient_sidebar__xgu_5",sidebarOpen:"DashboardClient_sidebarOpen__gFZ6P",sidebarClosed:"DashboardClient_sidebarClosed__hq4u9",tenantSelector:"DashboardClient_tenantSelector___nr8A"}},94482:(e,t,n)=>{"use strict";n.d(t,{default:()=>i});var r=n(95155),a=n(12115),o=n(47070);function i(e){let{children:t}=e,[n,i]=(0,a.useState)(!1);return((0,a.useEffect)(()=>{i(!0)},[]),n)?(0,r.jsx)(o.SessionProvider,{children:t}):(0,r.jsx)(r.Fragment,{children:t})}}},e=>{var t=t=>e(e.s=t);e.O(0,[95304,54940,9296,79480,58430,84620,23639,38501,78746,20171,79189,6874,62052,66766,31296,66352,38772,35162,37921,8896,47070,48990,29729,44367,67953,3963,83531,93078,14719,14745,28441,31684,77358],()=>t(51472)),_N_E=e.O()}]);