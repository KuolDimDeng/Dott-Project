(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[68206],{35695:(e,s,r)=>{"use strict";var a=r(18999);r.o(a,"useParams")&&r.d(s,{useParams:function(){return a.useParams}}),r.o(a,"usePathname")&&r.d(s,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(s,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(s,{useSearchParams:function(){return a.useSearchParams}})},42749:(e,s,r)=>{"use strict";r.d(s,{vF:()=>n});let a={debug:0,info:1,warn:2,error:3},t="info",o=()=>!1,n={setLevel(e){void 0!==a[e]&&(t=e)},getLevel:()=>t,debug:(e,s)=>{},info:(e,s)=>{a[t]<=a.info&&(o()?void 0!==s?console.info("[SERVER INFO] ".concat(e),s):console.info("[SERVER INFO] ".concat(e)):void 0!==s?console.info(e,s):console.info(e))},warn:(e,s)=>{a[t]<=a.warn&&(o()?void 0!==s?console.warn("[SERVER WARN] ".concat(e),s):console.warn("[SERVER WARN] ".concat(e)):void 0!==s?console.warn(e,s):console.warn(e))},error:(e,s)=>{a[t]<=a.error&&(o()?void 0!==s?console.error("[SERVER ERROR] ".concat(e),s):console.error("[SERVER ERROR] ".concat(e)):void 0!==s?console.error(e,s):console.error(e))}}},52576:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>m});var a=r(55166),t=r(68387),o=r(95155),n=r(12115),l=r(35695),c=r(6874),i=r.n(c),d=r(66766),u=r(42749);function m(){let e=(0,l.useSearchParams)().get("token"),[s,r]=(0,n.useState)(!0),[c,m]=(0,n.useState)(null),[h,x]=(0,n.useState)(null),[f,p]=(0,n.useState)({password:"",confirmPassword:""}),[w,g]=(0,n.useState)(!1),[v,y]=(0,n.useState)(!1),[b,j]=(0,n.useState)(0);(0,n.useEffect)(()=>{!async function(){r(!0),x(null);try{if(!e){x("Missing verification token. Please check your email link."),r(!1);return}let s=await fetch("/api/auth/verify-employee-token?token=".concat(encodeURIComponent(e))),a=await s.json();if(!s.ok){x(a.error||"Invalid verification token. The link may have expired."),r(!1);return}m(a),r(!1)}catch(e){u.vF.error("Error verifying employee token:",e),x("An error occurred while verifying your account. Please try again later."),r(!1)}}()},[e]),(0,n.useEffect)(()=>{let e=f.password;if(!e)return void j(0);let s=0,r=e.length>=8,a=/[a-z]/.test(e),t=/[A-Z]/.test(e),o=/\d/.test(e),n=/[^A-Za-z0-9]/.test(e);r&&s++,a&&s++,t&&s++,o&&s++,n&&s++,j(s)},[f.password]);let N=e=>{let{name:s,value:r}=e.target;p(e=>(0,t._)((0,a._)({},e),{[s]:r}))},P=async s=>{if(s.preventDefault(),f.password!==f.confirmPassword)return void x("Passwords do not match");if(b<3)return void x("Password is not strong enough. Please use a combination of uppercase, lowercase, numbers, and special characters.");g(!0),x(null);try{let s=await fetch("/api/auth/complete-employee-verification",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e,password:f.password})}),r=await s.json();if(!s.ok){x(r.error||"An error occurred while setting your password"),g(!1);return}y(!0),g(!1)}catch(e){u.vF.error("Error completing employee verification:",e),x("An error occurred while setting your password. Please try again later."),g(!1)}};return(0,o.jsxs)("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[(0,o.jsxs)("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[(0,o.jsx)("div",{className:"flex justify-center",children:(0,o.jsx)(d.default,{src:"/static/images/PyfactorLandingpage.png",alt:"PyFactor Logo",width:50,height:50,className:"h-12 w-auto"})}),(0,o.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Complete Account Setup"})]}),(0,o.jsx)("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:(0,o.jsx)("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:s?(0,o.jsxs)("div",{className:"flex flex-col items-center",children:[(0,o.jsx)("p",{className:"text-center text-gray-700",children:"Verifying your account..."}),(0,o.jsx)("div",{className:"mt-4 w-10 h-10 border-t-2 border-b-2 border-blue-500 rounded-full animate-spin"})]}):h&&!c?(0,o.jsx)("div",{className:"rounded-md bg-red-50 p-4",children:(0,o.jsxs)("div",{className:"flex",children:[(0,o.jsx)("div",{className:"flex-shrink-0",children:(0,o.jsx)("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,o.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,o.jsxs)("div",{className:"ml-3",children:[(0,o.jsx)("h3",{className:"text-sm font-medium text-red-800",children:h}),(0,o.jsx)("div",{className:"mt-2 text-sm text-red-700",children:(0,o.jsx)("p",{children:"Please contact your HR administrator for assistance."})})]})]})}):v?(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsx)("svg",{className:"mx-auto h-12 w-12 text-green-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,o.jsx)("h3",{className:"mt-2 text-lg font-medium text-gray-900",children:"Your account setup is complete!"}),(0,o.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"You can now sign in to your account using your email and password."}),(0,o.jsx)("div",{className:"mt-6",children:(0,o.jsx)(i(),{href:"/auth/signin",className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Sign In"})})]}):(0,o.jsxs)("form",{onSubmit:P,className:"space-y-6",children:[c&&(0,o.jsx)("div",{className:"bg-blue-50 rounded-md p-4 mb-4",children:(0,o.jsxs)("p",{className:"text-blue-800",children:["Welcome, ",c.firstName||"New Employee","! You're setting up your account for ",c.companyName||"your company","."]})}),h&&(0,o.jsx)("div",{className:"rounded-md bg-red-50 p-4",children:(0,o.jsxs)("div",{className:"flex",children:[(0,o.jsx)("div",{className:"flex-shrink-0",children:(0,o.jsx)("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,o.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,o.jsx)("div",{className:"ml-3",children:(0,o.jsx)("h3",{className:"text-sm font-medium text-red-800",children:h})})]})}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Create Password"}),(0,o.jsx)("div",{className:"mt-1",children:(0,o.jsx)("input",{id:"password",name:"password",type:"password",autoComplete:"new-password",required:!0,value:f.password,onChange:N,className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})}),(0,o.jsxs)("div",{className:"mt-2",children:[(0,o.jsx)("div",{className:"w-full h-2 bg-gray-200 rounded-full mt-2 overflow-hidden",children:(0,o.jsx)("div",{className:"h-full ".concat(0===b?"w-0":1===b?"w-1/5 bg-red-500":2===b?"w-2/5 bg-orange-500":3===b?"w-3/5 bg-yellow-500":4===b?"w-4/5 bg-lime-500":"w-full bg-green-500")})}),(0,o.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Password must have at least 8 characters with uppercase, lowercase, numbers, and special characters."})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm Password"}),(0,o.jsx)("div",{className:"mt-1",children:(0,o.jsx)("input",{id:"confirmPassword",name:"confirmPassword",type:"password",autoComplete:"new-password",required:!0,value:f.confirmPassword,onChange:N,className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})})]}),(0,o.jsx)("div",{children:(0,o.jsx)("button",{type:"submit",disabled:w,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ".concat(w?"opacity-70 cursor-not-allowed":""),children:w?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,o.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,o.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):"Complete Account Setup"})})]})})})]})}},79659:(e,s,r)=>{Promise.resolve().then(r.bind(r,52576))}},e=>{var s=s=>e(e.s=s);e.O(0,[6874,66766,28441,31684,77358],()=>s(79659)),_N_E=e.O()}]);