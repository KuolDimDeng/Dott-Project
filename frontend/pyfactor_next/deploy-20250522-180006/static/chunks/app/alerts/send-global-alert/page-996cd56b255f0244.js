(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[87538],{11024:(e,t,r)=>{"use strict";r.d(t,{T:()=>s});var n=r(87970),o=r(69496);let s=()=>(0,o.T)(n.H)},24818:(e,t,r)=>{"use strict";r.d(t,{$:()=>s});var n=r(87970),o=r(57762);let s=e=>(0,o.$)(n.H,e)},35695:(e,t,r)=>{"use strict";var n=r(18999);r.o(n,"useParams")&&r.d(t,{useParams:function(){return n.useParams}}),r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},37811:e=>{var t,r,n,o=e.exports={};function s(){throw Error("setTimeout has not been defined")}function u(){throw Error("clearTimeout has not been defined")}try{t="function"==typeof setTimeout?setTimeout:s}catch(e){t=s}try{r="function"==typeof clearTimeout?clearTimeout:u}catch(e){r=u}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===s||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}var l=[],a=!1,c=-1;function d(){a&&n&&(a=!1,n.length?l=n.concat(l):c=-1,l.length&&m())}function m(){if(!a){var e=i(d);a=!0;for(var t=l.length;t;){for(n=l,l=[];++c<t;)n&&n[c].run();c=-1,t=l.length}n=null,a=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===u||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function h(){}o.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];l.push(new f(e,t)),1!==l.length||a||i(m)},f.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=h,o.addListener=h,o.once=h,o.off=h,o.removeListener=h,o.removeAllListeners=h,o.emit=h,o.prependListener=h,o.prependOnceListener=h,o.listeners=function(e){return[]},o.binding=function(e){throw Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw Error("process.chdir is not supported")},o.umask=function(){return 0}},38784:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var n=r(95155),o=r(12115),s=r(29729);let u=()=>{let[e,t]=(0,o.useState)(""),[r,u]=(0,o.useState)(""),[i,l]=(0,o.useState)("medium"),a=async n=>{n.preventDefault();try{let n=await s.SP.post("/api/alerts/send_global_alert/",{subject:e,message:r,priority:i});201===n.status&&(alert("Global alert sent successfully"),t(""),u(""),l("medium"))}catch(e){console.error("Error sending global alert:",e),alert("Failed to send global alert")}};return(0,n.jsxs)("div",{className:"max-w-xl mx-auto mt-8",children:[(0,n.jsx)("h1",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Send Global Alert"}),(0,n.jsxs)("form",{onSubmit:a,className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"subject",className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject"}),(0,n.jsx)("input",{type:"text",id:"subject",value:e,onChange:e=>t(e.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-700 mb-1",children:"Message"}),(0,n.jsx)("textarea",{id:"message",value:r,onChange:e=>u(e.target.value),required:!0,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"priority",className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),(0,n.jsxs)("select",{id:"priority",value:i,onChange:e=>l(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,n.jsx)("option",{value:"low",children:"Low"}),(0,n.jsx)("option",{value:"medium",children:"Medium"}),(0,n.jsx)("option",{value:"high",children:"High"})]})]}),(0,n.jsx)("div",{className:"mt-6",children:(0,n.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Send Global Alert"})})]})]})};var i=r(35695),l=r(44367),a=r(42749);function c(e){var t,r,s,u,c;let{children:d}=e,m=(0,i.useRouter)(),{data:f,status:h}=(0,l.w)();if((0,o.useEffect)(()=>{(async()=>{try{if("unauthenticated"===h){a.vF.debug("No session found, redirecting to sign in"),m.push("/auth/signin");return}if("authenticated"===h){var e,t,r,n,o;if((null==f||null==(e=f.user)?void 0:e["custom:role"])!=="admin"){a.vF.debug("User is not admin, redirecting to dashboard"),m.push("/dashboard");return}let s=(null==f||null==(r=f.user)||null==(t=r["custom:onboarding"])?void 0:t.toLowerCase())==="true",u=(null==f||null==(o=f.user)||null==(n=o["custom:onboarding"])?void 0:n.toLowerCase())==="complete";if(!s&&!u){a.vF.debug("Onboarding not completed, redirecting to onboarding");let e=origin||window.location.origin,t="".concat(e,"/onboarding/business-info?from=admin&ts=").concat(Date.now());return window.location.replace(t),null}}}catch(e){a.vF.error("Admin access check failed:",e)}})()},[m,f,h]),"loading"===h)return(0,n.jsx)("div",{className:"flex justify-center items-center min-h-screen",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})});let b=(null==f||null==(r=f.user)||null==(t=r["custom:onboarding"])?void 0:t.toLowerCase())==="complete"||(null==f||null==(u=f.user)||null==(s=u["custom:onboarding"])?void 0:s.toLowerCase())==="completed";return"authenticated"===h&&(null==f||null==(c=f.user)?void 0:c["custom:role"])==="admin"&&b?d:null}let d=()=>(0,n.jsx)(c,{children:(0,n.jsx)(u,{})})},50581:(e,t,r)=>{"use strict";r.d(t,{N:()=>l});var n=r(90808),o=r(55413),s=r(2242),u=r(41811),i=r(83854);let l=e=>(0,n.A)(o.e,(0,s._)("GetUser"),(0,u.T)(),{...i.C,...e})},57762:(e,t,r)=>{"use strict";r.d(t,{$:()=>n});let n=(e,t)=>e.Auth.fetchAuthSession(t)},59262:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(32307),o=r(27593);let s=(e,t)=>(0,n.fE)({category:o.b7.Auth,action:e,...t})},69496:(e,t,r)=>{"use strict";r.d(t,{T:()=>m});var n=r(45103),o=r(57762),s=r(27593),u=r(88726),i=r(84295),l=r(85565),a=r(59262),c=r(50581),d=r(32712);let m=async e=>{let t=e.getConfig().Auth?.Cognito;(0,n.$y)(t);let{userPoolEndpoint:r,userPoolId:m}=t,{tokens:f}=await (0,o.$)(e,{forceRefresh:!1});(0,i.H0)(f);let h=(0,c.N)({endpointResolver:(0,d.o)({endpointOverride:r})}),{UserAttributes:b}=await h({region:(0,u.J)(m),userAgentValue:(0,a.A)(s.BM.FetchUserAttributes)},{AccessToken:f.accessToken.toString()});return(0,l.J)(b)}},85565:(e,t,r)=>{"use strict";function n(e){return Object.entries(e).map(([e,t])=>({Name:e,Value:t}))}function o(e){let t={};return e?.forEach(e=>{e.Name&&(t[e.Name]=e.Value)}),t}r.d(t,{J:()=>o,Q:()=>n})},99867:(e,t,r)=>{Promise.resolve().then(r.bind(r,38784))}},e=>{var t=t=>e(e.s=t);e.O(0,[54940,9296,79480,58430,20171,79189,29729,44367,28441,31684,77358],()=>t(99867)),_N_E=e.O()}]);