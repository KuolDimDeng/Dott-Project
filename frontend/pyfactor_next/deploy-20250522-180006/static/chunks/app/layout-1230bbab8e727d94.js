(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7177],{12528:(e,t,n)=>{"use strict";n.d(t,{As:()=>r.As,OJ:()=>r.OJ});var r=n(64070)},14882:(e,t,n)=>{"use strict";n.d(t,{Ku:()=>l,WE:()=>d,n8:()=>u});var r=n(95155),o=n(12115);n(39786);var a=n(42749),i=n(51174),c=n(49852);let s=(0,o.createContext)({tenantId:null,tenantInfo:null,loading:!0,error:null,setTenantId:()=>{},fetchTenantInfo:()=>Promise.resolve(null),switchTenant:()=>Promise.resolve(!1),clearTenant:()=>{},initializeTenant:()=>Promise.resolve(),verifyTenantAccess:()=>Promise.resolve(!0)}),l=()=>{let e=(0,o.useContext)(s);return e||(a.vF.warn("[TenantContext] useTenant called outside of provider, returning empty context"),{tenantId:null,tenantInfo:null,loading:!1,error:null,setTenantId:()=>{},fetchTenantInfo:()=>Promise.resolve(null),switchTenant:()=>Promise.resolve(!1),clearTenant:()=>{},initializeTenant:()=>Promise.resolve(),verifyTenantAccess:()=>Promise.resolve(!0)})},u=l,d=e=>{let{children:t}=e,[n,l]=(0,o.useState)(null),[u,d]=(0,o.useState)(null),[v,h]=(0,o.useState)(!0),[f,g]=(0,o.useState)(null),[w,p]=(0,o.useState)([]),y=(0,o.useRef)({tenantInfo:0,tenantList:0}),m=(0,o.useRef)({tenantInfo:!1,tenantList:!1}),C=(0,o.useCallback)(()=>{let e=window.location.pathname;return"/"===e||""===e||"/index.html"===e||e.startsWith("/auth/")||"/about"===e||"/privacy"===e||"/terms"===e},[!0]);(0,o.useEffect)(()=>{C()&&h(!1)},[C]);let _=(0,o.useCallback)(async()=>{var e,t;try{let t=await fetch("/api/tenant/from-token");if(!t.ok){if(C()&&(401===t.status||403===t.status))return a.vF.debug("[TenantContext] Auth error on public page (expected)"),null;let n=await t.json();if("UserUnAuthenticatedException"===n.name||(null==(e=n.message)?void 0:e.includes("User needs to be authenticated")))throw Error("User needs to be authenticated");throw Error("Error getting tenant ID from token: ".concat(t.statusText))}return(await t.json()).tenantId}catch(e){if(C()&&("UserUnAuthenticatedException"===e.name||(null==(t=e.message)?void 0:t.includes("User needs to be authenticated"))))return a.vF.debug("[TenantContext] Auth error on public page (expected)"),null;throw e}},[C]),I=(0,o.useCallback)(async e=>{if(e&&e!==n&&(l(e),1))try{await (0,i.updateTenantIdInCognito)(e),a.vF.info("[TenantContext] Tenant ID updated in Cognito: ".concat(e))}catch(e){a.vF.error("[TenantContext] Error updating tenant ID in Cognito:",e)}},[n]),b=(0,o.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;try{if(!e)return a.vF.warn("[TenantContext] No tenant ID provided to fetch info"),null;let t=Date.now();if(m.current.tenantInfo||t-y.current.tenantInfo<2e3)return a.vF.debug("[TenantContext] Skipping tenant info fetch (too frequent or in progress)"),u;m.current.tenantInfo=!0,h(!0);try{let t=await c.K.getTenantInfo(e);if(y.current.tenantInfo=Date.now(),t)return a.vF.info("[TenantContext] Fetched tenant info for: ".concat(e)),d(t),t;return a.vF.warn("[TenantContext] No tenant info returned for: ".concat(e)),null}catch(n){a.vF.warn("[TenantContext] Failed to fetch tenant info, using mock: ".concat(n.message));let t={id:e,name:"Tenant ".concat(e.substring(0,8)),description:"Mock tenant for development",isActive:!0};return d(t),t}}catch(e){return a.vF.error("[TenantContext] Error fetching tenant info: ".concat(e)),g(e),null}finally{h(!1),m.current.tenantInfo=!1}},[n,u]),A=(0,o.useCallback)(async e=>{try{if(!e)return a.vF.warn("[TenantContext] No tenant ID provided to switch to"),!1;return await I(e),await b(e),a.vF.info("[TenantContext] Successfully switched to tenant: ".concat(e)),!0}catch(e){return a.vF.error("[TenantContext] Error switching tenant:",e),!1}},[I,b]),T=(0,o.useCallback)(async()=>{try{await (0,i.updateTenantIdInCognito)(""),l(null),d(null),a.vF.info("[TenantContext] Tenant context cleared")}catch(e){a.vF.error("[TenantContext] Error clearing tenant ID in Cognito:",e)}},[]),x=(0,o.useCallback)(async()=>{if(C()){a.vF.debug("[TenantContext] Skipping tenant initialization for public page"),h(!1);return}try{h(!0)}catch(t){if(C())return a.vF.debug("[TenantContext] Error ignored on public page:",t.message),h(!1),null;{var e;let n=window.location.pathname;if((n.includes("/auth/signin")||n.includes("/auth/signup")||n.includes("/auth/verify")||n.includes("/auth/reset-password"))&&("UserUnAuthenticatedException"===t.name||(null==(e=t.message)?void 0:e.includes("User needs to be authenticated"))))return a.vF.debug("[TenantContext] User not authenticated on auth page (expected)"),h(!1),null}a.vF.error("[TenantContext] Error initializing tenant context:",t),g(t)}finally{h(!1)}},[C,_,b]),E=(0,o.useCallback)(async e=>{try{if(!e)return a.vF.warn("[TenantContext] No tenant ID provided to verify access"),!1;let t=await c.K.verifyTenantAccess(e);return a.vF.info("[TenantContext] User access to tenant ".concat(e,": ").concat(t)),t}catch(e){return a.vF.error("[TenantContext] Error verifying tenant access:",e),!1}},[]);return(0,o.useEffect)(()=>{x()},[x]),(0,r.jsx)(s.Provider,{value:{tenantId:n,tenantInfo:u,loading:v,error:f,setTenantId:I,fetchTenantInfo:b,switchTenant:A,clearTenant:T,initializeTenant:x,verifyTenantAccess:E},children:t})}},29670:(e,t,n)=>{"use strict";n.d(t,{$R:()=>l,A6:()=>c,Ay:()=>d,IL:()=>s,bB:()=>u,gd:()=>i,mm:()=>a});var r=n(42749);let o=null;try{window.AWSCache&&(o=window.AWSCache,r.vF.debug("[appCache] AWS App Cache initialized successfully"))}catch(e){r.vF.warn("[appCache] Failed to initialize AWS App Cache:",e)}async function a(e,t,n){try{if(!e)throw Error("Cache key is required");if(o)await o.set(e,t,n),r.vF.debug("[appCache] Set value for key: ".concat(e));else{let o={value:t,timestamp:Date.now(),ttl:n?1e3*n:null};window.sessionStorage.setItem(e,JSON.stringify(o)),r.vF.debug("[appCache] Set value in sessionStorage for key: ".concat(e))}}catch(t){throw r.vF.error("[appCache] Error setting cache value for key ".concat(e,":"),t),t}}async function i(e){try{if(!e)throw Error("Cache key is required");if(o){let t=await o.get(e);return r.vF.debug("[appCache] Retrieved value for key: ".concat(e)),t}{let t=window.sessionStorage.getItem(e);if(!t)return null;let{value:n,timestamp:o,ttl:a}=JSON.parse(t);if(a&&Date.now()-o>a)return window.sessionStorage.removeItem(e),r.vF.debug("[appCache] Removed expired value for key: ".concat(e)),null;return r.vF.debug("[appCache] Retrieved value from sessionStorage for key: ".concat(e)),n}}catch(t){return r.vF.error("[appCache] Error getting cache value for key ".concat(e,":"),t),null}}async function c(e){try{if(!e)throw Error("Cache key is required");o?(await o.remove(e),r.vF.debug("[appCache] Removed value for key: ".concat(e))):(window.sessionStorage.removeItem(e),r.vF.debug("[appCache] Removed value from sessionStorage for key: ".concat(e)))}catch(t){throw r.vF.error("[appCache] Error removing cache value for key ".concat(e,":"),t),t}}async function s(){try{o?(await o.clear(),r.vF.debug("[appCache] Cleared all values from AWS App Cache")):(window.sessionStorage.clear(),r.vF.debug("[appCache] Cleared all values from sessionStorage"))}catch(e){throw r.vF.error("[appCache] Error clearing cache:",e),e}}let l=c,u=s,d={setCacheValue:a,getCacheValue:i,removeCacheValue:c,clearCache:s,setAppCacheItem:a,getAppCacheItem:i,removeAppCacheItem:l,clearAppCache:u}},30347:()=>{},49852:(e,t,n)=>{"use strict";n.d(t,{K:()=>a});var r=n(29729),o=n(42749);let a={async getTenantInfo(e){try{if(!e)return o.vF.warn("[apiService] No tenant ID provided to getTenantInfo"),null;return(await r.Ay.get("/api/tenants/".concat(e))).data}catch(t){if(t.response&&404===t.response.status)return o.vF.warn("[apiService] Tenant not found: ".concat(e)),null;return o.vF.warn("[apiService] Error fetching tenant info: ".concat(t.message,". Using mock data.")),{id:e,name:"Business ".concat(e.substring(0,8)),type:"business",status:"active",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}}},async getUserTenants(){try{return(await r.Ay.get("/api/tenants")).data}catch(e){return o.vF.warn("[apiService] Error fetching user tenants: ".concat(e.message,". Using mock data.")),[{id:"11111111-1111-1111-1111-111111111111",name:"",type:"business",status:"active",isOwner:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}]}}}},67821:(e,t,n)=>{"use strict";n.d(t,{default:()=>w});var r=n(95155),o=n(12115),a=n(55166),i=n(68387),c=n(35695),s=n(81746),l=n(11024),u=n(57247),d=n(18997),v=n(51174),h=n(21898),f=n(42749);let g=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,c.useRouter)(),[n,r]=(0,o.useState)({isRecoveryMode:!1,recoveryAttempts:0,recoveredTenantId:null,networkStatus:"unknown",isLoading:!1}),g=(0,o.useRef)({checkRecoveryActive:!1,healthCheckActive:!1,redirectInProgress:!1,isMounted:!1,lastRecoveryAttempt:0,networkDebounceTimeout:null}),{autoRedirect:w=!0,monitorNetwork:p=!0,recoveryThreshold:y=3,pathTenantId:m=null}=e;(0,o.useEffect)(()=>(g.current.isMounted=!0,()=>{g.current.isMounted=!1,g.current.networkDebounceTimeout&&clearTimeout(g.current.networkDebounceTimeout)}),[]);let C=(0,o.useCallback)(()=>m&&(0,v.isValidUUID)(m)?m:window.location.pathname.split("/").filter(Boolean).find(e=>(0,v.isValidUUID)(e))||null,[m]),_=(0,o.useCallback)(()=>{let e=Date.now()-g.current.lastRecoveryAttempt;return e<1e4&&(f.vF.debug("[TenantRecovery] Recovery on cooldown (".concat(Math.round(e/1e3),"s elapsed of ").concat(10,"s cooldown)")),!0)},[]),I=(0,o.useCallback)(async()=>{if(g.current.checkRecoveryActive||!g.current.isMounted||_())return f.vF.debug("[TenantRecovery] Recovery check already in progress, on cooldown, or component unmounted, skipping"),!1;g.current.checkRecoveryActive=!0;try{let e=parseInt(localStorage.getItem("tenant_recovery_attempts")||"0",10);if("true"===localStorage.getItem("tenant_fallback_activated")||e>=y||(0,d.Bm)()){let t=(0,u.If)()||C();return g.current.isMounted&&r(n=>(0,i._)((0,a._)({},n),{isRecoveryMode:!0,recoveryAttempts:e,recoveredTenantId:t})),t&&(0,v.isValidUUID)(t)&&(0,u.jJ)(t),g.current.lastRecoveryAttempt=Date.now(),!0}return!1}catch(e){return f.vF.error("[TenantRecovery] Error checking recovery mode:",e),!1}finally{g.current.checkRecoveryActive=!1}},[y,C,_]),b=(0,o.useCallback)(e=>{g.current.isMounted&&e&&(g.current.networkDebounceTimeout&&(clearTimeout(g.current.networkDebounceTimeout),g.current.networkDebounceTimeout=null),g.current.networkDebounceTimeout=setTimeout(()=>{g.current.isMounted&&(r(t=>(0,i._)((0,a._)({},t),{networkStatus:e.quality||"unknown"})),("degraded"===e.quality||"offline"===e.quality||"cognito-degradation"===e.type)&&((0,u.If)()||C())&&!_()&&g.current.isMounted&&I().catch(e=>{f.vF.error("[TenantRecovery] Error in recovery check:",e)}))},300))},[I,C,_]),A=(0,o.useCallback)(async()=>{if(g.current.healthCheckActive||!g.current.isMounted||!(0,d.ZF)())return void f.vF.debug("[TenantRecovery] Health check already in progress, on cooldown, or component unmounted, skipping");g.current.healthCheckActive=!0;try{await (0,d.Bp)()}catch(e){f.vF.warn("[TenantRecovery] API health check failed:",e)}finally{g.current.healthCheckActive=!1}},[]);(0,o.useEffect)(()=>{if(!p||!g.current.isMounted)return;let e=(0,d.f7)(),t=(0,d.Y4)(b);return g.current.isMounted&&setTimeout(A,500),I(),()=>{t&&t(),e&&e()}},[p,b,A,I]);let T=(0,o.useCallback)(async()=>{try{var e,t;let n;g.current.isMounted&&r(e=>(0,i._)((0,a._)({},e),{isLoading:!0}));try{await (0,h.iD)(s.H);let e=(n=await (0,h.cw)(l.T))&&(n["custom:tenant_ID"]||n["custom:tenantId"]||n["custom:businessid"]);if(e&&(0,v.isValidUUID)(e))return(0,u.jJ)(e),g.current.isMounted&&r(e=>(0,i._)((0,a._)({},e),{isLoading:!1})),e}catch(e){f.vF.warn("[TenantRecovery] Error getting tenant ID from Cognito:",e)}let o=(0,u.If)();if(o&&(0,v.isValidUUID)(o))return f.vF.info("[TenantRecovery] Using fallback tenant ID:",o),g.current.isMounted&&r(e=>(0,i._)((0,a._)({},e),{isLoading:!1})),o;let c=C();if(c&&(0,v.isValidUUID)(c))return f.vF.info("[TenantRecovery] Using tenant ID from path:",c),(0,u.jJ)(c),g.current.isMounted&&r(e=>(0,i._)((0,a._)({},e),{isLoading:!1})),c;if((null==(t=window.__APP_CACHE)||null==(e=t.tenant)?void 0:e.id)&&(0,v.isValidUUID)(window.__APP_CACHE.tenant.id))return f.vF.info("[TenantRecovery] Using tenant ID from AppCache:",window.__APP_CACHE.tenant.id),(0,u.jJ)(window.__APP_CACHE.tenant.id),g.current.isMounted&&r(e=>(0,i._)((0,a._)({},e),{isLoading:!1})),window.__APP_CACHE.tenant.id;return f.vF.warn("[TenantRecovery] No valid tenant ID found through any method"),g.current.isMounted&&r(e=>(0,i._)((0,a._)({},e),{isLoading:!1})),null}catch(e){return f.vF.error("[TenantRecovery] Critical error getting tenant ID:",e),g.current.isMounted&&r(e=>(0,i._)((0,a._)({},e),{isLoading:!1})),(0,u.If)()||C()}},[C]);(0,o.useEffect)(()=>{if(!w||!n.isRecoveryMode||!g.current.isMounted||n.isLoading)return;if(g.current.redirectInProgress)return void f.vF.debug("[TenantRecovery] Redirect already in progress, skipping");let e=n.recoveredTenantId||(0,u.If)()||C();if(e&&(0,v.isValidUUID)(e)){let n=window.location.pathname;if(n.includes("/".concat(e,"/"))&&(n.includes("recovery=true")||window.location.search.includes("recovery=true")))return void f.vF.info("[TenantRecovery] Already on recovery route:",n);if(n.includes("/".concat(e,"/"))){if(f.vF.info("[TenantRecovery] Already on correct tenant route:",n),!window.location.search.includes("recovery=true")){g.current.redirectInProgress=!0;let e=n+(window.location.search?window.location.search+"&recovery=true":"?recovery=true");try{t.replace(e)}catch(e){f.vF.error("[TenantRecovery] Error adding recovery param:",e),g.current.redirectInProgress=!1}}return}f.vF.info("[TenantRecovery] Auto-redirecting to tenant dashboard:",e),g.current.redirectInProgress=!0;try{let n=(0,u.hs)(e);t.push(n),setTimeout(()=>{g.current.redirectInProgress=!1},5e3)}catch(e){f.vF.error("[TenantRecovery] Error during redirect:",e),g.current.redirectInProgress=!1}}},[w,n,t,C]);let x=(0,o.useCallback)(async()=>{if(!g.current.isMounted)return{success:!1,message:"Component unmounted"};if(_())return{success:!1,message:"Recovery on cooldown"};g.current.isMounted&&r(e=>(0,i._)((0,a._)({},e),{isLoading:!0}));let e=await T();if(e){if((0,u.jJ)(e),g.current.isMounted&&r(t=>(0,i._)((0,a._)({},t),{isRecoveryMode:!0,recoveryAttempts:t.recoveryAttempts+1,recoveredTenantId:e,isLoading:!1})),g.current.lastRecoveryAttempt=Date.now(),w&&!g.current.redirectInProgress&&g.current.isMounted){g.current.redirectInProgress=!0;try{let n=(0,u.hs)(e);return t.push(n),setTimeout(()=>{g.current.redirectInProgress=!1},5e3),{success:!0,tenantId:e,recoveryUrl:n}}catch(t){return f.vF.error("[TenantRecovery] Error redirecting:",t),g.current.redirectInProgress=!1,g.current.isMounted&&r(e=>(0,i._)((0,a._)({},e),{isLoading:!1})),{success:!1,tenantId:e,error:t.message,recoveryUrl:(0,u.hs)(e)}}}return{success:!0,tenantId:e,recoveryUrl:(0,u.hs)(e)}}return g.current.isMounted&&r(e=>(0,i._)((0,a._)({},e),{isLoading:!1})),{success:!1,message:"No valid tenant ID found for recovery"}},[T,w,t,_]),E=(0,o.useCallback)(()=>{if(!g.current.isMounted)return!1;if(g.current.redirectInProgress)return f.vF.debug("[TenantRecovery] Emergency recovery already in progress, skipping"),!1;if(_())return!1;g.current.redirectInProgress=!0,g.current.lastRecoveryAttempt=Date.now();try{let e=(0,u.GJ)();return setTimeout(()=>{g.current.redirectInProgress=!1},5e3),e}catch(e){return f.vF.error("[TenantRecovery] Emergency recovery failed:",e),g.current.redirectInProgress=!1,!1}},[_]);return(0,i._)((0,a._)({},n),{getAuthorizedTenantId:T,triggerRecovery:x,emergencyRecover:E,checkRecoveryMode:I})},w=e=>{let{children:t,pathTenantId:n=null,autoRedirect:a=!0,showRecoveryState:i=!1,className:c=""}=e,s=g({autoRedirect:a,pathTenantId:n,recoveryThreshold:2}),[l,u]=(0,o.useState)(!1),[v,h]=(0,o.useState)({unreliable:!1}),w=(0,o.useCallback)(()=>{s.isRecoveryMode||s.triggerRecovery().catch(e=>{f.vF.error("[TenantRecoveryWrapper] Error triggering recovery:",e)})},[s.isRecoveryMode,s.triggerRecovery]);return(0,o.useEffect)(()=>{h({unreliable:(0,d.Bm)()});let e=setInterval(()=>{let e=(0,d.Bm)();h({unreliable:e}),e&&(f.vF.warn("[TenantRecoveryWrapper] Cognito connectivity appears unreliable"),w())},5e3);return()=>clearInterval(e)},[w]),(0,o.useEffect)(()=>{let e=e=>{e.ctrlKey&&e.shiftKey&&"D"===e.key&&(e.preventDefault(),u(e=>!e))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]),(0,o.useEffect)(()=>{let e=null,t=()=>{f.vF.info("[TenantRecoveryWrapper] Network went offline"),e=setTimeout(()=>{w()},3e3)},n=()=>{e&&(clearTimeout(e),e=null)};return window.addEventListener("offline",t),window.addEventListener("online",n),()=>{window.removeEventListener("offline",t),window.removeEventListener("online",n),e&&clearTimeout(e)}},[w]),(0,r.jsxs)("div",{className:"tenant-recovery-wrapper ".concat(c),children:[i&&(s.isRecoveryMode||v.unreliable)&&(0,r.jsxs)("div",{className:"tenant-recovery-banner p-2 bg-amber-100 text-amber-800 text-sm text-center border-b border-amber-200",children:[(0,r.jsx)("span",{children:"Running in recovery mode – Some features may be limited"}),s.recoveredTenantId&&(0,r.jsxs)("span",{className:"ml-2 font-mono text-xs",children:["Tenant: ",s.recoveredTenantId]})]}),t,l&&(0,r.jsxs)("div",{className:"fixed bottom-0 right-0 bg-gray-900 text-white p-4 text-xs font-mono rounded-tl-md max-w-md max-h-80 overflow-auto z-50",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsx)("h3",{className:"font-bold",children:"Tenant Recovery Debug"}),(0,r.jsx)("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-white",children:"Close"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-1",children:[(0,r.jsx)("div",{children:"Recovery Mode:"}),(0,r.jsx)("div",{className:s.isRecoveryMode?"text-green-400":"text-gray-400",children:s.isRecoveryMode?"ACTIVE":"Inactive"}),(0,r.jsx)("div",{children:"Attempts:"}),(0,r.jsx)("div",{children:s.recoveryAttempts}),(0,r.jsx)("div",{children:"Tenant ID:"}),(0,r.jsx)("div",{className:"truncate",children:s.recoveredTenantId||"None"}),(0,r.jsx)("div",{children:"Network:"}),(0,r.jsx)("div",{className:"excellent"===s.networkStatus||"good"===s.networkStatus?"text-green-400":"fair"===s.networkStatus?"text-yellow-400":"text-red-400",children:s.networkStatus}),(0,r.jsx)("div",{children:"Cognito Status:"}),(0,r.jsx)("div",{className:v.unreliable?"text-red-400":"text-green-400",children:v.unreliable?"UNRELIABLE":"OK"})]}),(0,r.jsxs)("div",{className:"mt-3 flex space-x-2",children:[(0,r.jsx)("button",{onClick:()=>s.triggerRecovery(),className:"bg-blue-700 hover:bg-blue-600 text-white px-2 py-1 rounded text-xs",children:"Trigger Recovery"}),(0,r.jsx)("button",{onClick:()=>s.emergencyRecover(),className:"bg-red-700 hover:bg-red-600 text-white px-2 py-1 rounded text-xs",children:"Emergency Recovery"})]})]})]})}},70988:(e,t,n)=>{"use strict";n.d(t,{default:()=>o});var r=n(12115);function o(){return(0,r.useEffect)(()=>{window.__APP_CACHE||(window.__APP_CACHE={auth:{provider:"cognito",initialized:!0},user:{},tenant:{},tenants:{}},console.log("[ClientSideScripts] AppCache initialized")),window.setCacheValue||(window.setCacheValue=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{if(!window.__APP_CACHE)return!1;let r=Date.now(),o=n.ttl||36e5;return window.__APP_CACHE[e]={value:t,timestamp:r,expiresAt:r+o,ttl:o},!0}catch(t){return console.error("[AppCache] Error setting cache value for key ".concat(e,":"),t),!1}}),window.getCacheValue||(window.getCacheValue=function(e){try{if(!window.__APP_CACHE)return null;let t=window.__APP_CACHE[e];if(!t)return null;if(t.expiresAt&&void 0!==t.value){if(Date.now()>t.expiresAt)return delete window.__APP_CACHE[e],null;return t.value}return t}catch(t){return console.error("[AppCache] Error getting cache value for key ".concat(e,":"),t),null}}),window.__APP_CONFIG=window.__APP_CONFIG||{},window.__APP_CONFIG.allowedUserAttributes=["name","given_name","family_name","preferred_username","email","phone_number","address","birthdate","gender","locale","picture","website","zoneinfo","custom:tenant_ID","custom:businessid","custom:onboarding","custom:setupdone","custom:plan","custom:subplan","custom:created_at","custom:updated_at","custom:last_login","custom:theme","custom:language"],console.warn("[AttributesFix] IMPORTANT: Use only custom:tenant_ID (uppercase ID) and not custom:tenant_id (lowercase id). The lowercase version is not allowed for updates."),!function(){try{let e=window.location.pathname.match(/^\/([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})(\/|$)/i);if(e){let t=e[1];return console.log("[ClientSideScripts] Found tenant ID in URL: ".concat(t)),window.setCacheValue("tenantId",t,{ttl:864e5}),window.__APP_CACHE&&(window.__APP_CACHE.tenant=window.__APP_CACHE.tenant||{},window.__APP_CACHE.tenant.id=t),console.log("[ClientSideScripts] Tenant ID stored in AppCache"),t}let t=new URLSearchParams(window.location.search).get("tenantId");if(t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(t))console.log("[ClientSideScripts] Found tenant ID in query params: ".concat(t)),window.setCacheValue("tenantId",t,{ttl:864e5}),window.__APP_CACHE&&(window.__APP_CACHE.tenant=window.__APP_CACHE.tenant||{},window.__APP_CACHE.tenant.id=t),console.log("[ClientSideScripts] Tenant ID from query stored in AppCache"),t}catch(e){return console.error("[ClientSideScripts] Error extracting tenant ID from URL:",e),null}}(),console.log("[ClientSideScripts] Fix scripts initialized successfully in client context")},[]),null}},74019:(e,t,n)=>{"use strict";n.d(t,{default:()=>g});var r=n(95155),o=n(12115),a=n(12528),i=n(14882),c=n(47070),s=n(27787),l=n(55028),u=n(24139),d=n(63900),v=n(49509);!function(){try{d.E.configure({Auth:{Cognito:{region:"us-east-1",userPoolId:v.env.NEXT_PUBLIC_USER_POOL_ID||"us-east-1_JPL8vGfb6",userPoolClientId:v.env.NEXT_PUBLIC_USER_POOL_CLIENT_ID||"1o5v84mrgn4gt87khtr179uc5b"}}}),console.log("[AuthInitializer] Auth configuration applied successfully")}catch(e){return console.error("[AuthInitializer] Error initializing Auth:",e),!1}}();let h=()=>((0,o.useEffect)(()=>{console.log("[TenantMiddleware] Using fallback tenant middleware");try{let e=localStorage.getItem("tenantId");e&&console.info("[TenantMiddleware] Found tenant ID in storage: ".concat(e))}catch(e){console.warn("[TenantMiddleware] Error checking localStorage:",e)}},[]),null),f=(0,l.default)(()=>n.e(94831).then(n.bind(n,94831)),{loadableGenerated:{webpack:()=>[94831]},ssr:!1,loading:()=>null,onError:e=>(console.error("[TenantMiddleware] Error loading middleware component:",e),(0,r.jsx)(h,{}))});function g(e){let{children:t}=e,[n,l]=(0,o.useState)(null);return((0,o.useEffect)(()=>{let e=e=>{console.error("[Providers] Caught unhandled error:",e.error),l(e.error),e.preventDefault()};return window.addEventListener("error",e),()=>window.removeEventListener("error",e)},[]),n)?(0,r.jsxs)("div",{style:{padding:"20px",color:"red"},children:[(0,r.jsx)("h2",{children:"Something went wrong"}),(0,r.jsx)("p",{children:"Please refresh the page to try again."}),(0,r.jsx)("button",{onClick:()=>window.location.reload(),style:{padding:"8px 16px",backgroundColor:"#0070f3",color:"white",border:"none",borderRadius:"4px"},children:"Refresh"})]}):(0,r.jsx)(s.vD,{children:(0,r.jsx)(c.SessionProvider,{children:(0,r.jsx)(a.OJ,{children:(0,r.jsx)(i.WE,{children:(0,r.jsxs)(u.oA,{children:[(0,r.jsx)(f,{}),t]})})})})})}},75806:(e,t,n)=>{"use strict";n.d(t,{default:()=>i});var r=n(12115),o=n(60584),a=n(42749);function i(){return(0,r.useEffect)(()=>{try{(0,o.initAmplify)()?a.vF.info("[AuthInitializer] Auth configuration applied successfully"):a.vF.warn("[AuthInitializer] Auth configuration failed, will retry on user interaction")}catch(e){a.vF.error("[AuthInitializer] Error initializing auth:",e)}},[]),null}},85619:(e,t,n)=>{Promise.resolve().then(n.t.bind(n,69243,23)),Promise.resolve().then(n.t.bind(n,40266,23)),Promise.resolve().then(n.t.bind(n,61862,23)),Promise.resolve().then(n.t.bind(n,30347,23)),Promise.resolve().then(n.bind(n,74019)),Promise.resolve().then(n.bind(n,75806)),Promise.resolve().then(n.bind(n,70988)),Promise.resolve().then(n.bind(n,67821)),Promise.resolve().then(n.bind(n,60584)),Promise.resolve().then(n.bind(n,66352))}},e=>{var t=t=>e(e.s=t);e.O(0,[11465,67690,54940,9296,79480,58430,84620,23639,38501,78746,20171,79189,62052,66352,47070,38272,71139,29729,47856,67953,93078,64070,24139,28441,31684,77358],()=>t(85619)),_N_E=e.O()}]);