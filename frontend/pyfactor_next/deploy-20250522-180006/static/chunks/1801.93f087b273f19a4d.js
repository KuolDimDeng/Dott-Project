"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1801],{1801:(e,o,s)=>{s.r(o),s.d(o,{default:()=>m});var r=s(55166),t=s(68387),n=s(95155),l=s(12115),a=s(29729),c=s(87449);let i=[{value:"woocommerce",label:"WooCommerce"},{value:"shopify",label:"Shopify"}],m=l.memo(e=>{var o,s;let{initialStatus:m,initialPlatform:d,initialBusinessData:u,title:h}=e;console.log("IntegrationSettings rendered",{initialStatus:m,initialPlatform:d,initialBusinessData:u,title:h});let x=(0,c.d)(),[p,f]=(0,l.useState)(u),[g,y]=(0,l.useState)(!1),[b,j]=(0,l.useState)(null),[w,v]=(0,l.useState)({url:"",consumer_key:"",consumer_secret:""}),[N,C]=(0,l.useState)({shop:""}),[S,k]=(0,l.useState)(!1),[_,F]=(0,l.useState)("woocommerce"),[W,A]=(0,l.useState)(!1);(0,l.useEffect)(()=>{console.log("IntegrationSettings useEffect triggered",{initialBusinessData:u,loading:g}),m&&d&&I(m,d)},[m,d]);let I=(e,o)=>{"success"===e&&"shopify"===o?(x.info("Successfully connected to Shopify!"),A(!0)):"error"===e&&"shopify"===o&&(x.error("Failed to connect to Shopify. Please try again."),A(!1)),F("shopify")},L=(e,o)=>{let{name:s,value:n}=e.target;"woocommerce"===o?v(e=>(0,t._)((0,r._)({},e),{[s]:n})):"shopify"===o&&C(e=>(0,t._)((0,r._)({},e),{[s]:n}))},U=async()=>{k(!0);try{let e=await a.SP.post("/api/integrations/connect-woocommerce/",w);x.info(e.data.message)}catch(s){var e,o;x.error((null==(o=s.response)||null==(e=o.data)?void 0:e.message)||"An error occurred while connecting to WooCommerce")}finally{k(!1)}},z=async()=>{k(!0);try{let e=await a.SP.post("/api/integrations/initiate-shopify-oauth/",{shop:N.shop});e.data.authUrl?window.location.href=e.data.authUrl:x.error("Failed to initiate Shopify OAuth: No auth URL received")}catch(s){var e,o;x.error((null==(o=s.response)||null==(e=o.data)?void 0:e.message)||"An error occurred while initiating Shopify OAuth")}finally{k(!1)}},E=e=>{F(e)};return console.log("IntegrationSettings rendering content",{businessData:p}),(0,n.jsx)("div",{className:"bg-white min-h-screen p-6",children:(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,n.jsx)("h4",{className:"text-2xl font-semibold mb-4",children:h||"Integrations Settings"}),W&&(0,n.jsx)("p",{className:"text-green-600 mb-4",children:"Connected to Shopify"}),p&&(null==(o=p.business_type)?void 0:o.toLowerCase())==="ecommerce"&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"border-b border-gray-200",children:(0,n.jsx)("nav",{className:"flex -mb-px",children:i.map(e=>(0,n.jsx)("button",{className:"py-2 px-4 font-medium text-sm mr-8 ".concat(_===e.value?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700 hover:border-gray-300"),onClick:()=>E(e.value),children:e.label},e.value))})}),(0,n.jsxs)("div",{className:"mt-6",children:["woocommerce"===_&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h5",{className:"text-xl font-semibold",children:"WooCommerce"}),(0,n.jsx)("p",{className:"mt-2 text-gray-700",children:"Connect to your WooCommerce store here."}),(0,n.jsxs)("form",{className:"mt-4 space-y-4",noValidate:!0,autoComplete:"off",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"woo-url",className:"block text-sm font-medium text-gray-700 mb-1",children:"WooCommerce Store URL"}),(0,n.jsx)("input",{id:"woo-url",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",name:"url",value:w.url,onChange:e=>L(e,"woocommerce")})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"consumer-key",className:"block text-sm font-medium text-gray-700 mb-1",children:"Consumer Key"}),(0,n.jsx)("input",{id:"consumer-key",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",name:"consumer_key",value:w.consumer_key,onChange:e=>L(e,"woocommerce")})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"consumer-secret",className:"block text-sm font-medium text-gray-700 mb-1",children:"Consumer Secret"}),(0,n.jsx)("input",{id:"consumer-secret",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",name:"consumer_secret",type:"password",value:w.consumer_secret,onChange:e=>L(e,"woocommerce")})]}),(0,n.jsx)("div",{children:(0,n.jsx)("button",{type:"button",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-400 disabled:cursor-not-allowed",onClick:U,disabled:S,children:S?(0,n.jsxs)("div",{className:"flex items-center justify-center",children:[(0,n.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,n.jsx)("span",{children:"Connecting..."})]}):"Connect to WooCommerce"})})]})]}),"shopify"===_&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h5",{className:"text-xl font-semibold",children:"Shopify"}),(0,n.jsx)("p",{className:"mt-2 text-gray-700",children:"Connect to your Shopify store here."}),(0,n.jsxs)("form",{className:"mt-4 space-y-4",noValidate:!0,autoComplete:"off",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"shopify-url",className:"block text-sm font-medium text-gray-700 mb-1",children:"Shopify Store URL"}),(0,n.jsx)("input",{id:"shopify-url",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",name:"shop",value:N.shop,onChange:e=>L(e,"shopify"),placeholder:"yourstore.myshopify.com"})]}),(0,n.jsx)("div",{children:(0,n.jsx)("button",{type:"button",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-400 disabled:cursor-not-allowed",onClick:z,disabled:S,children:S?(0,n.jsxs)("div",{className:"flex items-center justify-center",children:[(0,n.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,n.jsx)("span",{children:"Connecting..."})]}):"Connect to Shopify"})})]})]})]})]}),(!p||(null==(s=p.business_type)?void 0:s.toLowerCase())!=="ecommerce")&&(0,n.jsx)("p",{className:"text-gray-700",children:"Integration settings are only available for e-commerce businesses."})]})})})}}]);