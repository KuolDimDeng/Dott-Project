"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[62703],{62703:(e,t,s)=>{s.r(t),s.d(t,{default:()=>u});var r=s(55166),a=s(68387),l=s(95155),c=s(12115),o=s(29729),d=s(87449);let n=()=>(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,l.jsx)("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})}),i=()=>(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,l.jsx)("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})}),u=()=>{let[e,t]=(0,c.useState)(0),[s,u]=(0,c.useState)([]),[m,x]=(0,c.useState)(null),[p,h]=(0,c.useState)({vendor:"",date:new Date,items:[],discount:0,currency:"USD",totalAmount:0,status:"draft"}),b=(0,d.d)(),[g,y]=(0,c.useState)(!1),[f,j]=(0,c.useState)(null),[v,w]=(0,c.useState)(!1),[N,k]=(0,c.useState)([]),[C,S]=(0,c.useState)([]),[_,D]=(0,c.useState)(""),[P,E]=(0,c.useState)([]);(0,c.useEffect)(()=>{O(),A(),q()},[]);let O=async()=>{try{let e=await o.SP.get("/api/purchase-orders/");u(e.data)}catch(e){console.error("Error fetching purchase orders:",e),b.error("Failed to fetch purchase orders")}},A=async()=>{try{let e=await o.SP.get("/api/vendors/");k(e.data)}catch(e){console.error("Error fetching vendors:",e),b.error("Failed to fetch vendors")}},q=async()=>{try{let e=await o.SP.get("/api/products/");S(e.data)}catch(e){console.error("Error fetching products:",e),b.error("Failed to fetch products")}},F=(e,s)=>{t(s)},R=e=>{let{name:t,value:s}=e.target;h(e=>(0,a._)((0,r._)({},e),{[t]:s}))},U=e=>{let t=[...p.items];t.splice(e,1);let s=[...P];s.splice(e,1),E(s),h(e=>(0,a._)((0,r._)({},e),{items:t,totalAmount:T(t,e.discount)}))},V=(e,t,s)=>{let l=[...p.items];if(l[e][t]=s,"product"===t){let t=C.find(e=>e.id===s);if(t){l[e].description=t.name,l[e].unit_price=parseFloat(t.price)||0;let s=[...P];s[e]=t,E(s)}}("quantity"===t||"unit_price"===t)&&(l[e][t]=parseFloat(s)||0),l[e].total=l[e].quantity*l[e].unit_price,h(e=>(0,a._)((0,r._)({},e),{items:l,totalAmount:T(l,e.discount)}))},T=(e,t)=>e.reduce((e,t)=>e+t.quantity*t.unit_price,0)-t,z=async e=>{e.preventDefault();try{console.log("Sending purchase order data:",p),await o.SP.post("/api/purchase-orders/create/",p),b.success("Purchase order created successfully"),O(),t(2)}catch(e){var s,r;console.error("Error creating purchase order:",e),e.response?(console.error("Error data:",e.response.data),console.error("Error status:",e.response.status),console.error("Error headers:",e.response.headers)):e.request?console.error("Error request:",e.request):console.error("Error message:",e.message),b.error("Failed to create purchase order: "+((null==(r=e.response)||null==(s=r.data)?void 0:s.error)||e.message))}},B=e=>{x(e),t(1)},I=async()=>{try{let e=await o.SP.put("/api/purchase-orders/".concat(m.id,"/"),f);x(e.data),y(!1),O(),b.success("Purchase order updated successfully")}catch(e){console.error("Error updating purchase order:",e),b.error("Failed to update purchase order")}},L=async()=>{try{await o.SP.delete("/api/purchase-orders/".concat(m.id,"/")),b.success("Purchase order deleted successfully"),w(!1),x(null),O(),t(2)}catch(e){console.error("Error deleting purchase order:",e),b.error("Failed to delete purchase order")}};return(0,l.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Purchase Order Management"}),(0,l.jsx)("div",{className:"border-b border-gray-200 mb-6",children:(0,l.jsxs)("nav",{className:"flex -mb-px",children:[(0,l.jsx)("button",{onClick:e=>F(e,0),className:"py-3 px-4 text-center border-b-2 font-medium text-sm ".concat(0===e?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Create"}),(0,l.jsx)("button",{onClick:e=>F(e,1),className:"py-3 px-4 text-center border-b-2 font-medium text-sm ".concat(1===e?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Details"}),(0,l.jsx)("button",{onClick:e=>F(e,2),className:"py-3 px-4 text-center border-b-2 font-medium text-sm ".concat(2===e?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"List"})]})}),0===e&&(0,l.jsxs)("div",{className:"mt-3",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Create Purchase Order"}),(0,l.jsxs)("form",{onSubmit:z,children:[(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vendor"}),(0,l.jsxs)("select",{name:"vendor",value:p.vendor,onChange:R,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[(0,l.jsx)("option",{value:"",children:"Select a vendor"}),N.map(e=>(0,l.jsx)("option",{value:e.id,children:e.vendor_name},e.id))]})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),(0,l.jsx)("input",{type:"date",value:p.date instanceof Date?p.date.toISOString().split("T")[0]:"",onChange:e=>{let t=new Date(e.target.value);h(e=>(0,a._)((0,r._)({},e),{date:t}))},className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),(0,l.jsx)("h3",{className:"text-lg font-medium text-gray-700 mb-2",children:"Items"}),p.items.map((e,t)=>(0,l.jsxs)("div",{className:"flex flex-wrap items-center mb-4 gap-2",children:[(0,l.jsx)("div",{className:"w-full md:w-1/4 lg:w-1/5",children:(0,l.jsxs)("select",{value:e.product||"",onChange:e=>V(t,"product",e.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[(0,l.jsx)("option",{value:"",children:"Select a product"}),C.map(e=>(0,l.jsx)("option",{value:e.id,children:e.name},e.id))]})}),(0,l.jsx)("div",{className:"w-full md:w-1/4 lg:w-1/5",children:(0,l.jsx)("input",{type:"text",placeholder:"Description",value:e.description||"",onChange:e=>V(t,"description",e.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})}),(0,l.jsx)("div",{className:"w-full md:w-1/6 lg:w-1/8",children:(0,l.jsx)("input",{type:"number",placeholder:"Quantity",value:e.quantity,onChange:e=>V(t,"quantity",e.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})}),(0,l.jsx)("div",{className:"w-full md:w-1/6 lg:w-1/8",children:(0,l.jsx)("input",{type:"number",step:"0.01",placeholder:"Unit Price",value:e.unit_price,onChange:e=>V(t,"unit_price",e.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})}),(0,l.jsx)("div",{className:"w-full md:w-1/6 lg:w-1/8",children:(0,l.jsx)("input",{type:"text",placeholder:"Total",value:(e.quantity*e.unit_price).toFixed(2),readOnly:!0,className:"block w-full rounded-md bg-gray-100 border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})}),(0,l.jsx)("button",{type:"button",onClick:()=>U(t),className:"p-2 text-red-600 hover:text-red-800 focus:outline-none",children:(0,l.jsx)(i,{})})]},t)),(0,l.jsxs)("div",{className:"flex flex-wrap gap-2 mb-4",children:[(0,l.jsx)("div",{className:"flex-grow",children:(0,l.jsx)("input",{type:"text",placeholder:"Add Custom Product",value:_,onChange:e=>D(e.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})}),(0,l.jsx)("button",{type:"button",onClick:()=>{""!==_.trim()&&(h(e=>(0,a._)((0,r._)({},e),{items:[...e.items,{product:null,description:_,quantity:1,unit_price:0,total:0}]})),E([...P,null]),D(""))},className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Add Custom Product"})]}),(0,l.jsxs)("button",{type:"button",onClick:()=>{h(e=>(0,a._)((0,r._)({},e),{items:[...e.items,{product:"",quantity:1,unit_price:0}]})),E([...P,null])},className:"flex items-center mb-4 text-blue-600 hover:text-blue-800",children:[(0,l.jsx)(n,{}),(0,l.jsx)("span",{className:"ml-1",children:"Add Item"})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Discount"}),(0,l.jsx)("input",{type:"number",name:"discount",value:p.discount,onChange:R,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Amount"}),(0,l.jsx)("input",{type:"text",value:p.totalAmount.toFixed(2),readOnly:!0,className:"mt-1 block w-full rounded-md bg-gray-100 border-gray-300 shadow-sm"})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Currency"}),(0,l.jsxs)("select",{name:"currency",value:p.currency,onChange:R,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[(0,l.jsx)("option",{value:"USD",children:"USD"}),(0,l.jsx)("option",{value:"EUR",children:"EUR"}),(0,l.jsx)("option",{value:"GBP",children:"GBP"})]})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,l.jsxs)("select",{name:"status",value:p.status,onChange:R,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[(0,l.jsx)("option",{value:"draft",children:"Draft"}),(0,l.jsx)("option",{value:"sent",children:"Sent"}),(0,l.jsx)("option",{value:"received",children:"Received"}),(0,l.jsx)("option",{value:"cancelled",children:"Cancelled"})]})]}),(0,l.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Create Purchase Order"})]})]}),1===e&&(0,l.jsxs)("div",{className:"mt-3",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Purchase Order Details"}),m?(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Order Number"}),(0,l.jsx)("input",{type:"text",value:m.order_number,readOnly:!0,className:"mt-1 block w-full rounded-md bg-gray-100 border-gray-300 shadow-sm"})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vendor"}),(0,l.jsx)("input",{type:"text",value:m.vendor_name,readOnly:!g,className:"mt-1 block w-full rounded-md ".concat(g?"":"bg-gray-100"," border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500")})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),(0,l.jsx)("input",{type:"date",value:m.date,readOnly:!g,className:"mt-1 block w-full rounded-md ".concat(g?"":"bg-gray-100"," border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500")})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Amount"}),(0,l.jsx)("input",{type:"text",value:m.totalAmount,readOnly:!0,className:"mt-1 block w-full rounded-md bg-gray-100 border-gray-300 shadow-sm"})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Discount"}),(0,l.jsx)("input",{type:"text",value:m.discount,readOnly:!g,className:"mt-1 block w-full rounded-md ".concat(g?"":"bg-gray-100"," border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500")})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Currency"}),(0,l.jsx)("input",{type:"text",value:m.currency,readOnly:!g,className:"mt-1 block w-full rounded-md ".concat(g?"":"bg-gray-100"," border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500")})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,l.jsx)("input",{type:"text",value:m.status,readOnly:!g,className:"mt-1 block w-full rounded-md ".concat(g?"":"bg-gray-100"," border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500")})]}),(0,l.jsx)("h3",{className:"text-lg font-medium text-gray-700 mb-2",children:"Items"}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,l.jsx)("thead",{className:"bg-gray-50",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Product"}),(0,l.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),(0,l.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantity"}),(0,l.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Unit Price"}),(0,l.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"})]})}),(0,l.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:m.items.map((e,t)=>(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.product?e.product.name:"Custom Product"}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.description}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.quantity}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.unit_price}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(e.quantity*e.unit_price).toFixed(2)})]},t))})]})}),(0,l.jsx)("div",{className:"mt-4 space-x-2",children:g?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("button",{type:"button",onClick:I,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Save"}),(0,l.jsx)("button",{type:"button",onClick:()=>{y(!1),j(null)},className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2",children:"Cancel"})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("button",{type:"button",onClick:()=>{y(!0),j((0,r._)({},m))},className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Edit"}),(0,l.jsx)("button",{type:"button",onClick:()=>{w(!0)},className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2",children:"Delete"})]})})]}):(0,l.jsx)("p",{className:"text-gray-600",children:"Select a purchase order from the list to view details"})]}),2===e&&(0,l.jsxs)("div",{className:"mt-3",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Purchase Order List"}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,l.jsx)("thead",{className:"bg-gray-50",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order Number"}),(0,l.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Vendor"}),(0,l.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,l.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Amount"}),(0,l.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),(0,l.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(e=>(0,l.jsxs)("tr",{onClick:()=>B(e),className:"cursor-pointer hover:bg-gray-50",children:[(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.order_number}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.vendor_name}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.date).toLocaleDateString()}),(0,l.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[e.totalAmount," ",e.currency]}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.status})]},e.id))})]})})]}),v&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-lg max-w-md w-full",children:[(0,l.jsx)("div",{className:"px-6 pt-6 pb-2",children:(0,l.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:"Confirm Delete"})}),(0,l.jsx)("div",{className:"px-6 py-4",children:(0,l.jsx)("p",{className:"text-gray-700",children:"Are you sure you want to delete this purchase order?"})}),(0,l.jsxs)("div",{className:"px-6 pb-6 pt-2 flex justify-end space-x-3",children:[(0,l.jsx)("button",{onClick:()=>w(!1),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"Cancel"}),(0,l.jsx)("button",{onClick:L,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Delete"})]})]})})]})})}}}]);