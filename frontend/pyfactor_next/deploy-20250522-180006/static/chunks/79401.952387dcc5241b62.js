"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[79401],{79401:(e,a,t)=>{t.r(a),t.d(a,{default:()=>i});var s=t(95155),n=t(12115),l=t(29729),r=t(6874),c=t.n(r);let i=()=>{let[e,a]=(0,n.useState)([]),[t,r]=(0,n.useState)([]),[i,d]=(0,n.useState)(!0),[o,x]=(0,n.useState)(null),[h,m]=(0,n.useState)(""),[u,g]=(0,n.useState)(""),[p,b]=(0,n.useState)(""),[w,v]=(0,n.useState)(null),f=(0,n.useCallback)(async()=>{try{d(!0);let e=await l.SP.get("/api/banking/accounts/");e.data.accounts&&Array.isArray(e.data.accounts)?(a(e.data.accounts),e.data.accounts.length>0?v(e.data.accounts[0].name.split(" ")[0]):v(null)):(a([]),v(null))}catch(e){console.error("Error fetching banking accounts:",e),x("Failed to fetch banking accounts. Please try again later."),v(null)}finally{d(!1)}},[]),j=(0,n.useCallback)(async()=>{if(!w)return void r([]);try{let e=await l.SP.get("/api/banking/recent-transactions/",{params:{limit:10}});e.data.transactions&&Array.isArray(e.data.transactions)?r(e.data.transactions):r([])}catch(e){console.error("Error fetching recent transactions:",e),x("Failed to fetch recent transactions. Please try again later.")}},[w]);(0,n.useEffect)(()=>{f()},[f]),(0,n.useEffect)(()=>{j()},[j]);let y=async()=>{if(!w)return void x("Please connect a bank account before downloading transactions.");try{let e=await l.SP.get("/api/banking/download-transactions/",{params:{start_date:h,end_date:u},responseType:"blob"}),a=window.URL.createObjectURL(new Blob([e.data])),t=document.createElement("a");t.href=a,t.setAttribute("download","transactions_".concat(h,"_to_").concat(u,".csv")),document.body.appendChild(t),t.click()}catch(e){console.error("Error downloading transactions:",e),x("Failed to download transactions. Please try again.")}},N=t.filter(e=>e.description.toLowerCase().includes(p.toLowerCase()));return i?(0,s.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):o?(0,s.jsx)("div",{className:"text-red-600 p-4",children:o}):(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center mb-2",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 mr-3 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 14v3m4-3v3m4-3v3M3 21h18M3 10h18M3 7l9-4 9 4M4 10h16v11H4V10z"})}),(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Banking Dashboard"})]}),(0,s.jsx)("p",{className:"ml-12 mb-6 text-gray-600",children:"Manage your accounts, download transactions, and view recent activity"}),(0,s.jsxs)("h2",{className:"text-xl font-semibold mb-4 text-indigo-600",children:["Connected Bank: ",w||"None",!w&&(0,s.jsxs)("span",{className:"ml-2 font-normal text-base text-gray-700",children:["Please link a banking institution",(0,s.jsx)(c(),{href:"/connect-bank",className:"ml-1 text-blue-600 hover:underline",children:"here"}),"."]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsx)("div",{className:"col-span-1",children:(0,s.jsxs)("div",{className:"bg-white shadow rounded-lg h-full flex flex-col justify-between",children:[(0,s.jsxs)("div",{className:"p-6 flex-grow",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Bank Accounts"}),e.length>0?(0,s.jsx)("ul",{className:"divide-y divide-gray-200",children:e.map(e=>{var a;return(0,s.jsxs)("li",{className:"py-3",children:[(0,s.jsx)("p",{className:"font-medium",children:e.name}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["Balance: $",(null==(a=e.balances)?void 0:a.current)||"N/A"]})]},e.account_id)})}):(0,s.jsx)("p",{children:"No accounts found. Please connect a bank account to get started."})]}),(0,s.jsx)("div",{className:"px-6 py-4 border-t border-gray-200",children:(0,s.jsxs)("button",{onClick:f,className:"flex items-center text-indigo-600 hover:text-indigo-800 border border-indigo-600 px-4 py-2 rounded-md",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z",clipRule:"evenodd"})}),"Refresh Accounts"]})})]})}),(0,s.jsx)("div",{className:"col-span-1",children:(0,s.jsxs)("div",{className:"bg-white shadow rounded-lg h-full flex flex-col justify-between",children:[(0,s.jsxs)("div",{className:"p-6 flex-grow",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Download Transactions"}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),(0,s.jsx)("input",{type:"date",value:h,onChange:e=>m(e.target.value),className:"w-full p-2 border border-gray-300 rounded-md ".concat(w?"focus:ring-indigo-500 focus:border-indigo-500":"bg-gray-100 cursor-not-allowed"),disabled:!w})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),(0,s.jsx)("input",{type:"date",value:u,onChange:e=>g(e.target.value),className:"w-full p-2 border border-gray-300 rounded-md ".concat(w?"focus:ring-indigo-500 focus:border-indigo-500":"bg-gray-100 cursor-not-allowed"),disabled:!w})]})]}),(0,s.jsx)("div",{className:"px-6 py-4 border-t border-gray-200",children:(0,s.jsxs)("button",{onClick:y,disabled:!w||!h||!u,className:"w-full flex justify-center items-center px-4 py-2 rounded-md ".concat(w&&h&&u?"bg-indigo-600 hover:bg-indigo-700 text-white":"bg-indigo-300 cursor-not-allowed text-white"),children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})}),"Download Transactions"]})})]})}),(0,s.jsx)("div",{className:"col-span-1 md:col-span-2",children:(0,s.jsxs)("div",{className:"bg-white shadow rounded-lg h-full flex flex-col justify-between",children:[(0,s.jsxs)("div",{className:"p-6 flex-grow",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Recent Transactions"}),(0,s.jsxs)("div",{className:"relative mb-4",children:[(0,s.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"})})}),(0,s.jsx)("input",{type:"text",placeholder:"Search transactions...",value:p,onChange:e=>b(e.target.value),className:"w-full pl-10 p-2 border border-gray-300 rounded-md ".concat(w?"focus:ring-indigo-500 focus:border-indigo-500":"bg-gray-100 cursor-not-allowed"),disabled:!w})]}),w?(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),(0,s.jsx)("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,s.jsx)("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:N.length>0?N.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.description}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-right",children:new Date(e.date).toLocaleDateString()}),(0,s.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-right",children:["$",e.amount.toFixed(2)]})]},e.id)):(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:3,className:"px-6 py-4 text-center text-sm text-gray-500",children:"No transactions found."})})})]})}):(0,s.jsx)("p",{className:"text-gray-600",children:"Please connect a bank account to view recent transactions."})]}),(0,s.jsx)("div",{className:"px-6 py-4 border-t border-gray-200",children:(0,s.jsxs)("button",{onClick:j,disabled:!w,className:"flex items-center px-4 py-2 rounded-md ".concat(w?"text-indigo-600 hover:text-indigo-800 border border-indigo-600":"border border-gray-300 text-gray-400 cursor-not-allowed"),children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z",clipRule:"evenodd"})}),"Refresh Transactions"]})})]})})]})]})}}}]);