"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[45066],{19002:(t,e,n)=>{n.d(e,{H:()=>o});var a=n(45103),r=n(84295);let o=async t=>{var e;let n=t.getConfig().Auth?.Cognito;(0,a.$y)(n);let o=await t.Auth.getTokens({forceRefresh:!1});(0,r.H0)(o);let{"cognito:username":s,sub:i}=o.idToken?.payload??{},l={username:s,userId:i},c=(e=o,e?.signInDetails);return c&&(l.signInDetails=c),l}},24818:(t,e,n)=>{n.d(e,{$:()=>o});var a=n(87970),r=n(57762);let o=t=>(0,r.$)(a.H,t)},39641:(t,e,n)=>{n.d(e,{C:()=>i,p:()=>s});var a=n(62904),r=n(61573);let o=new a.C("CoreStorageUtils"),s=()=>{try{if("undefined"!=typeof window&&window.localStorage)return window.localStorage}catch(t){o.info("localStorage not found. InMemoryStorage is used as a fallback.")}return new r._},i=()=>{try{if("undefined"!=typeof window&&window.sessionStorage)return window.sessionStorage.getItem("test"),window.sessionStorage;throw Error("sessionStorage is not defined")}catch(t){return o.info("sessionStorage not found. InMemoryStorage is used as a fallback."),new r._}}},51174:(t,e,n)=>{n.d(e,{$_:()=>c,BI:()=>y,FB:()=>_,Nf:()=>I,Pc:()=>d,fy:()=>p,getTenantId:()=>i,getTenantIdFromCognito:()=>h,h_:()=>w,isValidUUID:()=>l,jW:()=>m,oA:()=>u,pm:()=>f,updateTenantIdInCognito:()=>g});var a=n(81746),r=n(24818),o=n(62052);let s="tenantId",i=async()=>{try{var t,e,n,i,l,c;let u=await o.l.getItem(s);if(u)return u;let d=await (0,a.H)(),g=await (0,r.$)(),w=(null==d||null==(t=d.attributes)?void 0:t["custom:tenant_ID"])||(null==d||null==(e=d.attributes)?void 0:e["custom:tenantId"])||(null==g||null==(i=g.accessToken)||null==(n=i.payload)?void 0:n["custom:tenant_ID"])||(null==g||null==(c=g.accessToken)||null==(l=c.payload)?void 0:l["custom:tenantId"]);if(!w)throw Error("Tenant ID not found in user attributes or session");return await o.l.setItem(s,w),w}catch(t){throw console.error("Error getting tenant ID:",t),t}},l=t=>/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t),c=async t=>{try{await o.l.setItem(s,t)}catch(t){throw console.error("Error storing tenant ID:",t),t}},u=async t=>{let{tenantId:e,metadata:n={}}=t;try{if(!e)return void console.error("Cannot store tenant info: No tenant ID provided");await o.l.setItem(s,e),window.__APP_CACHE||(window.__APP_CACHE={}),window.__APP_CACHE.tenant||(window.__APP_CACHE.tenant={}),window.__APP_CACHE.tenant.id=e,window.__APP_CACHE.tenant.metadata=n,window.__APP_CACHE.tenant.timestamp=Date.now();try{sessionStorage.setItem("tenant_id",e),sessionStorage.setItem("tenant_info",JSON.stringify({id:e,metadata:n,timestamp:Date.now()}))}catch(t){console.debug("Could not store tenant info in sessionStorage:",t)}console.debug("[TenantUtils] Stored tenant info for ID: ".concat(e))}catch(t){console.error("Error storing tenant info:",t)}},d=t=>t?t.charAt(0).toUpperCase()+t.slice(1).toLowerCase():t,g=async t=>{try{let{updateUserAttributes:e}=await Promise.all([n.e(58430),n.e(84620),n.e(23639),n.e(38501),n.e(31861),n.e(94901)]).then(n.bind(n,55158));await e({userAttributes:{"custom:tenant_ID":t}}),await c(t),console.debug("[TenantUtils] Updated tenant ID in Cognito: ".concat(t))}catch(e){console.error("Error updating tenant ID in Cognito:",e),await c(t)}},w=async t=>{try{await o.l.setItem("auth_tokens",t)}catch(t){throw console.error("Error setting tokens:",t),t}},h=async()=>{try{var t,e,n,i,l,c;let u=await o.l.getItem(s);if(u)return u;let d=await (0,a.H)(),g=await (0,r.$)(),w=(null==d||null==(t=d.attributes)?void 0:t["custom:tenant_ID"])||(null==d||null==(e=d.attributes)?void 0:e["custom:tenantId"])||(null==g||null==(i=g.accessToken)||null==(n=i.payload)?void 0:n["custom:tenant_ID"])||(null==g||null==(c=g.accessToken)||null==(l=c.payload)?void 0:l["custom:tenantId"]);if(!w)return null;return await o.l.setItem(s,w),w}catch(t){return console.error("Error getting tenant ID from Cognito:",t),null}},I=async t=>{try{if(!l(t))return!1;return(await fetch("/api/tenants/".concat(t,"/validate"))).ok}catch(t){return console.error("Error validating tenant ID:",t),!1}},f=t=>{let e=0;for(let n=0;n<t.length;n++)e=(e<<5)-e+t.charCodeAt(n),e&=e;return"00000000-0000-4000-a000-".concat(Math.abs(e).toString(16).padStart(12,"0"))},m=async()=>{try{let t=await i();if(!l(t))return console.error("Invalid tenant ID format:",t),null;return t}catch(t){return console.error("Error getting secure tenant ID:",t),null}},y=t=>l(t),_=t=>t?"tenant_".concat(t.replace(/-/g,"_")):"public",p=async()=>{try{let t=await i(),e={"Content-Type":"application/json","x-tenant-id":t};try{let{getCurrentUser:t}=await Promise.all([n.e(58430),n.e(84620),n.e(23639),n.e(38501),n.e(31861),n.e(94901)]).then(n.bind(n,55158)),a=await t();a&&a.userId&&(e["x-user-id"]=a.userId)}catch(t){}return e}catch(t){return console.error("Error getting tenant headers:",t),{"Content-Type":"application/json"}}}},57762:(t,e,n)=>{n.d(e,{$:()=>a});let a=(t,e)=>t.Auth.fetchAuthSession(e)},61573:(t,e,n)=>{n.d(e,{_:()=>a});class a{constructor(){this.storage=new Map}get length(){return this.storage.size}key(t){return t>this.length-1?null:Array.from(this.storage.keys())[t]}setItem(t,e){this.storage.set(t,e)}getItem(t){return this.storage.get(t)??null}removeItem(t){this.storage.delete(t)}clear(){this.storage.clear()}}},81746:(t,e,n)=>{n.d(e,{H:()=>o});var a=n(87970),r=n(19002);let o=async()=>(0,r.H)(a.H)},94225:(t,e,n)=>{n.d(e,{U:()=>r});var a=n(95730);class r{constructor(t){this.storage=t}async setItem(t,e){if(!this.storage)throw new a.h;this.storage.setItem(t,e)}async getItem(t){if(!this.storage)throw new a.h;return this.storage.getItem(t)}async removeItem(t){if(!this.storage)throw new a.h;this.storage.removeItem(t)}async clear(){if(!this.storage)throw new a.h;this.storage.clear()}}},95730:(t,e,n)=>{n.d(e,{h:()=>o});var a=n(31241),r=n(65206);class o extends r.x{constructor(){super({name:a.m.PlatformNotSupported,message:"Function not supported on current platform"})}}}}]);