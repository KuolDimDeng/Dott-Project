"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[92873],{92873:(e,t,s)=>{s.r(t),s.d(t,{default:()=>i});var a=s(55166),r=s(68387),l=s(95155),d=s(12115),n=s(29729),c=s(87449);let i=e=>{let{newBill:t=!1}=e,[s,i]=(0,d.useState)(2*!t),[o,m]=(0,d.useState)([]),[x,p]=(0,d.useState)(null),[u,h]=(0,d.useState)([]),[g,y]=(0,d.useState)(!1),[b,j]=(0,d.useState)(""),[N,v]=(0,d.useState)({vendor:null,currency:"USD",bill_date:null,due_date:null,poso_number:"",total_amount:0,notes:"",items:[{category:"",description:"",quantity:1,price:0,tax:0,amount:0}]}),f=(0,c.d)();(0,d.useEffect)(()=>{w(),_()},[]);let w=async()=>{try{let e=await n.SP.get("/api/bills/");m(Array.isArray(e.data)?e.data:[])}catch(e){console.error("Error fetching bills:",e),e.response&&console.error("Error response:",e.response.data),f.error("Failed to fetch bills"),m([])}},_=async()=>{try{let e=await n.SP.get("/api/vendors/");h(e.data)}catch(e){console.error("Error fetching vendors:",e),f.error("Failed to load vendors")}},k=e=>e.reduce((e,t)=>e+t.quantity*t.price,0),D=e=>{i(e),p(null)},C=e=>{let{name:t,value:s}=e.target;v(e=>(0,r._)((0,a._)({},e),{[t]:s}))},S=e=>{v(t=>(0,r._)((0,a._)({},t),{vendor:e})),y(!1),j("".concat(e.vendor_name," (").concat(e.vendor_number,")"))},B=(e,t)=>{let s=e.target.value?new Date(e.target.value):null;v(e=>(0,r._)((0,a._)({},e),{[t]:s}))},A=(e,t,s)=>{let l=[...N.items];l[e][t]=s,l[e].amount=l[e].quantity*l[e].price;let d=k(l);v(e=>(0,r._)((0,a._)({},e),{items:l,totalAmount:d}))},E=async e=>{e.preventDefault();try{let e=(0,r._)((0,a._)({},N),{vendor:N.vendor.id,items:N.items.map(e=>(0,r._)((0,a._)({},e),{amount:e.quantity*e.price}))});await n.SP.post("/api/bills/create/",e),f.success("Bill created successfully"),w(),i(2)}catch(e){console.error("Error creating bill:",e),e.response&&console.error("Error response:",e.response.data),f.error("Failed to create bill")}},q=e=>{p(e),i(1)},P=e=>e?new Date(e).toISOString().split("T")[0]:"",L=b?u.filter(e=>"".concat(e.vendor_name," ").concat(e.vendor_number).toLowerCase().includes(b.toLowerCase())):u;return(0,l.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Bill Management"}),(0,l.jsx)("div",{className:"border-b border-gray-200 mb-6",children:(0,l.jsxs)("div",{className:"flex space-x-8",children:[(0,l.jsx)("button",{className:"py-2 px-1 border-b-2 ".concat(0===s?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),onClick:()=>D(0),children:"Create Bill"}),(0,l.jsx)("button",{className:"py-2 px-1 border-b-2 ".concat(1===s?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),onClick:()=>D(1),children:"Bill Detail"}),(0,l.jsx)("button",{className:"py-2 px-1 border-b-2 ".concat(2===s?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),onClick:()=>D(2),children:"Bill List"})]})}),0===s&&(0,l.jsxs)("form",{onSubmit:E,children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Vendor ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("input",{type:"text",className:"w-full p-2 border border-gray-300 rounded-md",placeholder:"Search vendors",value:b,onChange:e=>{j(e.target.value),y(!0)},onFocus:()=>y(!0),required:!0}),g&&(0,l.jsx)("div",{className:"absolute z-10 w-full mt-1 bg-white shadow-lg rounded-md border border-gray-300 max-h-60 overflow-y-auto",children:L.length>0?L.map(e=>(0,l.jsxs)("div",{className:"p-2 hover:bg-gray-100 cursor-pointer",onClick:()=>S(e),children:[e.vendor_name," (",e.vendor_number,")"]},e.id)):(0,l.jsx)("div",{className:"p-2 text-gray-500",children:"No vendors found"})})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Currency"}),(0,l.jsxs)("select",{name:"currency",value:N.currency,onChange:C,className:"w-full p-2 border border-gray-300 rounded-md bg-white",children:[(0,l.jsx)("option",{value:"USD",children:"USD"}),(0,l.jsx)("option",{value:"EUR",children:"EUR"}),(0,l.jsx)("option",{value:"GBP",children:"GBP"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bill Date"}),(0,l.jsx)("input",{type:"date",className:"w-full p-2 border border-gray-300 rounded-md",value:P(N.bill_date),onChange:e=>B(e,"bill_date")})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Due Date"}),(0,l.jsx)("input",{type:"date",className:"w-full p-2 border border-gray-300 rounded-md",value:P(N.due_date),onChange:e=>B(e,"due_date")})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"P.O./S.O."}),(0,l.jsx)("input",{type:"text",name:"poso_number",value:N.poso_number,onChange:C,className:"w-full p-2 border border-gray-300 rounded-md"})]}),(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),(0,l.jsx)("textarea",{name:"notes",rows:"4",value:N.notes,onChange:C,className:"w-full p-2 border border-gray-300 rounded-md"})]})]}),(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("h3",{className:"text-lg font-medium mb-3",children:"Bill Items"}),N.items.map((e,t)=>(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-4 p-3 bg-gray-50 rounded-md",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),(0,l.jsx)("input",{type:"text",value:e.category,onChange:e=>A(t,"category",e.target.value),className:"w-full p-2 border border-gray-300 rounded-md"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,l.jsx)("input",{type:"text",value:e.description,onChange:e=>A(t,"description",e.target.value),className:"w-full p-2 border border-gray-300 rounded-md"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantity"}),(0,l.jsx)("input",{type:"number",value:e.quantity,onChange:e=>A(t,"quantity",e.target.value),className:"w-full p-2 border border-gray-300 rounded-md"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Price"}),(0,l.jsx)("input",{type:"number",value:e.price,onChange:e=>A(t,"price",e.target.value),className:"w-full p-2 border border-gray-300 rounded-md"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount"}),(0,l.jsx)("input",{type:"number",value:e.amount,readOnly:!0,className:"w-full p-2 border border-gray-300 rounded-md bg-gray-100"})]})]},t)),(0,l.jsxs)("button",{type:"button",onClick:()=>{v(e=>(0,r._)((0,a._)({},e),{items:[...e.items,{category:"",description:"",quantity:1,price:0,tax:0,amount:0}]}))},className:"flex items-center text-blue-600 hover:text-blue-800",children:[(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,l.jsx)("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})}),"Add Item"]})]}),(0,l.jsx)("div",{className:"flex justify-end mt-6",children:(0,l.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Create Bill"})})]}),1===s&&x&&(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Bill Details"}),(0,l.jsxs)("div",{className:"bg-gray-50 p-4 rounded-md mb-6",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Bill Number"}),(0,l.jsx)("p",{className:"font-medium",children:x.bill_number})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Vendor"}),(0,l.jsx)("p",{className:"font-medium",children:x.vendor_name||"N/A"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Total Amount"}),(0,l.jsxs)("p",{className:"font-medium",children:[x.totalAmount," ",x.currency]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Bill Date"}),(0,l.jsx)("p",{className:"font-medium",children:new Date(x.bill_date).toLocaleDateString()})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Due Date"}),(0,l.jsx)("p",{className:"font-medium",children:new Date(x.due_date).toLocaleDateString()})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"P.O./S.O."}),(0,l.jsx)("p",{className:"font-medium",children:x.poso_number})]})]}),x.notes&&(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Notes"}),(0,l.jsx)("p",{className:"mt-1",children:x.notes})]})]}),(0,l.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Items"}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,l.jsx)("thead",{className:"bg-gray-50",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),(0,l.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),(0,l.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantity"}),(0,l.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Price"}),(0,l.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"})]})}),(0,l.jsxs)("tbody",{className:"bg-white divide-y divide-gray-200",children:[x.items.map((e,t)=>(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.category}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.description}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.quantity}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.price}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.amount})]},t)),0===x.items.length&&(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:5,className:"px-6 py-4 text-center text-sm text-gray-500",children:"No items in this bill"})})]})]})})]}),2===s&&(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,l.jsx)("thead",{className:"bg-gray-50",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Bill Number"}),(0,l.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Vendor"}),(0,l.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Amount"}),(0,l.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Bill Date"}),(0,l.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Due Date"}),(0,l.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"})]})}),(0,l.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:Array.isArray(o)&&o.length>0?o.map(e=>(0,l.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.bill_number}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.vendor_name||"N/A"}),(0,l.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[e.totalAmount," ",e.currency]}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(e.bill_date).toLocaleDateString()}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(e.due_date).toLocaleDateString()}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(0,l.jsx)("button",{onClick:()=>q(e),className:"text-blue-600 hover:text-blue-800 font-medium",children:"View Details"})})]},e.id)):(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:6,className:"px-6 py-4 text-center text-sm text-gray-500",children:"No bills found"})})})]})})]})}}}]);