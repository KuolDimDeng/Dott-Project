"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[93078],{12499:(e,t,r)=>{r.d(t,{FF:()=>l,LM:()=>s,yy:()=>d});var a=r(55166),n=r(68387),o=r(36465),i=r(95155),c=r(12115);function s(e){let{children:t}=e;return(0,i.jsx)("div",{className:"safe-context-wrapper",children:t})}function l(e){let t=(0,c.createContext)(e),r=t.Consumer;t.Consumer=function(e){var{children:t}=e,c=(0,o._)(e,["children"]);return"function"!=typeof t?(console.error("Context.Consumer expects a function as a child"),null):(0,i.jsx)(r,(0,n._)((0,a._)({},c),{children:t}))};let s=t.Provider;return t.Provider=function(e){var{value:t,children:r}=e,c=(0,o._)(e,["value","children"]);return(0,i.jsx)(s,(0,n._)((0,a._)({value:t},c),{children:r}))},t}function d(e){try{return(0,c.useContext)(e)}catch(t){return console.error("Error using context:",t),e._currentValue||{}}}},37845:(e,t,r)=>{r.d(t,{AT:()=>A});var a=r(55166),n=r(68387),o=r(42749),i=r(20171),c=r(44134).Buffer;let s=()=>"undefined"!=typeof crypto&&crypto.randomUUID?crypto.randomUUID():Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);window.__APP_CACHE=window.__APP_CACHE||{},window.__APP_CACHE.auth=window.__APP_CACHE.auth||{},window.__APP_CACHE.tenant=window.__APP_CACHE.tenant||{};let l=e=>e.startsWith("/api/"),d=i.A.create({baseURL:"",timeout:6e4,headers:{"Content-Type":"application/json"}}),u=async()=>{let e=null,t=null;if(window.__APP_CACHE=window.__APP_CACHE||{},window.__APP_CACHE.auth=window.__APP_CACHE.auth||{},window.__APP_CACHE.tenant=window.__APP_CACHE.tenant||{},e=window.__APP_CACHE.auth.idToken,t=window.__APP_CACHE.tenant.id||window.__APP_CACHE.tenant.tenantId||window.__APP_CACHE.businessid,!e||!t)try{var a;let{fetchAuthSession:n}=await Promise.all([r.e(31861),r.e(55158)]).then(r.bind(r,55158)),o=await n();if(null==o||null==(a=o.tokens)?void 0:a.idToken){e=o.tokens.idToken.toString(),window.__APP_CACHE.auth.idToken=e;try{let r=JSON.parse(c.from(e.split(".")[1],"base64").toString());(t=r["custom:businessid"]||r["custom:tenant_ID"]||r["custom:tenantId"])&&(window.__APP_CACHE.tenant.id=t)}catch(e){console.warn("[Axios] Error extracting tenant ID from token:",e)}}}catch(e){console.warn("[Axios] Error getting session from Cognito:",e)}return{token:e,tenantId:t}};d.interceptors.request.use(async e=>{l(e.url)?e.baseURL="":e.url.startsWith("/api/")||(e.url="/api".concat(e.url.startsWith("/")?e.url:"/"+e.url)),e.url.startsWith("/api/api/")&&(console.log("[Axios] Fixing duplicate API path: ".concat(e.url)),e.url=e.url.replace("/api/api/","/api/"));let{token:t,tenantId:r}=await u();t&&(e.headers=e.headers||{},e.headers.Authorization="Bearer ".concat(t)),r&&(e.headers=e.headers||{},e.headers["x-tenant-id"]=r,e.headers["X-Tenant-ID"]=r,e.params=e.params||{},e.params.tenantId||e.params.tenant_id||(e.params.tenantId=r),e.url.includes("/api/hr/")&&!e.params.schema&&(e.params.schema="tenant_".concat(r.replace(/-/g,"_")))),e.headers=e.headers||{},e.headers["x-request-id"]=s();let a=new AbortController;return e.signal=a.signal,e.__abortController=a,e.url.includes("/api/hr/")&&(e.timeout=12e4),e},e=>Promise.reject(e)),d.interceptors.response.use(e=>e,async e=>{var t,r,a;let n=e.config;if(!n||n._retryCount>=2)return Promise.reject(e);if(n._retryCount=n._retryCount||0,e.response&&401===e.response.status&&((null==(a=window.__APP_CACHE)?void 0:a.auth)&&(delete window.__APP_CACHE.auth.token,delete window.__APP_CACHE.auth.user),window.location.pathname.includes("/login")||(console.log("[Axios] Authentication error, redirecting to login..."),window.__APP_CACHE&&(window.__APP_CACHE.auth=window.__APP_CACHE.auth||{},window.__APP_CACHE.auth.redirectNeeded=!0),setTimeout(()=>{var e,t,r;(null==(t=window.__APP_CACHE)||null==(e=t.auth)?void 0:e.redirectNeeded)&&((null==(r=window.__APP_CACHE)?void 0:r.auth)&&delete window.__APP_CACHE.auth.redirectNeeded,window.location.href="/login")},2e3))),e.response&&404===e.response.status&&(e.config.url.includes("/login")||e.config.url.includes("/api/auth")))return console.log("[Axios] Login page 404 error - redirecting to dashboard fallback login"),window.__APP_CACHE&&(window.__APP_CACHE.auth=window.__APP_CACHE.auth||{},window.__APP_CACHE.auth.loginRedirectNeeded=!0),setTimeout(()=>{var e,t,r;(null==(t=window.__APP_CACHE)||null==(e=t.auth)?void 0:e.loginRedirectNeeded)&&((null==(r=window.__APP_CACHE)?void 0:r.auth)&&delete window.__APP_CACHE.auth.loginRedirectNeeded,window.location.href="/dashboard")},2e3),Promise.resolve({data:{success:!1,message:"Login page not found, using fallback"}});if(("ECONNABORTED"===e.code||(null==(t=e.message)?void 0:t.includes("timeout")))&&!n._retry){console.log("[Axios] Request timed out, retrying with longer timeout..."),n._retryCount++,n._retry=!0,n.timeout=n.timeout?2*n.timeout:12e4;try{return await new Promise(e=>setTimeout(e,1e3)),await d(n)}catch(e){return console.error("[Axios] Retry failed:",e.message),Promise.reject(e)}}if(("ECONNREFUSED"===e.code||(null==(r=e.message)?void 0:r.includes("Network Error"))||!e.response)&&!n._connectionRetry){console.log("[Axios] Connection refused or network error, retrying after delay..."),n._retryCount++,n._connectionRetry=!0;try{return await new Promise(e=>setTimeout(e,2e3*n._retryCount)),await d(n)}catch(e){return console.error("[Axios] Retry failed:",e.message),Promise.reject(e)}}if("ECONNABORTED"===e.code&&!n._abortRetry){console.log("[Axios] Request was aborted, retrying..."),n._retryCount++,n._abortRetry=!0;try{return await new Promise(e=>setTimeout(e,3e3)),await d(n)}catch(e){return console.error("[Axios] Retry after abort failed:",e.message),Promise.reject(e)}}return Promise.reject(e)});var p=r(29670),h=r(44134).Buffer;let g=new Map,w=["/api/tenant/list","/api/tenant/info","/api/inventory/services","/api/inventory/products","/api/crm/customers"],m=async()=>{let e={"Content-Type":"application/json",Accept:"application/json","X-Client-Version":"1.0.0"};e["X-Request-Time"]=Date.now().toString();try{var t,a,n,i,c;let s=null,l=null;try{let{fetchAuthSession:e}=await Promise.all([r.e(31861),r.e(55158)]).then(r.bind(r,55158)),t=await e();if(null==t||null==(c=t.tokens)?void 0:c.idToken){s=t.tokens.idToken.toString(),window.__APP_CACHE&&(window.__APP_CACHE.auth=window.__APP_CACHE.auth||{},window.__APP_CACHE.auth.idToken=s);try{let e=JSON.parse(h.from(s.split(".")[1],"base64").toString());(l=e["custom:businessid"]||e["custom:tenant_ID"])&&window.__APP_CACHE&&(window.__APP_CACHE.tenant=window.__APP_CACHE.tenant||{},window.__APP_CACHE.tenant.id=l)}catch(e){o.vF.warn("[apiHelpers] Error extracting tenant ID from token:",e)}}}catch(e){o.vF.warn("[apiHelpers] Error getting session from Cognito:",e)}!s&&(null==(a=window.__APP_CACHE)||null==(t=a.auth)?void 0:t.idToken)&&(s=window.__APP_CACHE.auth.idToken,o.vF.debug("[apiHelpers] Using cached idToken from AppCache")),s||(s=(0,p.gd)("idToken"),o.vF.debug("[apiHelpers] Using cached idToken from getCacheValue")),!l&&(null==(i=window.__APP_CACHE)||null==(n=i.tenant)?void 0:n.id)&&(l=window.__APP_CACHE.tenant.id),l||(l=(0,p.gd)("tenantId")),s&&(e.Authorization="Bearer ".concat(s),o.vF.debug("[apiHelpers] Added Authorization header")),l&&(e["X-Tenant-ID"]=l,e["X-Business-ID"]=l,o.vF.debug("[apiHelpers] Added tenant headers"))}catch(e){o.vF.warn("[apiHelpers] Error adding auth headers:",e)}return e},_=e=>{if(!e)return null;let t=g.get(e);if(!t)return null;let{data:r,timestamp:a,ttl:n}=t;return Date.now()-a<n?(o.vF.debug("[ApiRequest] Using cached response for ".concat(e)),r):(g.delete(e),null)},v=function(e,t,r){var o,i,c,s,l;let d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},u=(null==(o=e.message)?void 0:o.includes("Network Error"))||!e.response,p="ECONNABORTED"===e.code||(null==(i=e.message)?void 0:i.includes("timeout")),h=null==(c=e.message)?void 0:c.includes("aborted");u?console.error("[ApiRequest] Network error in ".concat(t," ").concat(r,":"),e.message):p?console.error("[ApiRequest] Request timeout in ".concat(t," ").concat(r,":"),e.message):h?console.error("[ApiRequest] Request aborted in ".concat(t," ").concat(r,":"),e.message):console.error("[ApiRequest] Error in ".concat(t," ").concat(r,":"),e);let g=null==e||null==(s=e.response)?void 0:s.status,w=null==e||null==(l=e.response)?void 0:l.data,m=(null==w?void 0:w.error)||(null==w?void 0:w.message)||(null==e?void 0:e.message);if(404===g&&console.log("[ApiRequest] 404 Not Found: ".concat(r)),((null==m?void 0:m.includes("connect ECONNREFUSED"))||(null==m?void 0:m.includes("Connection error")))&&console.error("[ApiRequest] Database connection error. Server may need to be restarted."),(null==t?void 0:t.toLowerCase())==="get"){if(console.log("[ApiRequest] Returning empty data for failed GET request: ".concat(r)),r.includes("/api/products"))return console.log("[ApiRequest] Returning fallback mock products data"),[{id:"offline-1",name:"Fallback Product 1",price:9.99,stock_quantity:10,is_fallback:!0},{id:"offline-2",name:"Fallback Product 2",price:19.99,stock_quantity:5,is_fallback:!0}];if(r.includes("/api/inventory/services"))return console.log("[ApiRequest] Returning fallback mock services data for inventory API"),[{id:"mock-1",name:"Sample Service 1",description:"This is a sample service for demonstration",price:99.99,is_for_sale:!0,is_recurring:!1,salestax:5,duration:"1 hour",billing_cycle:"monthly",unit:"hour",created_at:new Date().toISOString(),is_fallback:!0},{id:"mock-2",name:"Sample Service 2",description:"Another sample service for demonstration",price:149.99,is_for_sale:!0,is_recurring:!0,salestax:7,duration:"30 min",billing_cycle:"monthly",unit:"session",created_at:new Date().toISOString(),is_fallback:!0}];if(r.includes("/api/services"))return console.log("[ApiRequest] Returning fallback mock services data"),[{id:"offline-1",name:"Fallback Service 1",price:49.99,is_fallback:!0},{id:"offline-2",name:"Fallback Service 2",price:99.99,is_fallback:!0}];else if(r.includes("/api/customers"))return console.log("[ApiRequest] Returning fallback mock customers data"),[{id:"offline-1",name:"Fallback Customer 1",email:"customer1@example.com",is_fallback:!0},{id:"offline-2",name:"Fallback Customer 2",email:"customer2@example.com",is_fallback:!0}];return r.includes("list")||r.includes("products")||r.includes("customers")||r.includes("services")||r.includes("invoices")||r.includes("estimates")?[]:{}}throw(0,n._)((0,a._)({},e),{endpoint:r,method:t,errorMessage:m||"Unknown error",statusCode:g,params:JSON.stringify(d||{}).slice(0,200),isNetworkError:u,isTimeout:p,isAborted:h})},A=async function(e,t){var r,n,i,c;let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};try{let i=!1!==l.cache,c=null;if("get"===e.toLowerCase()&&i){let e=new URLSearchParams(l).toString();c="".concat(t).concat(e?"?"+e:"");let r=_(c);if(r)return r}let u=await m(),p=(0,a._)({method:e,url:t,headers:u},l);if(s&&["post","put","patch"].includes(e.toLowerCase())&&(p.data=s),p.timeout=l.timeout||6e4,"undefined"!=typeof AbortController){let e=new AbortController;p.signal=e.signal;let r=setTimeout(()=>{e.abort(),o.vF.warn("[ApiRequest] Aborting request to ".concat(t," due to timeout"))},p.timeout+1e3);p.timeoutId=r}if(null==(n=window.__APP_CACHE)||null==(r=n.tenant)?void 0:r.id){let e=window.__APP_CACHE.tenant.id;e&&(p.headers["X-Tenant-ID"]||p.headers["x-tenant-id"]||(p.headers["X-Tenant-ID"]=e),p.params||(p.params={}),p.params.tenantId||p.params.tenant_id||(p.params.tenantId=e),t.includes("/api/hr/")&&!p.params.schema&&(p.params.schema="tenant_".concat(e.replace(/-/g,"_"))))}o.vF.info("[apiRequest] Making ".concat(e," request to ").concat(t),{tenantId:p.headers["X-Tenant-ID"]||p.headers["x-tenant-id"],hasAuthHeader:!!p.headers.Authorization,params:p.params});let h=await d(p);if(p.timeoutId&&clearTimeout(p.timeoutId),"get"===e.toLowerCase()&&i&&c){let e=w.some(e=>t.includes(e))?3e5:6e4;g.set(c,{data:h.data,timestamp:Date.now(),ttl:e}),o.vF.debug("[ApiRequest] Cached response for ".concat(c," with TTL ").concat(e,"ms"))}return h.data}catch(r){if("CanceledError"===r.name||"AbortError"===r.name||(null==(i=r.message)?void 0:i.includes("cancel"))||(null==(c=r.message)?void 0:c.includes("abort"))){if(o.vF.debug("[ApiRequest] Request to ".concat(t," was cancelled/aborted")),t.includes("/api/hr/employees"))return[];throw r}return v(r,e,t,l)}}},62376:(e,t,r)=>{r.d(t,{GQ:()=>u,Q5:()=>g,Rz:()=>p,gw:()=>w,s7:()=>h});var a=r(55166),n=r(68387),o=r(37845),i=r(29729),c=r(51174),s=r(42749);r(29670);var l=r(99783);let d={async get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,o.AT)("GET",e,null,t)},async post(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,o.AT)("POST",e,t,r)},async put(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,o.AT)("PUT",e,t,r)},async patch(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,o.AT)("PATCH",e,t,r)},async delete(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,o.AT)("DELETE",e,null,t)}},u={async getAll(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0],(0,l.v$)("/api/hr/employees/")},getCurrent:async()=>(0,l.v$)("/api/hr/api/me/"),getById:async e=>(0,l.v$)("/api/hr/employees/".concat(e,"/")),async create(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let r=await (0,c.getTenantId)(),o={"X-Tenant-ID":r,"X-Schema-Name":"tenant_".concat(r.replace(/-/g,"_"))};return(await i.KK.post("/employees",e,{headers:o,params:(0,n._)((0,a._)({},t),{tenantId:r})})).data}catch(e){throw s.vF.error("[EmployeeApi] Error creating employee:",e),e}},async update(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{let o=await (0,c.getTenantId)(),s={"X-Tenant-ID":o,"X-Schema-Name":"tenant_".concat(o.replace(/-/g,"_"))};return(await i.KK.put("/employees/".concat(e),t,{headers:s,params:(0,n._)((0,a._)({},r),{tenantId:o})})).data}catch(t){throw s.vF.error("[EmployeeApi] Error updating employee ".concat(e,":"),t),t}},async delete(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let r=await (0,c.getTenantId)(),o={"X-Tenant-ID":r,"X-Schema-Name":"tenant_".concat(r.replace(/-/g,"_"))};return(await i.KK.delete("/employees/".concat(e),{headers:o,params:(0,n._)((0,a._)({},t),{tenantId:r})})).data}catch(t){throw s.vF.error("[EmployeeApi] Error deleting employee ".concat(e,":"),t),t}},async getHealth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{return await d.get("/api/health",e)}catch(e){throw s.vF.error("[ProductApi] Health check failed:",e),e}}},p={async getAll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var t,a;let{resetCircuitBreakers:n}=await Promise.resolve().then(r.bind(r,29729));n("/employees");let o=null;(null==(a=window.__APP_CACHE)||null==(t=a.tenant)?void 0:t.id)?o=window.__APP_CACHE.tenant.id:window.getCacheValue&&window.getCacheValue("tenantId")&&(o=window.getCacheValue("tenantId"));let i=new URLSearchParams;i.append("_t",Date.now()),o&&i.append("tenantId",o),Object.entries(e).forEach(e=>{let[t,r]=e;null!=r&&i.append(t,r)});let c="/api/hr/employees?".concat(i.toString()),d={};o&&(d["X-Tenant-ID"]=o);let u=await (0,l.v$)(c,{headers:d});if(!u.ok){let e=await u.json().catch(()=>({})),t=Error("API error: ".concat(u.status," ").concat(u.statusText));throw t.status=u.status,t.data=e,403===u.status&&(s.vF.error("[EmployeeApi] 403 Forbidden error:",e),e.detail&&e.detail.includes("tenant")?(t.message="Tenant access forbidden. Please verify your tenant permissions.",t.isTenantError=!0):(t.message="Permission denied. You do not have access to employee data.",t.isPermissionError=!0),s.vF.debug("[EmployeeApi] 403 Error debug info:",{tenantId:o,headers:d,url:c,errorData:e})),t}return await u.json()}catch(e){if(s.vF.error("[EmployeeApi] Error fetching employees:",e),403===e.status){let t=Error(e.message||"Permission denied accessing employee data");throw t.status=403,t.isPermissionError=!0,t.data=e.data,t}throw e}},getCurrent:async()=>(0,l.v$)("/api/hr/api/me/"),getById:async e=>(0,l.v$)("/api/hr/employees/".concat(e,"/")),async create(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let r=await (0,c.getTenantId)(),o={"X-Tenant-ID":r,"X-Schema-Name":"tenant_".concat(r.replace(/-/g,"_"))};return(await i.KK.post("/employees",e,{headers:o,params:(0,n._)((0,a._)({},t),{tenantId:r})})).data}catch(e){throw s.vF.error("[EmployeeApi] Error creating employee:",e),e}},async update(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{let o=await (0,c.getTenantId)(),s={"X-Tenant-ID":o,"X-Schema-Name":"tenant_".concat(o.replace(/-/g,"_"))};return(await i.KK.put("/employees/".concat(e),t,{headers:s,params:(0,n._)((0,a._)({},r),{tenantId:o})})).data}catch(t){throw s.vF.error("[EmployeeApi] Error updating employee ".concat(e,":"),t),t}},async delete(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let r=await (0,c.getTenantId)(),o={"X-Tenant-ID":r,"X-Schema-Name":"tenant_".concat(r.replace(/-/g,"_"))};return(await i.KK.delete("/employees/".concat(e),{headers:o,params:(0,n._)((0,a._)({},t),{tenantId:r})})).data}catch(t){throw s.vF.error("[EmployeeApi] Error deleting employee ".concat(e,":"),t),t}}},h={async getAll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{let t=await (0,c.getTenantId)();if(!t)throw s.vF.error("[ServiceApi] No tenant ID available for service fetch"),Error("No tenant ID available. Please refresh the page or log in again.");return await d.get("/api/services",(0,n._)((0,a._)({},e),{tenantId:t}))}catch(e){throw s.vF.error("[ServiceApi] Error fetching services:",e),e}},async getById(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await d.get("/api/services/".concat(e),t)}catch(t){throw s.vF.error("[ServiceApi] Error fetching service ".concat(e,":"),t),t}},async create(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await d.post("/api/services",e,t)}catch(e){throw s.vF.error("[ServiceApi] Error creating service:",e),e}},async update(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{return await d.put("/api/services/".concat(e),t,r)}catch(t){throw s.vF.error("[ServiceApi] Error updating service ".concat(e,":"),t),t}},async delete(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await d.delete("/api/services/".concat(e),t)}catch(t){throw s.vF.error("[ServiceApi] Error deleting service ".concat(e,":"),t),t}}},g={async getAll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{let t=await (0,c.getTenantId)();if(!t)throw s.vF.error("[InvoiceApi] No tenant ID available for invoice fetch"),Error("No tenant ID available. Please refresh the page or log in again.");return await d.get("/api/invoices",(0,n._)((0,a._)({},e),{tenantId:t}))}catch(e){throw s.vF.error("[InvoiceApi] Error fetching invoices:",e),e}},async getById(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await d.get("/api/invoices/".concat(e),t)}catch(t){throw s.vF.error("[InvoiceApi] Error fetching invoice ".concat(e,":"),t),t}},async create(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await d.post("/api/invoices",e,t)}catch(e){throw s.vF.error("[InvoiceApi] Error creating invoice:",e),e}},async update(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{return await d.put("/api/invoices/".concat(e),t,r)}catch(t){throw s.vF.error("[InvoiceApi] Error updating invoice ".concat(e,":"),t),t}},async delete(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await d.delete("/api/invoices/".concat(e),t)}catch(t){throw s.vF.error("[InvoiceApi] Error deleting invoice ".concat(e,":"),t),t}},async generatePdf(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await d.get("/api/invoices/".concat(e,"/pdf"),(0,n._)((0,a._)({},t),{responseType:"blob"}))}catch(t){throw s.vF.error("[InvoiceApi] Error generating PDF for invoice ".concat(e,":"),t),t}},async sendEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{return await d.post("/api/invoices/".concat(e,"/email"),t,r)}catch(t){throw s.vF.error("[InvoiceApi] Error sending email for invoice ".concat(e,":"),t),t}}},w={async getFormsByEmployee(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return s.vF.info("[API] Requesting tax forms for employee ".concat(e)),await d.get("/api/taxes/forms?employee_id=".concat(e),t)}catch(t){throw s.vF.error("[TaxApi] Error fetching tax forms for employee ".concat(e,":"),t),t}},async createForm(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return s.vF.info("[API] Creating new tax form"),await d.post("/api/taxes/forms",e,t)}catch(e){throw s.vF.error("[TaxApi] Error creating tax form:",e),e}},async updateForm(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{return s.vF.info("[API] Updating tax form ".concat(e)),await d.put("/api/taxes/forms/".concat(e),t,r)}catch(t){throw s.vF.error("[TaxApi] Error updating tax form ".concat(e,":"),t),t}},async deleteForm(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return s.vF.info("[API] Deleting tax form ".concat(e)),await d.delete("/api/taxes/forms/".concat(e),t)}catch(t){throw s.vF.error("[TaxApi] Error deleting tax form ".concat(e,":"),t),t}},async verifyForm(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return s.vF.info("[API] Verifying tax form ".concat(e)),await d.post("/api/taxes/forms/".concat(e,"/verify"),{},t)}catch(t){throw s.vF.error("[TaxApi] Error verifying tax form ".concat(e,":"),t),t}},async downloadForm(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return s.vF.info("[API] Downloading tax form ".concat(e)),await d.get("/api/taxes/forms/".concat(e,"/download"),(0,n._)((0,a._)({},t),{responseType:"blob"}))}catch(t){throw s.vF.error("[TaxApi] Error downloading tax form ".concat(e,":"),t),t}},async getStates(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{return s.vF.info("[API] Requesting tax states"),await d.get("/api/taxes/states",e)}catch(e){throw s.vF.error("[TaxApi] Error fetching tax states:",e),e}},async getStateById(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return s.vF.info("[API] Requesting tax state ".concat(e)),await d.get("/api/taxes/states/".concat(e),t)}catch(t){throw s.vF.error("[TaxApi] Error fetching tax state ".concat(e,":"),t),t}},async getTaxRates(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{return s.vF.info("[API] Requesting tax rates"),await d.get("/api/taxes/rates",e)}catch(e){throw s.vF.error("[TaxApi] Error fetching tax rates:",e),e}},async getTaxRatesByState(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return s.vF.info("[API] Requesting tax rates for state ".concat(e)),await d.get("/api/taxes/rates?state=".concat(e),t)}catch(t){throw s.vF.error("[TaxApi] Error fetching tax rates for state ".concat(e,":"),t),t}}}},99783:(e,t,r)=>{r.d(t,{Ay:()=>d,v$:()=>l});var a=r(55166),n=r(68387),o=r(24818),i=r(42749),c=r(29670);async function s(){try{let t=null,r=null;try{var e;let a=await (0,o.$)();(null==a||null==(e=a.tokens)?void 0:e.idToken)&&(t=a.tokens.idToken.toString(),r=a.tokens.accessToken.toString(),(0,c.mm)("idToken",t),(0,c.mm)("accessToken",r),(0,c.mm)("tokenTimestamp",Date.now().toString()))}catch(e){i.vF.warn("[API] Failed to get auth session from Cognito:",e)}if(!t&&(t=(0,c.gd)("idToken"),r=(0,c.gd)("accessToken"),t&&i.vF.debug("[API] Using cached auth tokens")),!t)throw Error("No valid ID token in session or cache");return{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}}catch(e){throw i.vF.error("[API] Failed to get auth headers:",e),e}}async function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let r=await s(),o=(0,a._)({},r,t.headers||{}),i=await fetch(e,(0,n._)((0,a._)({},t),{headers:o}));if(401===i.status){let e=Error("Authentication failed");throw e.status=401,e}return i}catch(t){throw i.vF.error("[API] Fetch error:",{url:e,error:t.message}),t}}let d={get:async function e(e){return(await l(e)).json()},post:async function e(e,t){return(await l(e,{method:"POST",body:JSON.stringify(t)})).json()},put:async function e(e,t){return(await l(e,{method:"PUT",body:JSON.stringify(t)})).json()},delete:async function e(e){return(await l(e,{method:"DELETE"})).json()}}}}]);