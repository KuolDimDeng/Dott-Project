"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[12278],{12278:(e,t,a)=>{a.r(t),a.d(t,{default:()=>d});var s=a(95155),i=a(12115);a(68084);var c=a(42749),l=a(16905),r=a(24818);let d=()=>{let[e,t]=(0,i.useState)(!0),[a,d]=(0,i.useState)({customers:{total:0,new30d:0},leads:{total:0,new30d:0,byStatus:[],bySource:[]},opportunities:{total:0,totalValue:0,byStage:[]},deals:{total:0,totalValue:0,byStatus:[]},activities:{upcoming:[],overdue:[]},campaigns:{total:0,active:0,byType:[],byStatus:[]}});if((0,i.useEffect)(()=>{let e=async()=>{try{var e,s;let a=(null==(s=(await (0,r.$)()).tokens)||null==(e=s.idToken)?void 0:e.toString())||"",i=await Promise.all([fetch("/api/crm/dashboard/customers/",{headers:{Authorization:"Bearer ".concat(a)}}),fetch("/api/crm/dashboard/leads/",{headers:{Authorization:"Bearer ".concat(a)}}),fetch("/api/crm/dashboard/opportunities/",{headers:{Authorization:"Bearer ".concat(a)}}),fetch("/api/crm/dashboard/deals/",{headers:{Authorization:"Bearer ".concat(a)}}),fetch("/api/crm/activities/upcoming/",{headers:{Authorization:"Bearer ".concat(a)}}),fetch("/api/crm/activities/overdue/",{headers:{Authorization:"Bearer ".concat(a)}}),fetch("/api/crm/dashboard/campaigns/",{headers:{Authorization:"Bearer ".concat(a)}})]),[c,n,o,x,u,m,p]=await Promise.all(i.map(e=>e.json())),h={customers:{total:c.total_customers,new30d:c.new_customers_30d},leads:{total:n.total_leads,new30d:n.new_leads_30d,byStatus:n.leads_by_status||[],bySource:n.leads_by_source||[]},opportunities:{total:o.total_opportunities,totalValue:o.total_value,byStage:o.opportunities_by_stage||[]},deals:{total:x.total_deals,totalValue:x.total_value,byStatus:x.deals_by_status||[]},activities:{upcoming:u||[],overdue:m||[]},campaigns:{total:p.total_campaigns,active:p.active_campaigns,byType:p.campaigns_by_type||[],byStatus:p.campaigns_by_status||[]}};await l.E.set("crm_dashboard_data",JSON.stringify(h),{expires:300}),d(h),t(!1)}catch(e){c.vF.error("Error updating CRM dashboard data:",e),a(),t(!1)}},a=()=>{d({customers:{total:124,new30d:15},leads:{total:57,new30d:22,byStatus:[{status:"new",count:22},{status:"contacted",count:15},{status:"qualified",count:12},{status:"unqualified",count:5},{status:"converted",count:3}],bySource:[{source:"website",count:25},{source:"referral",count:15},{source:"social media",count:10},{source:"event",count:7}]},opportunities:{total:32,totalValue:45e4,byStage:[{stage:"prospecting",count:8,value:12e4},{stage:"qualification",count:6,value:8e4},{stage:"proposal",count:5,value:15e4},{stage:"negotiation",count:3,value:75e3},{stage:"closed_won",count:10,value:25e3}]},deals:{total:18,totalValue:32e4,byStatus:[{status:"draft",count:5,value:85e3},{status:"sent",count:7,value:135e3},{status:"accepted",count:6,value:1e5}]},activities:{upcoming:[{id:1,type:"call",subject:"Follow-up call with ABC Corp",due_date:"2025-03-28T10:00:00Z",status:"not_started"},{id:2,type:"meeting",subject:"Demo for XYZ Inc",due_date:"2025-03-29T14:30:00Z",status:"not_started"},{id:3,type:"email",subject:"Send proposal to Johnson Ltd",due_date:"2025-03-27T12:00:00Z",status:"in_progress"}],overdue:[{id:4,type:"task",subject:"Update customer details",due_date:"2025-03-22T17:00:00Z",status:"in_progress"},{id:5,type:"call",subject:"Check in with Smith Co",due_date:"2025-03-21T11:00:00Z",status:"not_started"}]},campaigns:{total:12,active:4,byType:[{type:"email",count:5},{type:"social",count:3},{type:"event",count:2},{type:"webinar",count:2}],byStatus:[{status:"planning",count:3},{status:"active",count:4},{status:"completed",count:5}]}})};(async()=>{t(!0);try{let a=await l.E.get("crm_dashboard_data");if(a){d(JSON.parse(a)),t(!1),e();return}await e()}catch(e){c.vF.error("Error fetching CRM dashboard data:",e),a(),t(!1)}})()},[]),e)return(0,s.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-main"})});let n=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0}).format(e),o=e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),x=e=>{window.location.href="/dashboard/crm/".concat(e)};return(0,s.jsxs)("div",{className:"p-6 bg-gray-50",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-6 text-black",children:"CRM Dashboard"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6 mb-6",children:[(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-5 cursor-pointer hover:shadow-md transition-shadow",onClick:()=>x("customers"),children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-black",children:"Customers"}),(0,s.jsx)("p",{className:"text-3xl font-semibold mt-2 text-black",children:a.customers.total}),(0,s.jsxs)("p",{className:"text-xs text-black",children:[a.customers.new30d," new in last 30 days"]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-5 cursor-pointer hover:shadow-md transition-shadow",onClick:()=>x("leads"),children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-black",children:"Leads"}),(0,s.jsx)("p",{className:"text-3xl font-semibold mt-2 text-black",children:a.leads.total}),(0,s.jsxs)("p",{className:"text-xs text-black",children:[a.leads.new30d," new in last 30 days"]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-5 cursor-pointer hover:shadow-md transition-shadow",onClick:()=>x("opportunities"),children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-black",children:"Opportunities"}),(0,s.jsx)("p",{className:"text-3xl font-semibold mt-2 text-black",children:a.opportunities.total}),(0,s.jsxs)("p",{className:"text-xs text-black",children:["Value: ",n(a.opportunities.totalValue)]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-5 cursor-pointer hover:shadow-md transition-shadow",onClick:()=>x("deals"),children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-black",children:"Deals"}),(0,s.jsx)("p",{className:"text-3xl font-semibold mt-2 text-black",children:a.deals.total}),(0,s.jsxs)("p",{className:"text-xs text-black",children:["Value: ",n(a.deals.totalValue)]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,s.jsxs)("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-black",children:"Upcoming Activities"}),(0,s.jsx)("button",{className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"View All"})]}),(0,s.jsx)("div",{className:"p-5",children:(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-100",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-black uppercase tracking-wider",children:"Type"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-black uppercase tracking-wider",children:"Subject"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-black uppercase tracking-wider",children:"Due Date"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-black uppercase tracking-wider",children:"Status"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:a.activities.upcoming.length>0?a.activities.upcoming.slice(0,5).map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-black",children:e.type}),(0,s.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-black",children:e.subject}),(0,s.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-black",children:o(e.due_date)}),(0,s.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-black",children:e.status.replace("_"," ")})]},e.id)):(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:4,className:"px-4 py-2 text-center text-sm text-black",children:"No upcoming activities"})})})]})})})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,s.jsxs)("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-black",children:"Overdue Activities"}),(0,s.jsx)("button",{className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"View All"})]}),(0,s.jsx)("div",{className:"p-5",children:(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-100",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-black uppercase tracking-wider",children:"Type"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-black uppercase tracking-wider",children:"Subject"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-black uppercase tracking-wider",children:"Due Date"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-black uppercase tracking-wider",children:"Status"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:a.activities.overdue.length>0?a.activities.overdue.slice(0,5).map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-black",children:e.type}),(0,s.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-black",children:e.subject}),(0,s.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-black",children:o(e.due_date)}),(0,s.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-black",children:e.status.replace("_"," ")})]},e.id)):(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:4,className:"px-4 py-2 text-center text-sm text-black",children:"No overdue activities"})})})]})})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,s.jsxs)("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-black",children:"Leads by Status"}),(0,s.jsx)("button",{className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"View Leads"})]}),(0,s.jsx)("div",{className:"p-5",children:(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-100",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-black uppercase tracking-wider",children:"Status"}),(0,s.jsx)("th",{className:"px-4 py-2 text-right text-xs font-medium text-black uppercase tracking-wider",children:"Count"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:a.leads.byStatus.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-black",children:e.status.replace("_"," ")}),(0,s.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-black text-right",children:e.count})]},e.status))})]})})})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,s.jsxs)("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-black",children:"Opportunities by Stage"}),(0,s.jsx)("button",{className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"View Opportunities"})]}),(0,s.jsx)("div",{className:"p-5",children:(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-100",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-black uppercase tracking-wider",children:"Stage"}),(0,s.jsx)("th",{className:"px-4 py-2 text-right text-xs font-medium text-black uppercase tracking-wider",children:"Count"}),(0,s.jsx)("th",{className:"px-4 py-2 text-right text-xs font-medium text-black uppercase tracking-wider",children:"Value"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:a.opportunities.byStage.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-black",children:e.stage.replace("_"," ")}),(0,s.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-black text-right",children:e.count}),(0,s.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-black text-right",children:n(e.value)})]},e.stage))})]})})})]})]})]})}},16905:(e,t,a)=>{a.d(t,{E:()=>i});var s=a(29670);let i={get:async e=>(0,s.gd)(e),set:async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=a.expires?1e3*a.expires:void 0;return(0,s.mm)(e,t,{ttl:i})},remove:async e=>(0,s.A6)(e),clear:async()=>(0,s.IL)(),keys:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object.keys(window.__APP_CACHE||{}).filter(t=>t.startsWith(e))}}}}]);