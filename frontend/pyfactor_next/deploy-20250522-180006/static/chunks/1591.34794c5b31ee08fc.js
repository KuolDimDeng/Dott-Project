"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1591],{1591:(e,t,s)=>{s.r(t),s.d(t,{default:()=>i});var a=s(55166),l=s(68387),n=s(95155),r=s(12115),o=s(29729);let i=()=>{let[e,t]=(0,r.useState)([]),[s,i]=(0,r.useState)(null),[d,c]=(0,r.useState)(!1),[m,x]=(0,r.useState)({month:new Date().getMonth()+1,year:new Date().getFullYear(),status:"in_progress",notes:""});(0,r.useEffect)(()=>{h()},[]);let h=async()=>{try{let e=await o.SP.get("/api/month-end-closings/");t(e.data)}catch(e){console.error("Error fetching month-end closings:",e)}},u=e=>{let{name:t,value:s}=e.target;x((0,l._)((0,a._)({},m),{[t]:s}))},g=async e=>{e.preventDefault();try{await o.SP.post("/api/month-end-closings/",m),h(),c(!1),x({month:new Date().getMonth()+1,year:new Date().getFullYear(),status:"in_progress",notes:""})}catch(e){console.error("Error creating month-end closing:",e)}},p=async(e,t)=>{try{await o.SP.put("/api/month-end-tasks/".concat(e,"/"),{is_completed:t});let a=await o.SP.get("/api/month-end-closings/".concat(s.id,"/"));i(a.data),h()}catch(e){console.error("Error updating task:",e)}};return(0,n.jsxs)("div",{className:"w-full",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-6 py-2",children:[(0,n.jsx)("h1",{className:"text-2xl font-semibold text-gray-800",children:"Month-End Closing Management"}),(0,n.jsxs)("button",{onClick:()=>c(!0),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})}),"Start New Closing"]})]}),(0,n.jsx)("div",{className:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg",children:(0,n.jsxs)("table",{className:"min-w-full divide-y divide-gray-300",children:[(0,n.jsx)("thead",{className:"bg-gray-50",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{scope:"col",className:"py-3.5 px-3 text-left text-sm font-semibold text-gray-900",children:"Month"}),(0,n.jsx)("th",{scope:"col",className:"py-3.5 px-3 text-left text-sm font-semibold text-gray-900",children:"Year"}),(0,n.jsx)("th",{scope:"col",className:"py-3.5 px-3 text-left text-sm font-semibold text-gray-900",children:"Status"}),(0,n.jsx)("th",{scope:"col",className:"py-3.5 px-3 text-left text-sm font-semibold text-gray-900",children:"Started At"}),(0,n.jsx)("th",{scope:"col",className:"py-3.5 px-3 text-left text-sm font-semibold text-gray-900",children:"Completed At"}),(0,n.jsx)("th",{scope:"col",className:"py-3.5 px-3 text-left text-sm font-semibold text-gray-900",children:"Actions"})]})}),(0,n.jsx)("tbody",{className:"divide-y divide-gray-200 bg-white",children:e.map(e=>(0,n.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,n.jsx)("td",{className:"whitespace-nowrap py-4 px-3 text-sm text-gray-500",children:e.month}),(0,n.jsx)("td",{className:"whitespace-nowrap py-4 px-3 text-sm text-gray-500",children:e.year}),(0,n.jsx)("td",{className:"whitespace-nowrap py-4 px-3 text-sm text-gray-500",children:e.status}),(0,n.jsx)("td",{className:"whitespace-nowrap py-4 px-3 text-sm text-gray-500",children:new Date(e.started_at).toLocaleString()}),(0,n.jsx)("td",{className:"whitespace-nowrap py-4 px-3 text-sm text-gray-500",children:e.completed_at?new Date(e.completed_at).toLocaleString():"-"}),(0,n.jsx)("td",{className:"whitespace-nowrap py-4 px-3 text-sm text-gray-500",children:(0,n.jsxs)("div",{className:"flex space-x-2",children:[(0,n.jsx)("button",{onClick:()=>i(e),className:"text-blue-600 hover:text-blue-800",children:(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,n.jsx)("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})})}),(0,n.jsx)("button",{className:"text-red-600 hover:text-red-800",children:(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})})]})})]},e.id))})]})}),d&&(0,n.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:(0,n.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,n.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:()=>c(!1)}),(0,n.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,n.jsx)("div",{className:"bg-blue-50 px-4 py-3 border-b border-gray-200",children:(0,n.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Start New Month-End Closing"})}),(0,n.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,n.jsxs)("form",{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"month",className:"block text-sm font-medium text-gray-700 mb-1",children:"Month"}),(0,n.jsx)("select",{id:"month",name:"month",value:m.month,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[1,2,3,4,5,6,7,8,9,10,11,12].map(e=>(0,n.jsx)("option",{value:e,children:new Date(0,e-1).toLocaleString("default",{month:"long"})},e))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"year",className:"block text-sm font-medium text-gray-700 mb-1",children:"Year"}),(0,n.jsx)("input",{type:"number",id:"year",name:"year",value:m.year,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),(0,n.jsx)("textarea",{id:"notes",name:"notes",rows:4,value:m.notes,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]})]})}),(0,n.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,n.jsx)("button",{type:"button",onClick:g,className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Start Closing"}),(0,n.jsx)("button",{type:"button",onClick:()=>c(!1),className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})}),s&&(0,n.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:(0,n.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,n.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:()=>i(null)}),(0,n.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-3xl sm:w-full",children:[(0,n.jsx)("div",{className:"bg-blue-50 px-4 py-3 border-b border-gray-200",children:(0,n.jsxs)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:["Month-End Closing - ",new Date(0,s.month-1).toLocaleString("default",{month:"long"})," ",s.year]})}),(0,n.jsxs)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[(0,n.jsx)("h4",{className:"text-lg font-medium text-gray-800 mb-4",children:"Tasks"}),(0,n.jsx)("ul",{className:"divide-y divide-gray-200",children:s.tasks.map(e=>(0,n.jsx)("li",{className:"py-3",children:(0,n.jsxs)("div",{className:"flex items-start",children:[(0,n.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:(0,n.jsx)("input",{type:"checkbox",checked:e.is_completed,onChange:t=>p(e.id,t.target.checked),className:"h-5 w-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"})}),(0,n.jsxs)("div",{className:"ml-3",children:[(0,n.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,n.jsx)("p",{className:"text-sm text-gray-500",children:e.is_completed?"Completed at: ".concat(new Date(e.completed_at).toLocaleString()):"Not completed"})]})]})},e.id))})]}),(0,n.jsx)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:(0,n.jsx)("button",{type:"button",onClick:()=>i(null),className:"w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:w-auto sm:text-sm",children:"Close"})})]})]})})]})}}}]);