"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[32060,55048],{32060:(e,t,s)=>{s.r(t),s.d(t,{ArcElement:()=>b,BarController:()=>o,BarElement:()=>h,BubbleController:()=>c,CategoryScale:()=>y,Chart:()=>r,DoughnutController:()=>n,Filler:()=>C,Legend:()=>w,LineController:()=>a,LineElement:()=>p,LinearScale:()=>f,PieController:()=>i,PointElement:()=>g,PolarAreaController:()=>d,RadarController:()=>l,RadialLinearScale:()=>j,Scale:()=>x,ScatterController:()=>u,TimeScale:()=>v,Title:()=>_,Tooltip:()=>N,default:()=>A,register:()=>m,registerables:()=>k});class r{destroy(){}update(){}render(){}stop(){}resize(){}clear(){}toBase64Image(){return""}getElementsAtEventForMode(){return[]}getDatasetMeta(){return{}}constructor(){this.type="line",this.data={},this.options={}}}let a={id:"line",defaults:{}},o={id:"bar",defaults:{}},l={id:"radar",defaults:{}},n={id:"doughnut",defaults:{}},d={id:"polarArea",defaults:{}},c={id:"bubble",defaults:{}},i={id:"pie",defaults:{}},u={id:"scatter",defaults:{}};function m(){}let x={extend:()=>{}},b={id:"arc",defaults:{}},p={id:"line",defaults:{}},h={id:"bar",defaults:{}},g={id:"point",defaults:{}},y={id:"category",defaults:{}},f={id:"linear",defaults:{}},j={id:"radialLinear",defaults:{}},v={id:"time",defaults:{}},N={id:"tooltip",defaults:{},positioners:{}},w={id:"legend",defaults:{}},_={id:"title",defaults:{}},C={id:"filler",defaults:{}},k=[b,p,h,g,y,f,j,v,N,w,_],A=r},55048:(e,t,s)=>{s.r(t),s.d(t,{default:()=>u});var r=s(55166),a=s(68387),o=s(36465),l=s(95155),n=s(12115),d=s(80561),c=s(29729);function i(e){let{children:t,value:s,index:n}=e,d=(0,o._)(e,["children","value","index"]);return(0,l.jsx)("div",(0,a._)((0,r._)({role:"tabpanel",hidden:s!==n,id:"simple-tabpanel-".concat(n),"aria-labelledby":"simple-tab-".concat(n)},d),{children:s===n&&(0,l.jsx)("div",{className:"p-6",children:t})}))}s(87449);let u=()=>{let[e,t]=(0,n.useState)(0),[s,o]=(0,n.useState)([]),[u,m]=(0,n.useState)([]),[x,b]=(0,n.useState)(null),[p,h]=(0,n.useState)({description:"",category:"",cost_type:"",cost_nature:"",amount:"",date:"",department:"",project:"",cost_driver:"",job_process_id:"",budgeted_amount:"",notes:"",allocations:[]});(0,n.useEffect)(()=>{g(),y()},[]);let g=async()=>{try{let e=await c.SP.get("/api/finance/cost-entries/");o(e.data)}catch(e){console.error("Error fetching cost entries:",e)}},y=async()=>{try{let e=await c.SP.get("/api/finance/cost-categories/");m(e.data)}catch(e){console.error("Error fetching cost categories:",e)}},f=e=>{t(e)},j=e=>{h((0,a._)((0,r._)({},p),{[e.target.name]:e.target.value}))},v=(e,t,s)=>{let o=[...p.allocations];o[e]=(0,a._)((0,r._)({},o[e]),{[t]:s}),h((0,a._)((0,r._)({},p),{allocations:o}))},N=async e=>{e.preventDefault();try{x?await c.SP.put("/api/finance/cost-entries/".concat(x.cost_id,"/"),p):await c.SP.post("/api/finance/cost-entries/",p),g(),h({description:"",category:"",cost_type:"",cost_nature:"",amount:"",date:"",department:"",project:"",cost_driver:"",job_process_id:"",budgeted_amount:"",notes:"",allocations:[]}),b(null),t(1)}catch(e){console.error("Error saving cost entry:",e)}},w=e=>{b(e),h(e),t(0)},_=async e=>{if(window.confirm("Are you sure you want to delete this cost entry?"))try{await c.SP.delete("/api/finance/cost-entries/".concat(e,"/")),g()}catch(e){console.error("Error deleting cost entry:",e)}};return(0,l.jsxs)("div",{className:"w-full",children:[(0,l.jsx)("div",{className:"border-b border-gray-200",children:(0,l.jsxs)("nav",{className:"flex -mb-px",children:[(0,l.jsx)("button",{className:"py-4 px-6 text-center border-b-2 font-medium text-sm transition-colors duration-200 ease-in-out focus:outline-none ".concat(0===e?"text-blue-600 border-blue-600 bg-blue-50":"text-gray-500 border-transparent hover:text-gray-700 hover:border-gray-300"),onClick:()=>f(0),children:"Create/Edit Cost Entry"}),(0,l.jsx)("button",{className:"py-4 px-6 text-center border-b-2 font-medium text-sm transition-colors duration-200 ease-in-out focus:outline-none ".concat(1===e?"text-blue-600 border-blue-600 bg-blue-50":"text-gray-500 border-transparent hover:text-gray-700 hover:border-gray-300"),onClick:()=>f(1),children:"Cost Entry List"}),(0,l.jsx)("button",{className:"py-4 px-6 text-center border-b-2 font-medium text-sm transition-colors duration-200 ease-in-out focus:outline-none ".concat(2===e?"text-blue-600 border-blue-600 bg-blue-50":"text-gray-500 border-transparent hover:text-gray-700 hover:border-gray-300"),onClick:()=>f(2),children:"Cost Analysis"}),(0,l.jsx)("button",{className:"py-4 px-6 text-center border-b-2 font-medium text-sm transition-colors duration-200 ease-in-out focus:outline-none ".concat(3===e?"text-blue-600 border-blue-600 bg-blue-50":"text-gray-500 border-transparent hover:text-gray-700 hover:border-gray-300"),onClick:()=>f(3),children:"Cost Allocation"})]})}),(0,l.jsx)(i,{value:e,index:0,children:(0,l.jsxs)("form",{onSubmit:N,className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,l.jsx)("input",{id:"description",name:"description",type:"text",value:p.description,onChange:j,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),(0,l.jsxs)("select",{id:"category",name:"category",value:p.category,onChange:j,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[(0,l.jsx)("option",{value:"",children:"Select a category"}),u.map(e=>(0,l.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"cost_type",className:"block text-sm font-medium text-gray-700 mb-1",children:"Cost Type"}),(0,l.jsxs)("select",{id:"cost_type",name:"cost_type",value:p.cost_type,onChange:j,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[(0,l.jsx)("option",{value:"",children:"Select cost type"}),(0,l.jsx)("option",{value:"direct",children:"Direct"}),(0,l.jsx)("option",{value:"indirect",children:"Indirect"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"cost_nature",className:"block text-sm font-medium text-gray-700 mb-1",children:"Cost Nature"}),(0,l.jsxs)("select",{id:"cost_nature",name:"cost_nature",value:p.cost_nature,onChange:j,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[(0,l.jsx)("option",{value:"",children:"Select cost nature"}),(0,l.jsx)("option",{value:"fixed",children:"Fixed"}),(0,l.jsx)("option",{value:"variable",children:"Variable"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount"}),(0,l.jsx)("input",{id:"amount",name:"amount",type:"number",value:p.amount,onChange:j,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"date",className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),(0,l.jsx)("input",{id:"date",name:"date",type:"date",value:p.date,onChange:j,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"department",className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),(0,l.jsx)("input",{id:"department",name:"department",type:"text",value:p.department,onChange:j,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"project",className:"block text-sm font-medium text-gray-700 mb-1",children:"Project"}),(0,l.jsx)("input",{id:"project",name:"project",type:"text",value:p.project,onChange:j,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"cost_driver",className:"block text-sm font-medium text-gray-700 mb-1",children:"Cost Driver"}),(0,l.jsx)("input",{id:"cost_driver",name:"cost_driver",type:"text",value:p.cost_driver,onChange:j,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"job_process_id",className:"block text-sm font-medium text-gray-700 mb-1",children:"Job/Process ID"}),(0,l.jsx)("input",{id:"job_process_id",name:"job_process_id",type:"text",value:p.job_process_id,onChange:j,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"budgeted_amount",className:"block text-sm font-medium text-gray-700 mb-1",children:"Budgeted Amount"}),(0,l.jsx)("input",{id:"budgeted_amount",name:"budgeted_amount",type:"number",value:p.budgeted_amount,onChange:j,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),(0,l.jsx)("textarea",{id:"notes",name:"notes",rows:"4",value:p.notes,onChange:j,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),(0,l.jsx)("div",{children:(0,l.jsx)("button",{type:"submit",className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:x?"Update Cost Entry":"Create Cost Entry"})})]})}),(0,l.jsx)(i,{value:e,index:1,children:(0,l.jsx)("div",{className:"overflow-x-auto rounded-lg border border-gray-200",children:(0,l.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,l.jsx)("thead",{className:"bg-gray-50",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),(0,l.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),(0,l.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cost Type"}),(0,l.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),(0,l.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,l.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,l.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:s.length>0?s.map(e=>{var t;return(0,l.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.description}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:null==(t=u.find(t=>t.id===e.category))?void 0:t.name}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,l.jsx)("span",{className:"capitalize ".concat("direct"===e.cost_type?"text-green-600":"text-blue-600"),children:e.cost_type})}),(0,l.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["$",e.amount]}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.date}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,l.jsxs)("div",{className:"flex space-x-2",children:[(0,l.jsx)("button",{onClick:()=>w(e),className:"text-indigo-600 hover:text-indigo-900 font-medium",children:"Edit"}),(0,l.jsx)("button",{onClick:()=>_(e.cost_id),className:"text-red-600 hover:text-red-900 font-medium",children:"Delete"})]})})]},e.cost_id)}):(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:6,className:"px-6 py-4 text-sm text-gray-500 text-center",children:"No cost entries found."})})})]})})}),(0,l.jsxs)(i,{value:e,index:2,children:[(0,l.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Cost Breakdown"}),(0,l.jsx)("div",{className:"mb-8 max-w-lg mx-auto",children:(()=>{let e={labels:["Direct Costs","Indirect Costs"],datasets:[{data:[s.filter(e=>"direct"===e.cost_type).reduce((e,t)=>e+parseFloat(t.amount),0),s.filter(e=>"indirect"===e.cost_type).reduce((e,t)=>e+parseFloat(t.amount),0)],backgroundColor:["#FF6384","#36A2EB"],hoverBackgroundColor:["#FF6384","#36A2EB"]}]};return(0,l.jsx)(d.Fq,{data:e})})()}),(0,l.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Cost Variance Analysis"}),(0,l.jsx)("div",{className:"max-w-4xl mx-auto",children:(()=>{let e={labels:s.map(e=>e.description),datasets:[{label:"Actual Cost",data:s.map(e=>e.amount),backgroundColor:"rgba(255, 99, 132, 0.5)"},{label:"Budgeted Cost",data:s.map(e=>e.budgeted_amount),backgroundColor:"rgba(54, 162, 235, 0.5)"}]};return(0,l.jsx)(d.yP,{data:e,options:{scales:{y:{beginAtZero:!0}}}})})()})]}),(0,l.jsxs)(i,{value:e,index:3,children:[(0,l.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Cost Allocation"}),(0,l.jsx)("div",{className:"space-y-4",children:p.allocations.map((e,t)=>(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 mb-4",children:[(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Allocation Base"}),(0,l.jsx)("input",{type:"text",value:e.allocation_base,onChange:e=>v(t,"allocation_base",e.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Allocation Percentage"}),(0,l.jsx)("input",{type:"number",value:e.allocation_percentage,onChange:e=>v(t,"allocation_percentage",e.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Allocated Amount"}),(0,l.jsx)("input",{type:"number",value:e.allocated_amount,onChange:e=>v(t,"allocated_amount",e.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})]},t))}),(0,l.jsxs)("button",{onClick:()=>{h((0,a._)((0,r._)({},p),{allocations:[...p.allocations,{allocation_base:"",allocation_percentage:"",allocated_amount:""}]}))},className:"mt-4 inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,l.jsx)("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})}),"Add Allocation"]})]})]})}},80561:(e,t,s)=>{s.d(t,{Fq:()=>u,N1:()=>d,nu:()=>i,yP:()=>c});var r=s(55166),a=s(36465),o=s(95155);s(12115);var l=s(32060);let n=e=>{var{type:t,height:s="300px",width:r="100%"}=e;return(0,a._)(e,["type","height","width"]),(0,o.jsx)("div",{style:{height:s,width:r,backgroundColor:"#f5f5f5",border:"1px solid #ddd",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem"},children:(0,o.jsxs)("div",{style:{textAlign:"center"},children:[(0,o.jsxs)("div",{style:{fontWeight:"bold",marginBottom:"0.5rem"},children:[t.charAt(0).toUpperCase()+t.slice(1)," Chart"]}),(0,o.jsx)("div",{style:{fontSize:"0.8rem",color:"#666"},children:"(Chart rendering disabled)"})]})})},d=e=>(0,o.jsx)(n,(0,r._)({type:"line"},e)),c=e=>(0,o.jsx)(n,(0,r._)({type:"bar"},e)),i=e=>(0,o.jsx)(n,(0,r._)({type:"doughnut"},e)),u=e=>(0,o.jsx)(n,(0,r._)({type:"pie"},e));e=>(0,o.jsx)(n,(0,r._)({type:"radar"},e)),l.default}}]);