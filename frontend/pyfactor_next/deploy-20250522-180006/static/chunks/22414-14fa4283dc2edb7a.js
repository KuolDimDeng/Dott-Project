"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[22414],{22414:(e,t,s)=>{s.r(t),s.d(t,{default:()=>m});var a=s(55166),r=s(68387),l=s(95155),o=s(12115),n=s(29729),i=s(42749);s(72821);var c=s(87449),d=s(54740);let m=o.memo(e=>{let{newEstimate:t=!1}=e,[s,m]=(0,o.useState)(2*!t),[u,x]=(0,o.useState)(()=>[]),[b,h]=(0,o.useState)(null),[g,f]=(0,o.useState)(0),[y,p]=(0,o.useState)(10),[v,w]=(0,o.useState)(0),[j,N]=(0,o.useState)(()=>({title:"Estimate",summary:"",customerRef:"",customer_name:"",date:new Date,valid_until:new Date(Date.now()+2592e6),items:[],discount:0,currency:"USD",footer:"",totalAmount:0})),k=(0,c.d)(),[C,_]=(0,o.useState)(!1),[S,E]=(0,o.useState)(null),[F,A]=(0,o.useState)(!1),[D,P]=(0,o.useState)(!1),[T,M]=(0,o.useState)(""),[O,U]=(0,o.useState)(()=>[]),[L,q]=(0,o.useState)(()=>[]),[R,V]=(0,o.useState)(()=>[]),[B,I]=(0,o.useState)(!0),[z,W]=(0,o.useState)(null),G=o.useRef(!1),H=(0,o.useCallback)(async()=>{try{I(!0),T||i.vF.warn("Missing userSchema for fetchCustomers, using default"),console.log("Fetching customers from schema:",T||"default_schema");let e=await new Promise((e,t)=>{(async()=>{try{let t=await n.SP.get("/customers",{params:{schema:T||"default_schema"},timeout:6e4});e(t)}catch(e){"ECONNABORTED"===e.code&&i.vF.warn("[EstimateManagement] Customer request aborted or timed out, will retry automatically"),t(e)}})().catch(t)});if(!e.data||!Array.isArray(e.data)){i.vF.warn("Invalid customers data format:",e.data),U([]);return}console.log("Fetched customers:",e.data),U(e.data)}catch(e){console.error("Error fetching customers:",e),i.vF.error("Error fetching customers:",e),W("Unable to load customers. Please try again later."),U([]),k.warning("Unable to load customers. Please try again later.")}finally{I(!1)}},[T,k]);(0,o.useEffect)(()=>{H()},[H]);let J=(0,o.useCallback)(e=>(e||[]).map(e=>(0,r._)((0,a._)({},e),{customer:"".concat(e.customer_name," (Account: ").concat(e.customer_ref||"",")"),totalAmount:parseFloat(e.totalAmount||0).toFixed(2),items:e.items||[]})),[]),Q=(0,o.useCallback)(async e=>{try{var t;e||i.vF.warn("Missing tenant_id for fetchEstimates");let s=new AbortController,a=setTimeout(()=>s.abort(),2e4),r=await new Promise((t,a)=>{let r=0,l=async()=>{try{let a=await n.SP.get("/estimates",{params:{tenant_id:e,page:g+1,limit:y},timeout:2e4,signal:s.signal});t(a)}catch(e){if(r>=2||e.response&&503!==e.response.status&&504!==e.response.status&&"ECONNABORTED"!==e.code)return void a(e);r++,i.vF.warn("[EstimateManagement] Estimates request failed, retrying (".concat(r,"/").concat(2,")...")),setTimeout(l,1e3*Math.pow(2,r))}};l()});if(clearTimeout(a),i.vF.debug("Fetched ".concat((null==(t=r.data)?void 0:t.length)||0," estimates")),!r.data){i.vF.warn("Invalid estimates data format"),x([]);return}let l=Array.isArray(r.data)?r.data:r.data.results||[],o=r.data.count||l.length,c=J(l);x(c),w(o)}catch(t){i.vF.error("Error fetching estimates:",t.message);let e=J([{id:"fallback-estimate-1",title:"Sample Estimate (Offline Mode)",summary:"This is a sample estimate shown when the database is unavailable",customer_name:"Sample Customer",customer_ref:"CUST-001",date:new Date().toISOString().split("T")[0],valid_until:new Date(Date.now()+2592e6).toISOString().split("T")[0],totalAmount:"1250.00",is_fallback:!0},{id:"fallback-estimate-2",title:"Another Sample Estimate (Offline Mode)",summary:"This is another sample estimate shown when the database is unavailable",customer_name:"Another Sample Customer",customer_ref:"CUST-002",date:new Date().toISOString().split("T")[0],valid_until:new Date(Date.now()+1296e6).toISOString().split("T")[0],totalAmount:"750.00",is_fallback:!0}]);x(e),w(e.length),k.warning("Unable to load estimates. Showing sample data.")}},[J,k,g,y]),K=(0,o.useCallback)(async()=>{try{let e=await new Promise((e,t)=>{(async()=>{try{let t=await n.SP.get("/products",{params:{schema:T||"default_schema"},timeout:6e4});e(t)}catch(e){"ECONNABORTED"===e.code&&i.vF.warn("[EstimateManagement] Products request aborted or timed out, will retry automatically"),t(e)}})().catch(t)});q(e.data||[])}catch(e){i.vF.error("Error fetching products",e),q([]),k.warning("Unable to load products. Please try again later.")}},[T,k]),X=(0,o.useCallback)(async()=>{try{let e=await new Promise((e,t)=>{(async()=>{try{let t=await n.SP.get("/services",{params:{schema:T||"default_schema"},timeout:6e4});e(t)}catch(e){"ECONNABORTED"===e.code&&i.vF.warn("[EstimateManagement] Services request aborted or timed out, will retry automatically"),t(e)}})().catch(t)});V(e.data||[])}catch(e){i.vF.error("Error fetching services",e),V([]),k.warning("Unable to load services. Please try again later.")}},[T,k]),Y=(0,o.useCallback)(async()=>{try{let e=await n.SP.get("/api/profile");console.log("User profile:",e.data);let t=e.data.tenant_id||"default";M(t),console.log("User schema:",t),e.data._error&&i.vF.warn("Using fallback profile data:",e.data._error)}catch(e){console.error("Error fetching user profile:",e),i.vF.error("Error fetching user profile:",e),M("default_schema"),k.warning("Using default profile settings")}},[k]);(0,o.useEffect)(()=>{Y()},[Y]),(0,o.useEffect)(()=>{T&&(Q(T),H(),K(),X())},[T,Q,H,K,X]);let Z=(0,o.useCallback)(e=>{m(e)},[]),$=(0,o.useCallback)(e=>{let{name:t,value:s}=e.target;N(e=>(0,r._)((0,a._)({},e),{[t]:s}))},[]),ee=(0,o.useCallback)((e,t)=>{N(s=>(0,r._)((0,a._)({},s),{[t]:e}))},[]),et=(0,o.useCallback)(()=>{N(e=>(0,r._)((0,a._)({},e),{items:[...e.items,{product:"",quantity:1,unitPrice:0}]}))},[]),es=(0,o.useCallback)((e,t)=>{if(!e)return 0;let s=e.reduce((e,t)=>e+(Number(t.quantity)||0)*(Number(t.unitPrice)||0),0);return s-(Number(t)||0)},[]),ea=(0,o.useCallback)((e,t,s)=>{N(l=>{let o=[...l.items];if(o[e][t]=s,"product"===t){let t=[...L,...R].find(e=>e.id===s);t&&(o[e].unitPrice=parseFloat(t.price)||0)}return("quantity"===t||"unitPrice"===t)&&(o[e][t]=parseFloat(s)||0),(0,r._)((0,a._)({},l),{items:o,totalAmount:es(o,l.discount)})})},[L,R,es]),er=(0,o.useCallback)(e=>{let t=parseFloat(e.target.value)||0;N(e=>(0,r._)((0,a._)({},e),{discount:t,totalAmount:es(e.items,t)}))},[es]),el=(0,o.useCallback)(e=>{N(t=>{let s=t.items.filter((t,s)=>s!==e);return(0,r._)((0,a._)({},t),{items:s,totalAmount:es(s,t.discount)})})},[es]),eo=async e=>{if(e.preventDefault(),!j.customerRef)return void k.error("Please select a customer");try{let e=e=>e instanceof Date?e.toISOString().split("T")[0]:e,t=(j.items||[]).map(e=>({product:e.product,quantity:parseInt(e.quantity),unit_price:parseFloat(e.unitPrice)})),s=(0,r._)((0,a._)({},j),{customer:j.customerRef,date:e(j.date),valid_until:e(j.valid_until),items:t,discount:parseFloat(j.discount),totalAmount:j.totalAmount,schema:T||"default_schema"});console.log("Estimate data being sent to create:",s);let l=await n.SP.post("/estimates/create/",s);console.log("Create estimate response:",l.data),k.success("Estimate created successfully"),N({title:"Estimate",summary:"",customer_name:"",date:new Date,valid_until:new Date(Date.now()+2592e6),items:[],discount:0,currency:"USD",footer:"",totalAmount:0}),Q(T)}catch(e){console.error("Error creating estimate",e),e.response&&e.response.data?(console.error("Error details:",e.response.data),k.error("Error creating estimate: ".concat(JSON.stringify(e.response.data)))):k.error("Error creating estimate")}},en=e=>{console.log("Selected estimate:",e),h(e),m(1)},ei=async()=>{try{let e=(0,r._)((0,a._)({},S),{schema:T||"default_schema"}),t=await n.SP.put("/estimates/".concat(b.id,"/"),e);h(t.data),_(!1),Q(T),k.success("Estimate updated successfully")}catch(e){i.vF.error("Error updating estimate",e),k.error("Error updating estimate")}},ec=async()=>{try{await n.SP.delete("/estimates/".concat(b.id,"/"),{params:{schema:T||"default_schema"}}),k.success("Estimate deleted successfully"),A(!1),h(null),Q(T),m(2)}catch(e){i.vF.error("Error deleting estimate",e),k.error("Error deleting estimate")}},ed=()=>{P(!D)},em=()=>{P(!1)},eu=e=>{console.log("Exporting to ".concat(e)),em()},ex=(0,o.useCallback)(e=>{f(e)},[]),eb=(0,o.useCallback)(e=>{p(Number(e.target.value)),f(0)},[]),eh=(0,o.useMemo)(()=>(0,l.jsxs)("div",{className:"mt-6",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,l.jsx)("h2",{className:"text-lg font-medium",children:"Estimate List"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsxs)("button",{type:"button",onClick:ed,className:"border border-blue-800 text-blue-800 hover:bg-blue-800 hover:text-white px-4 py-2 rounded shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 flex items-center",children:["Export",(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),D&&(0,l.jsx)("div",{className:"absolute right-0 mt-2 w-40 bg-white rounded-md shadow-lg z-10",children:(0,l.jsxs)("div",{className:"py-1",children:[(0,l.jsx)("button",{className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>eu("PDF"),children:"PDF"}),(0,l.jsx)("button",{className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>eu("CSV"),children:"CSV"}),(0,l.jsx)("button",{className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>eu("Excel"),children:"Excel"})]})})]})]}),(0,l.jsxs)("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:[(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,l.jsx)("thead",{className:"bg-gray-50",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Title"}),(0,l.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),(0,l.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,l.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Amount"})]})}),(0,l.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:(u||[]).map(e=>(0,l.jsxs)("tr",{onClick:()=>en(e),className:"hover:bg-gray-50 cursor-pointer",children:[(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.title}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.customer_name}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.date).toLocaleDateString()}),(0,l.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[e.totalAmount?Number(e.totalAmount).toFixed(2):"0.00"," ",e.currency]})]},e.id))})]})}),(0,l.jsxs)("div",{className:"px-4 py-3 flex items-center justify-between border-t border-gray-200",children:[(0,l.jsxs)("div",{className:"flex-1 flex justify-between sm:hidden",children:[(0,l.jsx)("button",{onClick:()=>ex(Math.max(0,g-1)),disabled:0===g,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Previous"}),(0,l.jsx)("button",{onClick:()=>ex(g+1),disabled:(g+1)*y>=v,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Next"})]}),(0,l.jsxs)("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[(0,l.jsx)("div",{children:(0,l.jsxs)("p",{className:"text-sm text-gray-700",children:["Showing ",(0,l.jsx)("span",{className:"font-medium",children:g*y+1})," to"," ",(0,l.jsx)("span",{className:"font-medium",children:Math.min((g+1)*y,v)})," ","of ",(0,l.jsx)("span",{className:"font-medium",children:v})," results"]})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("select",{value:y,onChange:eb,className:"mr-4 border border-gray-300 rounded-md py-1 px-2 text-sm",children:[5,10,25,50].map(e=>(0,l.jsxs)("option",{value:e,children:[e," per page"]},e))}),(0,l.jsxs)("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[(0,l.jsxs)("button",{onClick:()=>ex(0),disabled:0===g,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:[(0,l.jsx)("span",{className:"sr-only",children:"First"}),(0,l.jsx)("span",{"aria-hidden":"true",children:"\xab"})]}),(0,l.jsxs)("button",{onClick:()=>ex(Math.max(0,g-1)),disabled:0===g,className:"relative inline-flex items-center px-2 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:[(0,l.jsx)("span",{className:"sr-only",children:"Previous"}),(0,l.jsx)("span",{"aria-hidden":"true",children:"‹"})]}),[...Array(Math.min(5,Math.ceil(v/y)))].map((e,t)=>{let s=g-2+t;return s<0||s>=Math.ceil(v/y)?null:(0,l.jsx)("button",{onClick:()=>ex(s),className:"relative inline-flex items-center px-4 py-2 border ".concat(g===s?"bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"," text-sm font-medium"),children:s+1},s)}),(0,l.jsxs)("button",{onClick:()=>ex(g+1),disabled:(g+1)*y>=v,className:"relative inline-flex items-center px-2 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:[(0,l.jsx)("span",{className:"sr-only",children:"Next"}),(0,l.jsx)("span",{"aria-hidden":"true",children:"›"})]}),(0,l.jsxs)("button",{onClick:()=>ex(Math.ceil(v/y)-1),disabled:(g+1)*y>=v,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:[(0,l.jsx)("span",{className:"sr-only",children:"Last"}),(0,l.jsx)("span",{"aria-hidden":"true",children:"\xbb"})]})]})]})]})]})]})]}),[u,v,g,y,ex,ed,en]);return(0,o.useEffect)(()=>{G.current=!1},[u]),(0,o.useCallback)(async()=>{try{let e=new AbortController,t=setTimeout(()=>e.abort(),15e3),s=await new Promise((t,s)=>{(async()=>{try{let s=await n.SP.get("/api/vendors",{params:{schema:T||"default_schema"},timeout:15e3,signal:e.signal});t(s)}catch(e){"ECONNABORTED"===e.code?(i.vF.warn("[EstimateManagement] Vendors request aborted or timed out"),t({data:[{id:"fallback-1",name:"Sample Vendor 1 (Offline)",contact_name:"Contact 1",is_fallback:!0},{id:"fallback-2",name:"Sample Vendor 2 (Offline)",contact_name:"Contact 2",is_fallback:!0}]})):s(e)}})().catch(s)});clearTimeout(t);let a=s.data||[];a.length>0&&a[0].is_fallback&&i.vF.info("[EstimateManagement] Using fallback vendor data"),setVendors(a)}catch(e){i.vF.error("Error fetching vendors:",e),setVendors([{id:"fallback-1",name:"Sample Vendor 1 (Offline)",contact_name:"Contact 1",is_fallback:!0},{id:"fallback-2",name:"Sample Vendor 2 (Offline)",contact_name:"Contact 2",is_fallback:!0}])}},[T]),(0,l.jsxs)("div",{className:"bg-gray-50 p-6 rounded-lg",children:[(0,l.jsx)("h1",{className:"text-2xl font-semibold mb-4",children:"Estimate Management"}),(0,l.jsx)("div",{className:"border-b border-gray-200 mb-6",children:(0,l.jsxs)("nav",{className:"flex -mb-px",children:[(0,l.jsx)("button",{onClick:()=>Z(0),className:"py-4 px-6 text-center border-b-2 font-medium text-sm transition-colors duration-200 ease-in-out focus:outline-none ".concat(0===s?"text-blue-600 border-blue-600 bg-blue-50":"text-gray-500 border-transparent hover:text-gray-700 hover:border-gray-300"),children:"Create"}),(0,l.jsx)("button",{onClick:()=>Z(1),className:"py-4 px-6 text-center border-b-2 font-medium text-sm transition-colors duration-200 ease-in-out focus:outline-none ".concat(1===s?"text-blue-600 border-blue-600 bg-blue-50":"text-gray-500 border-transparent hover:text-gray-700 hover:border-gray-300"),children:"Details"}),(0,l.jsx)("button",{onClick:()=>Z(2),className:"py-4 px-6 text-center border-b-2 font-medium text-sm transition-colors duration-200 ease-in-out focus:outline-none ".concat(2===s?"text-blue-600 border-blue-600 bg-blue-50":"text-gray-500 border-transparent hover:text-gray-700 hover:border-gray-300"),children:"List"})]})}),0===s&&(0,l.jsxs)("div",{className:"mt-6",children:[(0,l.jsx)("h2",{className:"text-lg font-medium mb-4",children:"Create Estimate"}),(0,l.jsx)("form",{onSubmit:eo,children:(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),(0,l.jsx)("input",{type:"text",id:"title",name:"title",value:j.title,onChange:$,required:!0,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm py-2 px-3 border"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"summary",className:"block text-sm font-medium text-gray-700 mb-1",children:"Summary"}),(0,l.jsx)("textarea",{id:"summary",name:"summary",rows:"3",value:j.summary,onChange:$,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm py-2 px-3 border"})]}),(0,l.jsxs)("div",{className:"w-full md:w-1/2",children:[(0,l.jsx)("label",{htmlFor:"customerRef",className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer"}),(0,l.jsxs)("select",{id:"customerRef",name:"customerRef",value:j.customerRef,onChange:$,className:"w-full rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm py-2 px-3 border ".concat(z?"border-red-500":"border-gray-300"),children:[(0,l.jsx)("option",{value:"",children:"Select a customer"}),(O||[]).map(e=>(0,l.jsx)("option",{value:String(e.id),children:e.customerName||"".concat(e.first_name," ").concat(e.last_name)},e.id))]}),z&&(0,l.jsx)("p",{className:"mt-1 text-sm text-red-600",children:z})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"date",className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),(0,l.jsx)(d.A,{id:"date",selected:j.date,onChange:e=>ee(e,"date"),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm py-2 px-3 border"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"valid_until",className:"block text-sm font-medium text-gray-700 mb-1",children:"Valid Until"}),(0,l.jsx)(d.A,{id:"valid_until",selected:j.valid_until,onChange:e=>ee(e,"valid_until"),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm py-2 px-3 border"})]})]}),(0,l.jsxs)("div",{className:"mt-6",children:[(0,l.jsx)("h3",{className:"text-md font-medium mb-2",children:"Items"}),(j.items||[]).map((e,t)=>(0,l.jsxs)("div",{className:"flex flex-wrap items-center mb-4 gap-3",children:[(0,l.jsxs)("div",{className:"grow lg:max-w-md",children:[(0,l.jsx)("label",{htmlFor:"product-".concat(t),className:"block text-sm font-medium text-gray-700 mb-1",children:"Product/Service"}),(0,l.jsxs)("select",{id:"product-".concat(t),value:e.product,onChange:e=>ea(t,"product",e.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm py-2 px-3 border",children:[(0,l.jsx)("option",{value:"",children:"Select a product/service"}),(L||[]).map(e=>(0,l.jsx)("option",{value:e.id,children:e.name},e.id)),(R||[]).map(e=>(0,l.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,l.jsxs)("div",{className:"w-24",children:[(0,l.jsx)("label",{htmlFor:"quantity-".concat(t),className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantity"}),(0,l.jsx)("input",{id:"quantity-".concat(t),type:"number",value:e.quantity,onChange:e=>ea(t,"quantity",e.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm py-2 px-3 border"})]}),(0,l.jsxs)("div",{className:"w-32",children:[(0,l.jsx)("label",{htmlFor:"unitPrice-".concat(t),className:"block text-sm font-medium text-gray-700 mb-1",children:"Unit Price"}),(0,l.jsx)("input",{id:"unitPrice-".concat(t),type:"number",value:e.unitPrice,onChange:e=>ea(t,"unitPrice",e.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm py-2 px-3 border"})]}),(0,l.jsx)("div",{className:"flex items-end",children:(0,l.jsx)("button",{type:"button",onClick:()=>el(t),className:"p-2 text-red-600 hover:text-red-800 focus:outline-none mt-5",children:(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})})]},t)),(0,l.jsxs)("button",{type:"button",onClick:et,className:"flex items-center text-blue-600 hover:text-blue-800 focus:outline-none",children:[(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Item"]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"discount",className:"block text-sm font-medium text-gray-700 mb-1",children:"Discount"}),(0,l.jsx)("input",{type:"number",id:"discount",name:"discount",value:j.discount,onChange:er,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm py-2 px-3 border"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"totalAmount",className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Amount"}),(0,l.jsx)("input",{type:"text",id:"totalAmount",value:j.totalAmount.toFixed(2),disabled:!0,className:"w-full rounded-md border-gray-300 shadow-sm bg-gray-50 sm:text-sm py-2 px-3 border"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"currency",className:"block text-sm font-medium text-gray-700 mb-1",children:"Currency"}),(0,l.jsxs)("select",{id:"currency",name:"currency",value:j.currency,onChange:$,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm py-2 px-3 border",children:[(0,l.jsx)("option",{value:"USD",children:"USD"}),(0,l.jsx)("option",{value:"EUR",children:"EUR"}),(0,l.jsx)("option",{value:"GBP",children:"GBP"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"footer",className:"block text-sm font-medium text-gray-700 mb-1",children:"Footer"}),(0,l.jsx)("textarea",{id:"footer",name:"footer",rows:"3",value:j.footer,onChange:$,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm py-2 px-3 border"})]}),(0,l.jsx)("div",{className:"mt-4",children:(0,l.jsx)("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Create Estimate"})})]})})]}),1===s&&(0,l.jsxs)("div",{className:"mt-6",children:[(0,l.jsx)("h2",{className:"text-lg font-medium mb-4",children:"Estimate Details"}),b?(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"title-view",className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),(0,l.jsx)("input",{type:"text",id:"title-view",name:"title",value:C?S.title:b.title,onChange:$,disabled:!C,className:"w-full rounded-md shadow-sm sm:text-sm py-2 px-3 border ".concat(C?"border-gray-300 focus:border-blue-500 focus:ring-blue-500":"bg-gray-50 text-gray-500")})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"summary-view",className:"block text-sm font-medium text-gray-700 mb-1",children:"Summary"}),(0,l.jsx)("textarea",{id:"summary-view",name:"summary",rows:"3",value:C?S.summary:b.summary,onChange:$,disabled:!C,className:"w-full rounded-md shadow-sm sm:text-sm py-2 px-3 border ".concat(C?"border-gray-300 focus:border-blue-500 focus:ring-blue-500":"bg-gray-50 text-gray-500")})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"customer-view",className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer"}),(0,l.jsx)("input",{type:"text",id:"customer-view",name:"customer_name",value:C?S.customer_name:b.customer_name,onChange:$,disabled:!C,className:"w-full rounded-md shadow-sm sm:text-sm py-2 px-3 border ".concat(C?"border-gray-300 focus:border-blue-500 focus:ring-blue-500":"bg-gray-50 text-gray-500")})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"date-view",className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),(0,l.jsx)("input",{type:"date",id:"date-view",name:"date",value:C?S.date:b.date,onChange:$,disabled:!C,className:"w-full rounded-md shadow-sm sm:text-sm py-2 px-3 border ".concat(C?"border-gray-300 focus:border-blue-500 focus:ring-blue-500":"bg-gray-50 text-gray-500")})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"valid-until-view",className:"block text-sm font-medium text-gray-700 mb-1",children:"Valid Until"}),(0,l.jsx)("input",{type:"date",id:"valid-until-view",name:"valid_until",value:C?S.valid_until:b.valid_until,onChange:$,disabled:!C,className:"w-full rounded-md shadow-sm sm:text-sm py-2 px-3 border ".concat(C?"border-gray-300 focus:border-blue-500 focus:ring-blue-500":"bg-gray-50 text-gray-500")})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"total-amount-view",className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Amount"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,l.jsx)("span",{className:"text-gray-500 sm:text-sm",children:b.currency})}),(0,l.jsx)("input",{type:"text",id:"total-amount-view",name:"totalAmount",value:C?S.totalAmount||"0.00":b.totalAmount?Number(b.totalAmount).toFixed(2):"0.00",onChange:$,disabled:!C,className:"w-full rounded-md shadow-sm sm:text-sm py-2 pl-12 pr-3 border ".concat(C?"border-gray-300 focus:border-blue-500 focus:ring-blue-500":"bg-gray-50 text-gray-500")})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"discount-view",className:"block text-sm font-medium text-gray-700 mb-1",children:"Discount"}),(0,l.jsx)("input",{type:"number",id:"discount-view",name:"discount",value:C?S.discount:b.discount,onChange:$,disabled:!C,className:"w-full rounded-md shadow-sm sm:text-sm py-2 px-3 border ".concat(C?"border-gray-300 focus:border-blue-500 focus:ring-blue-500":"bg-gray-50 text-gray-500")})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"currency-view",className:"block text-sm font-medium text-gray-700 mb-1",children:"Currency"}),(0,l.jsx)("input",{type:"text",id:"currency-view",name:"currency",value:C?S.currency:b.currency,onChange:$,disabled:!C,className:"w-full rounded-md shadow-sm sm:text-sm py-2 px-3 border ".concat(C?"border-gray-300 focus:border-blue-500 focus:ring-blue-500":"bg-gray-50 text-gray-500")})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"footer-view",className:"block text-sm font-medium text-gray-700 mb-1",children:"Footer"}),(0,l.jsx)("textarea",{id:"footer-view",name:"footer",rows:"3",value:C?S.footer:b.footer,onChange:$,disabled:!C,className:"w-full rounded-md shadow-sm sm:text-sm py-2 px-3 border ".concat(C?"border-gray-300 focus:border-blue-500 focus:ring-blue-500":"bg-gray-50 text-gray-500")})]}),(0,l.jsx)("div",{className:"flex mt-6 gap-3",children:C?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("button",{type:"button",onClick:ei,className:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Save"}),(0,l.jsx)("button",{type:"button",onClick:()=>{_(!1),E(null)},className:"bg-gray-300 hover:bg-gray-400 text-gray-800 font-medium py-2 px-4 rounded shadow-sm focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2",children:"Cancel"})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("button",{type:"button",onClick:()=>{_(!0),E((0,a._)({},b))},className:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Edit"}),(0,l.jsx)("button",{type:"button",onClick:()=>{A(!0)},className:"bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded shadow-sm focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2",children:"Delete"})]})})]}):(0,l.jsx)("p",{className:"text-gray-500 italic",children:"Select an estimate from the list to view details"})]}),2===s&&eh,F&&(0,l.jsx)("div",{className:"fixed inset-0 overflow-y-auto z-50","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:(0,l.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,l.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true"}),(0,l.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),(0,l.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,l.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,l.jsxs)("div",{className:"sm:flex sm:items-start",children:[(0,l.jsx)("div",{className:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10",children:(0,l.jsx)("svg",{className:"h-6 w-6 text-red-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,l.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,l.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",id:"modal-title",children:"Confirm Delete"}),(0,l.jsx)("div",{className:"mt-2",children:(0,l.jsxs)("p",{className:"text-sm text-gray-500",children:["Are you sure you want to delete this estimate?",(0,l.jsx)("br",{}),"Title: ",null==b?void 0:b.title,(0,l.jsx)("br",{}),"Customer: ",null==b?void 0:b.customer_name]})})]})]})}),(0,l.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,l.jsx)("button",{type:"button",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm",onClick:ec,children:"Delete"}),(0,l.jsx)("button",{type:"button",className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",onClick:()=>A(!1),children:"Cancel"})]})]})]})})]})})},54740:(e,t,s)=>{s.d(t,{A:()=>l});var a=s(95155),r=s(12115);function l(e){let[t,s]=(0,r.useState)(!1);(0,r.useEffect)(()=>{s(!0)},[]);let{selected:l,onChange:o,placeholderText:n="Select a date...",className:i=""}=e,c=l?new Date(l).toLocaleDateString():n;return(0,a.jsx)("div",{className:"datepicker-stub ".concat(i),children:(0,a.jsx)("div",{className:"w-full h-9 border border-gray-300 rounded-md bg-gray-50 px-3 py-2 text-gray-700",onClick:()=>o&&o(new Date),children:c})})}}}]);