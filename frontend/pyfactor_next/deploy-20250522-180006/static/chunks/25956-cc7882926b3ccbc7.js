"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[25956],{25956:(e,r,t)=>{t.d(r,{F6:()=>p,ensureAmplifyConfigured:()=>h,getAccessToken:()=>u,getAuthSessionWithRetries:()=>g,getAuthenticatedUser:()=>d,nH:()=>v,rG:()=>f});var a=t(24818),n=t(81746),o=t(63900),i=t(42749),s=t(39786),c=t(29670),l=t(49509);let u=async e=>{try{var r,t;if(!e)return i.vF.warn("No session provided to getAccessToken"),null;if(e.accessToken)return e.accessToken;if(null==(r=e.user)?void 0:r.accessToken)return e.user.accessToken;if(null==(t=e.token)?void 0:t.accessToken)return e.token.accessToken;return i.vF.warn("No access token found in session"),null}catch(e){return i.vF.error("Error extracting access token:",e),null}};function h(){try{return t(60383).A,i.vF.debug("[authUtils] Amplify configuration loaded successfully"),!0}catch(e){i.vF.error("[authUtils] Error in ensureAmplifyConfigured:",e);try{return o.E.configure({Auth:{Cognito:{region:"us-east-1",userPoolId:l.env.NEXT_PUBLIC_USER_POOL_ID||"us-east-1_JPL8vGfb6",userPoolClientId:l.env.NEXT_PUBLIC_USER_POOL_CLIENT_ID||"1o5v84mrgn4gt87khtr179uc5b"}}}),i.vF.debug("[authUtils] Applied fallback Amplify configuration"),!0}catch(e){return i.vF.error("[authUtils] Fallback configuration also failed:",e),!1}}}async function g(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,r=0,t=null;for(;r<=e;)try{h(),r>0&&await new Promise(e=>setTimeout(e,300*r)),i.vF.debug("[authUtils] Attempting to get auth session (attempt ".concat(r+1,"/").concat(e+1,")"));let t=await (0,a.$)();return i.vF.debug("[authUtils] Successfully retrieved auth session"),t}catch(a){t=a,i.vF.warn("[authUtils] Error getting auth session (attempt ".concat(r+1,"/").concat(e+1,"):"),a),r++}throw i.vF.error("[authUtils] Failed to get auth session after ".concat(e," retries:"),t),t}async function d(){try{h();let e=await (0,n.H)();return i.vF.debug("[authUtils] Current user retrieved successfully"),e}catch(e){return i.vF.warn("[authUtils] Error getting current user:",e),null}}async function f(){try{i.vF.debug("[authUtils] Clearing all authentication data");try{await (0,c.bB)(),i.vF.debug("[authUtils] Successfully cleared AWS App Cache")}catch(e){i.vF.error("[authUtils] Error clearing AWS App Cache:",e)}await Promise.all(["idToken","accessToken","refreshToken","user","auth","session"].map(async e=>{try{await (0,c.$R)(e)}catch(r){i.vF.warn("[authUtils] Error removing ".concat(e," from App Cache:"),r)}}));try{window.sessionStorage.clear(),i.vF.debug("[authUtils] Successfully cleared sessionStorage")}catch(e){i.vF.error("[authUtils] Error clearing sessionStorage:",e)}try{window.localStorage.clear(),i.vF.debug("[authUtils] Successfully cleared localStorage")}catch(e){i.vF.error("[authUtils] Error clearing localStorage:",e)}try{let e=await window.indexedDB.databases();await Promise.all(e.map(e=>{if(e.name)return new Promise((r,t)=>{let a=window.indexedDB.deleteDatabase(e.name);a.onsuccess=()=>r(),a.onerror=()=>t(a.error)})})),i.vF.debug("[authUtils] Successfully cleared IndexedDB databases")}catch(e){i.vF.error("[authUtils] Error clearing IndexedDB:",e)}i.vF.debug("[authUtils] Successfully cleared all authentication data")}catch(e){throw i.vF.error("[authUtils] Error in clearAllAuthData:",e),e}}async function p(e){try{let{getCurrentUser:r,updateUserAttributes:a}=await Promise.all([t.e(23639),t.e(38501),t.e(31861),t.e(49291)]).then(t.bind(t,55158)),{userAttributes:n}=await r();if(!(n&&n["custom:created_at"])){let r=new Date().toISOString();await a({userAttributes:{"custom:created_at":r}}),i.vF.info("Added created_at attribute for user",{userId:null==e?void 0:e.username,timestamp:r})}}catch(e){i.vF.warn("Error ensuring user created_at attribute:",e.message||e)}}async function v(){try{i.vF.debug("[authUtils] Preparing for sign-in");try{let{getCurrentUser:e}=await Promise.all([t.e(23639),t.e(38501),t.e(31861),t.e(49291)]).then(t.bind(t,55158));await e()&&(i.vF.info("[authUtils] User already signed in, signing out before new sign-in"),await f())}catch(r){var e;(null==(e=r.message)?void 0:e.includes("not authenticated"))||(i.vF.warn("[authUtils] Error checking current user, clearing auth state to be safe:",r),await f())}let{configureAmplify:r}=await Promise.all([t.e(23639),t.e(38501),t.e(38475)]).then(t.bind(t,60584));return r(!0),i.vF.info("[authUtils] Successfully prepared for sign-in"),!0}catch(e){return i.vF.error("[authUtils] Error preparing for sign-in:",e),!1}}h()},29670:(e,r,t)=>{t.d(r,{$R:()=>l,A6:()=>s,Ay:()=>h,IL:()=>c,bB:()=>u,gd:()=>i,mm:()=>o});var a=t(42749);let n=null;try{window.AWSCache&&(n=window.AWSCache,a.vF.debug("[appCache] AWS App Cache initialized successfully"))}catch(e){a.vF.warn("[appCache] Failed to initialize AWS App Cache:",e)}async function o(e,r,t){try{if(!e)throw Error("Cache key is required");if(n)await n.set(e,r,t),a.vF.debug("[appCache] Set value for key: ".concat(e));else{let n={value:r,timestamp:Date.now(),ttl:t?1e3*t:null};window.sessionStorage.setItem(e,JSON.stringify(n)),a.vF.debug("[appCache] Set value in sessionStorage for key: ".concat(e))}}catch(r){throw a.vF.error("[appCache] Error setting cache value for key ".concat(e,":"),r),r}}async function i(e){try{if(!e)throw Error("Cache key is required");if(n){let r=await n.get(e);return a.vF.debug("[appCache] Retrieved value for key: ".concat(e)),r}{let r=window.sessionStorage.getItem(e);if(!r)return null;let{value:t,timestamp:n,ttl:o}=JSON.parse(r);if(o&&Date.now()-n>o)return window.sessionStorage.removeItem(e),a.vF.debug("[appCache] Removed expired value for key: ".concat(e)),null;return a.vF.debug("[appCache] Retrieved value from sessionStorage for key: ".concat(e)),t}}catch(r){return a.vF.error("[appCache] Error getting cache value for key ".concat(e,":"),r),null}}async function s(e){try{if(!e)throw Error("Cache key is required");n?(await n.remove(e),a.vF.debug("[appCache] Removed value for key: ".concat(e))):(window.sessionStorage.removeItem(e),a.vF.debug("[appCache] Removed value from sessionStorage for key: ".concat(e)))}catch(r){throw a.vF.error("[appCache] Error removing cache value for key ".concat(e,":"),r),r}}async function c(){try{n?(await n.clear(),a.vF.debug("[appCache] Cleared all values from AWS App Cache")):(window.sessionStorage.clear(),a.vF.debug("[appCache] Cleared all values from sessionStorage"))}catch(e){throw a.vF.error("[appCache] Error clearing cache:",e),e}}let l=s,u=c,h={setCacheValue:o,getCacheValue:i,removeCacheValue:s,clearCache:c,setAppCacheItem:o,getAppCacheItem:i,removeAppCacheItem:l,clearAppCache:u}},39786:(e,r,t)=>{t.d(r,{s:()=>n});class a extends Error{}function n(e,r){let t;if("string"!=typeof e)throw new a("Invalid token specified: must be a string");r||(r={});let n=+(!0!==r.header),o=e.split(".")[n];if("string"!=typeof o)throw new a(`Invalid token specified: missing part #${n+1}`);try{t=function(e){let r=e.replace(/-/g,"+").replace(/_/g,"/");switch(r.length%4){case 0:break;case 2:r+="==";break;case 3:r+="=";break;default:throw Error("base64 string is not of the correct length")}try{var t;return t=r,decodeURIComponent(atob(t).replace(/(.)/g,(e,r)=>{let t=r.charCodeAt(0).toString(16).toUpperCase();return t.length<2&&(t="0"+t),"%"+t}))}catch(e){return atob(r)}}(o)}catch(e){throw new a(`Invalid token specified: invalid base64 for part #${n+1} (${e.message})`)}try{return JSON.parse(t)}catch(e){throw new a(`Invalid token specified: invalid json for part #${n+1} (${e.message})`)}}a.prototype.name="InvalidTokenError"},60383:(e,r,t)=>{t.d(r,{A:()=>o});var a=t(63900),n=t(49509);try{let e=n.env.NEXT_PUBLIC_USER_POOL_ID||"us-east-1_JPL8vGfb6",r=n.env.NEXT_PUBLIC_USER_POOL_CLIENT_ID||"1o5v84mrgn4gt87khtr179uc5b",t={Auth:{Cognito:{region:"us-east-1",userPoolId:e,userPoolClientId:r,loginWith:{email:!0,phone:!1,username:!0}}}};a.E.configure(t),"undefined"!=typeof console&&console.log("[AmplifyConfig] Auth configuration applied with:",{region:t.Auth.Cognito.region,userPoolId:t.Auth.Cognito.userPoolId,clientId:t.Auth.Cognito.userPoolClientId}),window.isAmplifyConfigured=()=>{try{let e=a.E.getConfig();return!!(e&&e.Auth&&e.Auth.Cognito&&e.Auth.Cognito.userPoolId)}catch(e){return console.error("[AmplifyConfig] Error checking configuration:",e),!1}},window.reconfigureAmplify=()=>{try{return a.E.configure(t),console.log("[AmplifyConfig] Amplify reconfigured successfully"),!0}catch(e){return console.error("[AmplifyConfig] Error reconfiguring Amplify:",e),!1}}}catch(e){console.error("[AmplifyConfig] Error configuring Amplify:",e)}let o=a.E}}]);