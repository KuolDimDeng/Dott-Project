"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[23428],{16905:(e,t,s)=>{s.d(t,{E:()=>n});var a=s(29670);let n={get:async e=>(0,a.gd)(e),set:async function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=s.expires?1e3*s.expires:void 0;return(0,a.mm)(e,t,{ttl:n})},remove:async e=>(0,a.A6)(e),clear:async()=>(0,a.IL)(),keys:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object.keys(window.__APP_CACHE||{}).filter(t=>t.startsWith(e))}}},23428:(e,t,s)=>{s.r(t),s.d(t,{default:()=>h});var a=s(55166),n=s(68387),r=s(95155),l=s(12115),o=s(42749),i=s(16905),c=s(24818),d=s(19689),m=s(8754),u=s(66352),x=s(51174);let b=[{id:"mock-id-1",customerName:"Acme Corporation",first_name:"John",last_name:"Doe",email:"john.doe@acme.com",phone:"555-123-4567",city:"New York",billingState:"NY",billingCountry:"USA"},{id:"mock-id-2",customerName:"Tech Solutions Inc",first_name:"Jane",last_name:"Smith",email:"jane.smith@techsolutions.com",phone:"555-987-6543",city:"San Francisco",billingState:"CA",billingCountry:"USA"},{id:"mock-id-3",customerName:"Global Enterprises",first_name:"Robert",last_name:"Johnson",email:"robert@globalenterprises.com",phone:"555-456-7890",city:"Chicago",billingState:"IL",billingCountry:"USA"}],h=()=>{let[e,t]=(0,l.useState)([]),[s,h]=(0,l.useState)(!0),[g,f]=(0,l.useState)(null),[p,y]=(0,l.useState)(""),[j,N]=(0,l.useState)(null),[w,v]=(0,l.useState)(!1),[C,k]=(0,l.useState)(1),[_,S]=(0,l.useState)(10),[E,F]=(0,l.useState)(1),[A,I]=(0,l.useState)(!1),[P,D]=(0,l.useState)(!1),[T,M]=(0,l.useState)({customerName:"",first_name:"",last_name:"",email:"",phone:"",website:"",city:"",billingState:"",billingCountry:""}),[U,R]=(0,l.useState)(!1),[L,O]=(0,l.useState)(""),[z,J]=(0,l.useState)(!1),[W,G]=(0,l.useState)(null),[B,X]=(0,l.useState)(!1),[q,Y]=(0,l.useState)(null),[H,V]=(0,l.useState)(!1),[$,K]=(0,l.useState)(null),[Q,Z]=(0,l.useState)(!1),[ee,et]=(0,l.useState)(""),[es,ea]=(0,l.useState)(!1),en=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"operation",t=null;try{var s,a,n,r;let l=await (0,c.$)(),o=(null==(a=l.tokens)||null==(s=a.idToken)?void 0:s.payload)||{};console.log("Cognito token claims:",JSON.stringify(o)),t=o["custom:tenant_id"]||o["custom:tenant_ID"]||o["custom:tenantId"]||o.tenant_id||o.tenantId||o.tenant_ID||null;let d=window.location.pathname.match(/^\/([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})\/dashboard/i),m=d?d[1]:null;if(m&&(!t||t!==m)&&(console.log("Using tenant ID from URL: ".concat(m," (instead of ").concat(t||"none"," from Cognito)")),t=m),t)await i.E.set("current_tenant_id",t,{expires:86400});else{let s=await i.E.get("current_tenant_id");s?(t=s,console.log("Using tenant ID from cache: ".concat(t))):console.warn("No tenant ID found for ".concat(e,". This may cause visibility issues."))}return console.log("Performing ".concat(e," with tenant ID: ").concat(t||"undefined")),{tenantId:t,token:(null==(r=l.tokens)||null==(n=r.idToken)?void 0:n.toString())||""}}catch(t){console.error("Error extracting tenant ID for ".concat(e,":"),t);try{let e=window.location.pathname.match(/^\/([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})\/dashboard/i);if(e){let t=e[1];return console.log("Fallback to tenant ID from URL: ".concat(t)),{tenantId:t,token:""}}}catch(e){console.error("Error extracting tenant ID from URL:",e)}return{tenantId:null,token:""}}},er=(0,l.useCallback)(async()=>{try{h(!0),f(null);let e=await (0,x.jW)();if(!e)return void f(Error("Authentication error: Unable to verify your organization. Please log out and sign in again."));console.log("[CustomersManagement] Fetching customers with secure Cognito tenant ID:",e);let s=new URLSearchParams;C>1&&s.append("page",C),s.append("limit",_),p&&s.append("search",p);let a=s.toString()?"?".concat(s.toString()):"",n=await fetch("/api/customers".concat(a),{headers:{"X-Tenant-ID":e,"Content-Type":"application/json"}});if(!n.ok)throw Error("Failed to fetch customers: ".concat(n.status));let r=await n.json();t(r),F(Math.ceil(r.length/_))}catch(e){console.error("[CustomersManagement] Error fetching customers:",e),f(e)}finally{h(!1)}},[_,C,p]);(0,l.useEffect)(()=>{er()},[er]);let el=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;try{var a;let e,{tenantId:s,token:n}=await en("Fetching customers"),r=new URLSearchParams({page:C,limit:_});p&&r.append("search",p),s&&r.append("tenantId",s);let l=await fetch("/api/customers/?".concat(r.toString()),{headers:{Authorization:"Bearer ".concat(n),"x-tenant-id":s||""}});if(!l.ok){let e=await l.text();throw o.vF.error("API error (".concat(l.status,"): ").concat(e)),Error("API returned status ".concat(l.status,": ").concat(e))}let c=l.headers.get("content-type");if(!c||!c.includes("application/json")){let e=await l.text();throw o.vF.error("API returned non-JSON response: ".concat(e.substring(0,200),"...")),Error("API returned non-JSON response type: ".concat(c||"unknown"))}try{e=await l.json()}catch(t){let e=await l.clone().text();throw o.vF.error("JSON parse error: ".concat(t.message,". Raw response: ").concat(e.substring(0,200),"...")),Error("Failed to parse JSON response: ".concat(t.message))}o.vF.info("Fetched ".concat((null==(a=e.results)?void 0:a.length)||0," customers successfully"));let d="crm_customers_".concat(p,"_").concat(C,"_").concat(_);await i.E.set(d,JSON.stringify(e),{expires:300}),t(e.results||[]),F(e.total_pages||1),h(!1)}catch(a){if(o.vF.error("Error updating customers:",a),e<3){let t=2*s,a=e+1;o.vF.info("Retrying customer fetch (".concat(a,"/").concat(3,") in ").concat(s,"ms...")),f("Temporary network issue. Retrying (".concat(a,"/").concat(3,")...")),setTimeout(()=>{el(a,t)},s);return}f("Unable to fetch customers from server. Showing example data instead."),t(b),F(1),h(!1)}},eo=e=>{k(e)},ei=e=>{N(e),I(!0)},ec=async()=>{if(j)try{let s=await (0,x.jW)();if(!s)return void console.error("[CustomersManagement] Unable to get secure tenant ID");console.log("[CustomersManagement] Deleting customer with secure Cognito tenant ID:",s);let a=await fetch("/api/customers/".concat(j.id,"/"),{method:"DELETE",headers:{"X-Tenant-ID":s,"Content-Type":"application/json"}});if(a.ok)t(e.filter(e=>e.id!==j.id)),F(Math.ceil((e.length-1)/_));else{let e=await a.text();throw console.error("Failed to delete customer: ".concat(e)),Error("Failed to delete customer: ".concat(a.status))}}catch(e){console.error("[CustomersManagement] Error deleting customer:",e)}finally{I(!1),N(null)}},ed=()=>{I(!1),N(null)},em=()=>{D(!1)},eu=e=>{let{name:t,value:s}=e.target;M(e=>(0,n._)((0,a._)({},e),{[t]:s}))},ex=async e=>{e.preventDefault();try{R(!0),O(""),J(!1);let e=await (0,x.jW)();if(!e)return void O("Authentication error: Unable to verify your organization. Please log out and sign in again.");console.log("[CustomersManagement] Creating customer with secure Cognito tenant ID:",e);let t={business_name:T.customerName,first_name:T.first_name,last_name:T.last_name,email:T.email,phone:T.phone,website:T.website,city:T.city,billing_state:T.billingState,billing_country:T.billingCountry,tenant_id:e},s=await fetch("/api/customers",{method:"POST",headers:{"X-Tenant-ID":e,"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok){let e=await s.text();throw Error("Failed to create customer: ".concat(e||s.status))}await s.json(),J(!0),D(!1),M({customerName:"",first_name:"",last_name:"",email:"",phone:"",website:"",city:"",billingState:"",billingCountry:""}),er()}catch(e){console.error("[CustomersManagement] Error creating customer:",e),O(e.message)}finally{R(!1)}},eb=e=>(N(e),v(!0),ey(e.id).catch(e=>{console.warn("[CustomersManagement] Error in handleViewCustomer flow:",e)})),eh=()=>{v(!1),G(null),N(null),V(!1),K(null),et(""),ea(!1)},eg=()=>{H?(V(!1),K(null)):(V(!0),K((0,a._)({},W))),et(""),ea(!1)},ef=e=>{let{name:t,value:s}=e.target;K(e=>(0,n._)((0,a._)({},e),{[t]:s}))},ep=async()=>{if(j&&$)try{Z(!0),et(""),ea(!1);let e=await (0,x.jW)();if(!e)return void et("Authentication error: Unable to verify your organization. Please log out and sign in again.");console.log("[CustomersManagement] Updating customer with secure Cognito tenant ID:",e);let s=await fetch("/api/customers/".concat(j.id),{method:"PUT",headers:{"X-Tenant-ID":e,"Content-Type":"application/json"},body:JSON.stringify($)});if(!s.ok){let e=await s.text();throw Error("Failed to update customer: ".concat(e||s.status))}let a=await s.json();t(e=>e.map(e=>e.id===a.id?a:e)),G(a),V(!1),ea(!0)}catch(e){console.error("[CustomersManagement] Error updating customer:",e),et(e.message)}finally{Z(!1)}},ey=(0,l.useCallback)(async e=>{if(!e)return;let t=0,s=async()=>{try{X(!0),Y(null);let t=await (0,x.jW)();if(!t)return void Y(Error("Authentication error: Unable to verify your organization. Please log out and sign in again."));console.log("[CustomersManagement] Fetching customer details with secure Cognito tenant ID:",t);let s=window.location.origin,r="".concat(s,"/api/customers/").concat(e);console.log("[CustomersManagement] Using API URL: ".concat(r));let l=await fetch(r,{headers:{"X-Tenant-ID":t,"Content-Type":"application/json","Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache"},signal:AbortSignal.timeout(5e3)});if(!l.ok){if(l.status>=500&&j){console.warn("[CustomersManagement] Server error (".concat(l.status,") when fetching details, using basic customer data as fallback")),G((0,n._)((0,a._)({},j),{_isFallback:!0,_errorStatus:l.status}));return}throw Error("Failed to fetch customer details: ".concat(l.status))}let o=await l.json();G(o)}catch(l){console.error("[CustomersManagement] Error fetching customer details:",l);let e=l.message||"",r=e.includes("Failed to fetch")||e.includes("NetworkError")||e.includes("network")||e.includes("ECONNREFUSED")||e.includes("500")||e.includes("AbortError")||e.includes("timed out")||"AbortError"===l.name||"TimeoutError"===l.name;if(t<2&&r){t++,console.log("[CustomersManagement] Retrying fetch customer details (".concat(t,"/").concat(2,")..."));let a="AbortError"===l.name||e.includes("ECONNREFUSED")?2e3:1e3;return await new Promise(e=>setTimeout(e,a)),s()}if(j){console.warn("[CustomersManagement] Using basic customer data as fallback after fetch errors");let t=e;"AbortError"===l.name?t="Request timed out or was aborted. The API server might be unreachable.":e.includes("ECONNREFUSED")&&(t="Connection refused. The API server on the specified port is not running."),G((0,n._)((0,a._)({},j),{_isFallback:!0,_errorMessage:t,_errorName:l.name||"Error"})),u.oR.error("Could not load complete customer details. Using basic information instead.")}else Y(l)}finally{X(!1)}};await s()},[j]);return s&&0===e.length?(0,r.jsxs)("div",{className:"flex justify-center items-center h-full py-8",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"}),(0,r.jsx)("p",{className:"ml-4 text-gray-600",children:"Loading customer data..."})]}):g&&0===e.length?(0,r.jsxs)("div",{className:"p-6 bg-gray-50",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-black mb-4",children:"Customer Management"}),(0,r.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert",children:[(0,r.jsx)("strong",{className:"font-bold",children:"Error: "}),(0,r.jsx)("span",{className:"block sm:inline",children:g.message}),(0,r.jsx)("button",{className:"mt-3 bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded",onClick:er,children:"Try Again"})]})]}):(0,r.jsxs)("div",{className:"p-6 bg-gray-50",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-black mb-4",children:"Customer Management"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6 mb-8",children:[(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,r.jsx)("h2",{className:"text-sm font-medium text-black",children:"Total Customers"}),(0,r.jsx)("p",{className:"text-3xl font-bold text-black mt-2",children:E*_})]}),(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,r.jsx)("h2",{className:"text-sm font-medium text-black",children:"Active Customers"}),(0,r.jsx)("p",{className:"text-3xl font-bold text-green-600 mt-2",children:e.length})]})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center flex-wrap gap-4 mb-6",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:(0,r.jsx)(m.WI,{className:"h-5 w-5 text-gray-400"})}),(0,r.jsx)("input",{type:"text",placeholder:"Search Customers",className:"pl-10 pr-4 py-2 border border-gray-300 rounded-md bg-white text-black focus:ring-blue-500 focus:border-blue-500 min-w-[300px]",value:p,onChange:e=>{y(e.target.value),k(1)}})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsxs)("button",{className:"flex items-center px-4 py-2 border border-gray-300 rounded-md bg-white text-black hover:bg-gray-50 transition-colors",children:[(0,r.jsx)(m.O7,{className:"h-5 w-5 mr-2"}),"Filter"]}),(0,r.jsxs)("button",{className:"flex items-center px-4 py-2 rounded-md bg-blue-600 text-white hover:bg-blue-700 transition-colors",onClick:()=>{O(""),J(!1),M({customerName:"",first_name:"",last_name:"",email:"",phone:"",website:"",city:"",billingState:"",billingCountry:""}),D(!0)},children:[(0,r.jsx)(m.RE,{className:"h-5 w-5 mr-2"}),"Add Customer"]})]})]}),(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-100",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-black uppercase tracking-wider",children:"Name"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-black uppercase tracking-wider",children:"Email"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-black uppercase tracking-wider",children:"Phone"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-black uppercase tracking-wider",children:"Account #"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-black uppercase tracking-wider",children:"Location"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-black uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.length>0?e.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm font-medium text-black",children:e.customerName||"".concat(e.first_name," ").concat(e.last_name)})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-black",children:e.email})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-black",children:e.phone})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-black",children:e.accountNumber})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"text-sm text-black",children:[e.city,", ",e.billingState||e.billingCountry]})}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[(0,r.jsx)("button",{onClick:()=>eb(e),className:"text-blue-600 hover:text-blue-900 mr-3",children:(0,r.jsx)(m.IT,{className:"h-5 w-5"})}),(0,r.jsx)("button",{onClick:()=>{eb(e).then(()=>{setTimeout(()=>{B||q||eg()},300)})},className:"text-green-600 hover:text-green-900 mr-3",children:(0,r.jsx)(m.qU,{className:"h-5 w-5"})}),(0,r.jsx)("button",{onClick:()=>ei(e),className:"text-red-600 hover:text-red-900",children:(0,r.jsx)(m.d7,{className:"h-5 w-5"})})]})]},e.id)):(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:"6",className:"px-6 py-4 text-center text-sm text-black",children:"No customers found"})})})]})}),(0,r.jsx)("div",{className:"px-6 py-3 flex items-center justify-between border-t border-gray-200",children:(0,r.jsxs)("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[(0,r.jsx)("div",{children:(0,r.jsxs)("p",{className:"text-sm text-black",children:["Showing ",(0,r.jsx)("span",{className:"font-medium",children:e.length>0?(C-1)*_+1:0})," to ",(0,r.jsx)("span",{className:"font-medium",children:Math.min(C*_,E*_)})," of"," ",(0,r.jsx)("span",{className:"font-medium",children:E*_})," results"]})}),(0,r.jsx)("div",{children:(0,r.jsxs)("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[(0,r.jsxs)("button",{onClick:()=>eo(C-1),disabled:1===C,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-black hover:bg-gray-50 ".concat(1===C?"opacity-50 cursor-not-allowed":""),children:[(0,r.jsx)("span",{className:"sr-only",children:"Previous"}),(0,r.jsx)("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})})]}),[...Array(E)].map((e,t)=>(0,r.jsx)("button",{onClick:()=>eo(t+1),className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium ".concat(C===t+1?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white text-black hover:bg-gray-50"),children:t+1},t)),(0,r.jsxs)("button",{onClick:()=>eo(C+1),disabled:C===E,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-black hover:bg-gray-50 ".concat(C===E?"opacity-50 cursor-not-allowed":""),children:[(0,r.jsx)("span",{className:"sr-only",children:"Next"}),(0,r.jsx)("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})})]})]})})]})})]}),(0,r.jsxs)(d.lG,{open:A,onClose:ed,className:"relative z-50",children:[(0,r.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,r.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,r.jsxs)(d.lG.Panel,{className:"mx-auto max-w-md rounded-lg bg-white p-6 shadow-xl",children:[(0,r.jsx)(d.lG.Title,{className:"text-lg font-medium text-black mb-4",children:"Delete Customer"}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("p",{className:"text-sm text-black",children:"Are you sure you want to delete this customer? This action cannot be undone and all associated data will be permanently removed."})}),(0,r.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,r.jsx)("button",{onClick:ed,className:"px-4 py-2 border border-gray-300 rounded-md text-black bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),(0,r.jsx)("button",{onClick:ec,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Delete"})]})]})})]}),(0,r.jsxs)(d.lG,{open:P,onClose:em,className:"relative z-50",children:[(0,r.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,r.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,r.jsxs)(d.lG.Panel,{className:"mx-auto max-w-2xl w-full rounded-lg bg-white p-6 shadow-xl overflow-y-auto max-h-[90vh]",children:[(0,r.jsx)(d.lG.Title,{className:"text-lg font-medium text-black mb-4",children:"Create New Customer"}),z?(0,r.jsx)("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4",children:(0,r.jsx)("p",{children:"Customer created successfully!"})}):null,L?(0,r.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:(0,r.jsx)("p",{children:L})}):null,(0,r.jsxs)("form",{onSubmit:ex,children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"customerName",className:"block text-sm font-medium text-black mb-1",children:"Business Name"}),(0,r.jsx)("input",{id:"customerName",name:"customerName",type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",value:T.customerName,onChange:eu})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-black mb-1",children:"Email Address"}),(0,r.jsx)("input",{id:"email",name:"email",type:"email",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",value:T.email,onChange:eu})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"first_name",className:"block text-sm font-medium text-black mb-1",children:"First Name"}),(0,r.jsx)("input",{id:"first_name",name:"first_name",type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",value:T.first_name,onChange:eu})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"last_name",className:"block text-sm font-medium text-black mb-1",children:"Last Name"}),(0,r.jsx)("input",{id:"last_name",name:"last_name",type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",value:T.last_name,onChange:eu})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"phone",className:"block text-sm font-medium text-black mb-1",children:"Phone Number"}),(0,r.jsx)("input",{id:"phone",name:"phone",type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",value:T.phone,onChange:eu})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"website",className:"block text-sm font-medium text-black mb-1",children:"Website"}),(0,r.jsx)("input",{id:"website",name:"website",type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",value:T.website,onChange:eu})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"city",className:"block text-sm font-medium text-black mb-1",children:"City"}),(0,r.jsx)("input",{id:"city",name:"city",type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",value:T.city,onChange:eu})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"billingState",className:"block text-sm font-medium text-black mb-1",children:"State/Province"}),(0,r.jsx)("input",{id:"billingState",name:"billingState",type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",value:T.billingState,onChange:eu})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"billingCountry",className:"block text-sm font-medium text-black mb-1",children:"Country"}),(0,r.jsx)("input",{id:"billingCountry",name:"billingCountry",type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",value:T.billingCountry,onChange:eu})]})]}),(0,r.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,r.jsx)("button",{type:"button",onClick:em,className:"px-4 py-2 border border-gray-300 rounded-md text-black bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",disabled:U,children:"Cancel"}),(0,r.jsx)("button",{type:"submit",className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 flex items-center",disabled:U,children:U?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"animate-spin h-4 w-4 mr-2 border-t-2 border-b-2 border-white rounded-full"}),"Creating..."]}):"Create Customer"})]})]})]})})]}),(0,r.jsxs)(d.lG,{open:w,onClose:eh,className:"relative z-50",children:[(0,r.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,r.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,r.jsxs)(d.lG.Panel,{className:"mx-auto max-w-3xl w-full rounded-lg bg-white p-6 shadow-xl overflow-y-auto max-h-[90vh]",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)(d.lG.Title,{className:"text-xl font-medium text-black",children:H?"Edit Customer":"Customer Details"}),(0,r.jsx)("button",{onClick:eh,className:"text-gray-500 hover:text-gray-700",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),B&&(0,r.jsxs)("div",{className:"flex justify-center items-center py-10",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-blue-500"}),(0,r.jsx)("p",{className:"ml-3 text-gray-600",children:"Loading customer details..."})]}),q&&(0,r.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:[(0,r.jsx)("p",{children:q.message}),(0,r.jsx)("button",{className:"mt-2 bg-red-600 hover:bg-red-700 text-white font-bold py-1 px-3 rounded text-sm",onClick:()=>eb(j),children:"Try Again"})]}),ee&&(0,r.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:(0,r.jsx)("p",{children:ee})}),es&&(0,r.jsx)("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4",children:(0,r.jsx)("p",{children:"Customer updated successfully!"})}),W&&!H&&(0,r.jsxs)("div",{children:[W._isFallback&&(0,r.jsxs)("div",{className:"bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded mb-4",children:[(0,r.jsx)("p",{className:"font-medium",children:"Limited Data Available"}),(0,r.jsxs)("p",{className:"mt-1",children:["AbortError"===W._errorName?"Request timed out while connecting to the API server.":"Unable to connect to the customer details API. ".concat(W._errorStatus?"(Error ".concat(W._errorStatus,")"):""),W._errorMessage&&!W._errorMessage.includes("undefined")&&(0,r.jsx)("span",{className:"block mt-1 text-xs font-mono bg-yellow-50 p-1 rounded",children:W._errorMessage})]}),(0,r.jsxs)("p",{className:"mt-2",children:["Showing limited customer information from the listing. You can"," ",(0,r.jsx)("button",{className:"text-blue-600 underline font-medium",onClick:()=>ey(j.id),children:"try again"})," or continue with the basic information."]})]}),(0,r.jsxs)("div",{className:"mb-6 pb-4 border-b border-gray-200",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-black",children:W.customerName||W.business_name||"".concat(W.first_name||""," ").concat(W.last_name||"")}),(W.customerName||W.business_name)&&(W.first_name||W.last_name)&&(0,r.jsxs)("p",{className:"text-gray-600 mt-1",children:["Primary Contact: ",W.first_name||""," ",W.last_name||""]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-black mb-3",children:"Contact Information"}),(0,r.jsxs)("div",{className:"space-y-2",children:[W.email&&(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("span",{className:"text-gray-500 w-24",children:"Email:"}),(0,r.jsx)("a",{href:"mailto:".concat(W.email),className:"text-blue-600 hover:underline",children:W.email})]}),W.phone&&(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("span",{className:"text-gray-500 w-24",children:"Phone:"}),(0,r.jsx)("a",{href:"tel:".concat(W.phone),className:"text-blue-600 hover:underline",children:W.phone})]}),W.website&&(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("span",{className:"text-gray-500 w-24",children:"Website:"}),(0,r.jsx)("a",{href:W.website,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:W.website})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-black mb-3",children:"Location"}),(0,r.jsxs)("div",{className:"space-y-2",children:[W.address&&(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("span",{className:"text-gray-500 w-24",children:"Address:"}),(0,r.jsx)("span",{children:W.address})]}),W.city&&(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("span",{className:"text-gray-500 w-24",children:"City:"}),(0,r.jsx)("span",{children:W.city})]}),W.billingState&&(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("span",{className:"text-gray-500 w-24",children:"State:"}),(0,r.jsx)("span",{children:W.billingState})]}),W.billingCountry&&(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("span",{className:"text-gray-500 w-24",children:"Country:"}),(0,r.jsx)("span",{children:W.billingCountry})]}),W.postalCode&&(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("span",{className:"text-gray-500 w-24",children:"Postal Code:"}),(0,r.jsx)("span",{children:W.postalCode})]})]})]})]}),W.notes&&(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-black mb-3",children:"Notes"}),(0,r.jsx)("p",{className:"text-gray-700 whitespace-pre-line",children:W.notes})]}),(0,r.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,r.jsx)("button",{onClick:eg,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:"Edit Customer"}),(0,r.jsx)("button",{onClick:()=>{eh(),ei(j)},className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Delete Customer"})]})]}),W&&H&&(0,r.jsxs)("form",{onSubmit:ep,children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"edit-customerName",className:"block text-sm font-medium text-black mb-1",children:"Business Name"}),(0,r.jsx)("input",{id:"edit-customerName",name:"customerName",type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",value:$.customerName||"",onChange:ef})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"edit-email",className:"block text-sm font-medium text-black mb-1",children:"Email Address"}),(0,r.jsx)("input",{id:"edit-email",name:"email",type:"email",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",value:$.email||"",onChange:ef})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"edit-first_name",className:"block text-sm font-medium text-black mb-1",children:"First Name"}),(0,r.jsx)("input",{id:"edit-first_name",name:"first_name",type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",value:$.first_name||"",onChange:ef})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"edit-last_name",className:"block text-sm font-medium text-black mb-1",children:"Last Name"}),(0,r.jsx)("input",{id:"edit-last_name",name:"last_name",type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",value:$.last_name||"",onChange:ef})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"edit-phone",className:"block text-sm font-medium text-black mb-1",children:"Phone Number"}),(0,r.jsx)("input",{id:"edit-phone",name:"phone",type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",value:$.phone||"",onChange:ef})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"edit-website",className:"block text-sm font-medium text-black mb-1",children:"Website"}),(0,r.jsx)("input",{id:"edit-website",name:"website",type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",value:$.website||"",onChange:ef})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"edit-address",className:"block text-sm font-medium text-black mb-1",children:"Address"}),(0,r.jsx)("input",{id:"edit-address",name:"address",type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",value:$.address||"",onChange:ef})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"edit-city",className:"block text-sm font-medium text-black mb-1",children:"City"}),(0,r.jsx)("input",{id:"edit-city",name:"city",type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",value:$.city||"",onChange:ef})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"edit-billingState",className:"block text-sm font-medium text-black mb-1",children:"State/Province"}),(0,r.jsx)("input",{id:"edit-billingState",name:"billingState",type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",value:$.billingState||"",onChange:ef})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"edit-billingCountry",className:"block text-sm font-medium text-black mb-1",children:"Country"}),(0,r.jsx)("input",{id:"edit-billingCountry",name:"billingCountry",type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",value:$.billingCountry||"",onChange:ef})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"edit-postalCode",className:"block text-sm font-medium text-black mb-1",children:"Postal Code"}),(0,r.jsx)("input",{id:"edit-postalCode",name:"postalCode",type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",value:$.postalCode||"",onChange:ef})]})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{htmlFor:"edit-notes",className:"block text-sm font-medium text-black mb-1",children:"Notes"}),(0,r.jsx)("textarea",{id:"edit-notes",name:"notes",rows:"4",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",value:$.notes||"",onChange:ef})]}),(0,r.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,r.jsx)("button",{type:"button",onClick:eg,className:"px-4 py-2 border border-gray-300 rounded-md text-black bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",disabled:Q,children:"Cancel"}),(0,r.jsx)("button",{type:"submit",className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 flex items-center",disabled:Q,children:Q?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"animate-spin h-4 w-4 mr-2 border-t-2 border-b-2 border-white rounded-full"}),"Updating..."]}):"Save Changes"})]})]})]})})]})]})}}}]);