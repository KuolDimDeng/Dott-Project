"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[937,32060],{937:(e,t,a)=>{a.r(t),a.d(t,{default:()=>c});var s=a(55166),l=a(68387),r=a(95155),i=a(12115),d=a(80561),n=a(29729);a(87449);let c=()=>{let[e,t]=(0,i.useState)([]),[a,c]=(0,i.useState)([]),[o,m]=(0,i.useState)(null),[p,x]=(0,i.useState)({startDate:null,endDate:null,user:"",actionType:"",transactionType:""});(0,i.useEffect)(()=>{u()},[]),(0,i.useEffect)(()=>{h()},[e,p]);let u=async()=>{try{let e=await n.SP.get("/api/finance/audit-trail/");t(e.data)}catch(e){console.error("Error fetching audit trails:",e)}},h=()=>{let t=e;p.startDate&&(t=t.filter(e=>new Date(e.date_time)>=p.startDate)),p.endDate&&(t=t.filter(e=>new Date(e.date_time)<=p.endDate)),p.user&&(t=t.filter(e=>e.user_name.toLowerCase().includes(p.user.toLowerCase()))),p.actionType&&(t=t.filter(e=>e.action_type===p.actionType)),p.transactionType&&(t=t.filter(e=>e.transaction_type.toLowerCase().includes(p.transactionType.toLowerCase()))),c(t)},y=(e,t)=>{x((0,l._)((0,s._)({},p),{[e]:t}))},g=e=>{m(e)},f=e=>e?new Date(e).toISOString().split("T")[0]:"";return(0,r.jsx)("div",{className:"bg-white p-6 rounded-lg shadow",children:(0,r.jsxs)("div",{className:"w-full",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"Audit Trail Management"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-6 gap-4 mb-6",children:[(0,r.jsxs)("div",{className:"md:col-span-1",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),(0,r.jsx)("input",{type:"date",className:"w-full p-2 border border-gray-300 rounded-md",value:f(p.startDate),onChange:e=>y("startDate",e.target.value?new Date(e.target.value):null)})]}),(0,r.jsxs)("div",{className:"md:col-span-1",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),(0,r.jsx)("input",{type:"date",className:"w-full p-2 border border-gray-300 rounded-md",value:f(p.endDate),onChange:e=>y("endDate",e.target.value?new Date(e.target.value):null)})]}),(0,r.jsxs)("div",{className:"md:col-span-1",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"User"}),(0,r.jsx)("input",{type:"text",className:"w-full p-2 border border-gray-300 rounded-md",value:p.user,onChange:e=>y("user",e.target.value),placeholder:"Filter by user"})]}),(0,r.jsxs)("div",{className:"md:col-span-1",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Action Type"}),(0,r.jsxs)("select",{className:"w-full p-2 border border-gray-300 rounded-md bg-white",value:p.actionType,onChange:e=>y("actionType",e.target.value),children:[(0,r.jsx)("option",{value:"",children:"All"}),(0,r.jsx)("option",{value:"create",children:"Create"}),(0,r.jsx)("option",{value:"modify",children:"Modify"}),(0,r.jsx)("option",{value:"delete",children:"Delete"}),(0,r.jsx)("option",{value:"approve",children:"Approve"})]})]}),(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Transaction Type"}),(0,r.jsx)("input",{type:"text",className:"w-full p-2 border border-gray-300 rounded-md",value:p.transactionType,onChange:e=>y("transactionType",e.target.value),placeholder:"Filter by transaction type"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,r.jsx)("div",{className:"md:col-span-2",children:(0,r.jsx)("div",{className:"overflow-x-auto rounded-lg border border-gray-200",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date & Time"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Transaction ID"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Transaction Type"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:a.length>0?a.map(e=>(0,r.jsxs)("tr",{onClick:()=>g(e),className:"hover:bg-gray-50 cursor-pointer",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(e.date_time).toLocaleString()}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.user_name}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.action_type}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.transaction_id}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.transaction_type})]},e.id)):(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:5,className:"px-6 py-4 text-center text-sm text-gray-500",children:"No audit trail records found"})})})]})})}),(0,r.jsx)("div",{className:"md:col-span-1",children:o?(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,r.jsx)("h3",{className:"text-lg font-medium mb-3",children:"Audit Trail Details"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("p",{className:"text-sm",children:[(0,r.jsx)("span",{className:"font-semibold",children:"Date & Time:"})," ",new Date(o.date_time).toLocaleString()]}),(0,r.jsxs)("p",{className:"text-sm",children:[(0,r.jsx)("span",{className:"font-semibold",children:"User:"})," ",o.user_name]}),(0,r.jsxs)("p",{className:"text-sm",children:[(0,r.jsx)("span",{className:"font-semibold",children:"Action:"})," ",o.action_type]}),(0,r.jsxs)("p",{className:"text-sm",children:[(0,r.jsx)("span",{className:"font-semibold",children:"Transaction ID:"})," ",o.transaction_id]}),(0,r.jsxs)("p",{className:"text-sm",children:[(0,r.jsx)("span",{className:"font-semibold",children:"Transaction Type:"})," ",o.transaction_type]}),(0,r.jsxs)("p",{className:"text-sm",children:[(0,r.jsx)("span",{className:"font-semibold",children:"Affected Accounts:"})," ",o.affected_accounts]}),(0,r.jsxs)("p",{className:"text-sm",children:[(0,r.jsx)("span",{className:"font-semibold",children:"Old Value:"})," ",o.old_value]}),(0,r.jsxs)("p",{className:"text-sm",children:[(0,r.jsx)("span",{className:"font-semibold",children:"New Value:"})," ",o.new_value]}),(0,r.jsxs)("p",{className:"text-sm",children:[(0,r.jsx)("span",{className:"font-semibold",children:"Approval Status:"})," ",o.approval_status]}),(0,r.jsxs)("p",{className:"text-sm",children:[(0,r.jsx)("span",{className:"font-semibold",children:"Notes:"})," ",o.notes]}),(0,r.jsxs)("p",{className:"text-sm",children:[(0,r.jsx)("span",{className:"font-semibold",children:"IP Address:"})," ",o.ip_address]}),(0,r.jsxs)("p",{className:"text-sm",children:[(0,r.jsx)("span",{className:"font-semibold",children:"Module:"})," ",o.module]})]})]}):(0,r.jsx)("div",{className:"flex h-full items-center justify-center p-6 bg-gray-50 rounded-lg border border-gray-200",children:(0,r.jsx)("p",{className:"text-gray-500",children:"Select an audit trail entry to view details"})})})]}),(0,r.jsxs)("div",{className:"mt-8",children:[(0,r.jsx)("h3",{className:"text-xl font-medium mb-4",children:"Activity Summary"}),(0,r.jsx)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:(()=>{let e={labels:["Create","Modify","Delete","Approve"],datasets:[{label:"Action Types",data:[a.filter(e=>"create"===e.action_type).length,a.filter(e=>"modify"===e.action_type).length,a.filter(e=>"delete"===e.action_type).length,a.filter(e=>"approve"===e.action_type).length],backgroundColor:"rgba(75,192,192,0.6)"}]};return(0,r.jsx)(d.yP,{data:e,options:{scales:{y:{beginAtZero:!0,title:{display:!0,text:"Number of Actions"}}}}})})()})]}),(0,r.jsx)("div",{className:"mt-8",children:(0,r.jsx)("button",{type:"button",onClick:()=>console.log("Export functionality to be implemented"),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Export Audit Trail"})})]})})}},32060:(e,t,a)=>{a.r(t),a.d(t,{ArcElement:()=>u,BarController:()=>r,BarElement:()=>y,BubbleController:()=>c,CategoryScale:()=>f,Chart:()=>s,DoughnutController:()=>d,Filler:()=>C,Legend:()=>w,LineController:()=>l,LineElement:()=>h,LinearScale:()=>b,PieController:()=>o,PointElement:()=>g,PolarAreaController:()=>n,RadarController:()=>i,RadialLinearScale:()=>j,Scale:()=>x,ScatterController:()=>m,TimeScale:()=>N,Title:()=>_,Tooltip:()=>v,default:()=>D,register:()=>p,registerables:()=>T});class s{destroy(){}update(){}render(){}stop(){}resize(){}clear(){}toBase64Image(){return""}getElementsAtEventForMode(){return[]}getDatasetMeta(){return{}}constructor(){this.type="line",this.data={},this.options={}}}let l={id:"line",defaults:{}},r={id:"bar",defaults:{}},i={id:"radar",defaults:{}},d={id:"doughnut",defaults:{}},n={id:"polarArea",defaults:{}},c={id:"bubble",defaults:{}},o={id:"pie",defaults:{}},m={id:"scatter",defaults:{}};function p(){}let x={extend:()=>{}},u={id:"arc",defaults:{}},h={id:"line",defaults:{}},y={id:"bar",defaults:{}},g={id:"point",defaults:{}},f={id:"category",defaults:{}},b={id:"linear",defaults:{}},j={id:"radialLinear",defaults:{}},N={id:"time",defaults:{}},v={id:"tooltip",defaults:{},positioners:{}},w={id:"legend",defaults:{}},_={id:"title",defaults:{}},C={id:"filler",defaults:{}},T=[u,h,y,g,f,b,j,N,v,w,_],D=s},80561:(e,t,a)=>{a.d(t,{Fq:()=>m,N1:()=>n,nu:()=>o,yP:()=>c});var s=a(55166),l=a(36465),r=a(95155);a(12115);var i=a(32060);let d=e=>{var{type:t,height:a="300px",width:s="100%"}=e;return(0,l._)(e,["type","height","width"]),(0,r.jsx)("div",{style:{height:a,width:s,backgroundColor:"#f5f5f5",border:"1px solid #ddd",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem"},children:(0,r.jsxs)("div",{style:{textAlign:"center"},children:[(0,r.jsxs)("div",{style:{fontWeight:"bold",marginBottom:"0.5rem"},children:[t.charAt(0).toUpperCase()+t.slice(1)," Chart"]}),(0,r.jsx)("div",{style:{fontSize:"0.8rem",color:"#666"},children:"(Chart rendering disabled)"})]})})},n=e=>(0,r.jsx)(d,(0,s._)({type:"line"},e)),c=e=>(0,r.jsx)(d,(0,s._)({type:"bar"},e)),o=e=>(0,r.jsx)(d,(0,s._)({type:"doughnut"},e)),m=e=>(0,r.jsx)(d,(0,s._)({type:"pie"},e));e=>(0,r.jsx)(d,(0,s._)({type:"radar"},e)),i.default}}]);