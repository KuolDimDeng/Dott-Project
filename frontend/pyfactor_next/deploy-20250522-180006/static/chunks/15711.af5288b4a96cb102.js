"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[15711],{15711:(e,t,s)=>{s.r(t),s.d(t,{default:()=>m});var a=s(55166),r=s(68387),l=s(95155),i=s(12115),n=s(66352),d=s(62376),o=s(42749),c=s(51174);let m=()=>{let[e,t]=(0,i.useState)("employee-select"),[s,m]=(0,i.useState)(!1),[x,u]=(0,i.useState)([]),[p,h]=(0,i.useState)(null),[f,g]=(0,i.useState)([]),[y,b]=(0,i.useState)([]),[j,w]=(0,i.useState)(""),[v,N]=(0,i.useState)(null),[_,F]=(0,i.useState)(!1),[k,S]=(0,i.useState)({form_type:"W4",tax_year:new Date().getFullYear(),filing_status:"single",employee_id:"",state_code:"",is_verified:!1,submission_date:new Date().toISOString().split("T")[0]}),T=e=>n.oR.success(e),C=e=>n.oR.error(e);(0,i.useEffect)(()=>{E(),W()},[]);let E=async()=>{m(!0);try{let e=(0,c.jW)();o.vF.info("[TaxManagement] Fetching employees with tenant ID:",e),o.vF.info("[TaxManagement] Search query:",j||"none");let t=await d.Rz.getAll({tenant:e,q:j,include_inactive:!0,bypassCache:!0,_t:Date.now()});t&&t.data?(o.vF.info("[TaxManagement] Found ".concat(t.data.length," employees")),u(t.data)):Array.isArray(t)?(o.vF.info("[TaxManagement] Found ".concat(t.length," employees (direct array response)")),u(t)):(o.vF.warn("[TaxManagement] No employee data found in response:",t),u([]),C("No employees found. Please make sure employees exist in the system."))}catch(e){o.vF.error("[TaxManagement] Error fetching employees:",e),C("Failed to fetch employees: ".concat(e.message)),u([])}finally{m(!1)}},W=async()=>{try{let e=(0,c.jW)(),t=await d.gw.getStates({tenant:e});t.data?b(t.data):b([])}catch(e){o.vF.error("Error fetching states:",e),C("Failed to fetch states"),b([])}},D=async e=>{m(!0);try{let t=(0,c.jW)(),s=await d.gw.getFormsByEmployee(e,{tenant:t});s.data?g(s.data):g([])}catch(e){o.vF.error("Error fetching tax forms:",e),C("Failed to fetch tax forms"),g([])}finally{m(!1)}},M=e=>{h(e),S((0,r._)((0,a._)({},k),{employee_id:e.id})),D(e.id),t("tax-forms")},A=()=>{E()},P=e=>{let{name:t,value:s,type:l,checked:i}=e.target;S((0,r._)((0,a._)({},k),{[t]:"checkbox"===l?i:s}))},R=async e=>{if(e.preventDefault(),!k.employee_id)return void C("Please select an employee");if(!k.form_type||!k.tax_year)return void C("Please fill out all required fields");m(!0);try{let e=(0,c.jW)(),t=new FormData;Object.keys(k).forEach(e=>{t.append(e,k[e])}),t.append("tenant",e),v&&t.append("file",v),await d.gw.createForm(t,{headers:{"Content-Type":"multipart/form-data"}}),T("Tax form added successfully"),D(k.employee_id),F(!1),q()}catch(e){o.vF.error("Error submitting tax form:",e),C("Failed to submit tax form")}finally{m(!1)}},I=async e=>{if(window.confirm("Are you sure you want to delete this tax form?")){m(!0);try{await d.gw.deleteForm(e),T("Tax form deleted successfully"),D(p.id)}catch(e){o.vF.error("Error deleting tax form:",e),C("Failed to delete tax form")}finally{m(!1)}}},L=async e=>{m(!0);try{await d.gw.verifyForm(e),T("Tax form verified successfully"),D(p.id)}catch(e){o.vF.error("Error verifying tax form:",e),C("Failed to verify tax form")}finally{m(!1)}},O=async(e,t,s)=>{try{let a=await d.gw.downloadForm(e),r=new Blob([a.data],{type:"application/pdf"}),l=window.URL.createObjectURL(r),i=document.createElement("a");i.href=l,i.download="".concat(t,"_").concat(s,"_").concat(p.last_name,".pdf"),document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(l),document.body.removeChild(i)}catch(e){o.vF.error("Error downloading tax form:",e),C("Failed to download tax form")}},q=()=>{S({form_type:"W4",tax_year:new Date().getFullYear(),filing_status:"single",employee_id:p?p.id:"",state_code:"",is_verified:!1,submission_date:new Date().toISOString().split("T")[0]}),N(null)};return(0,l.jsxs)("div",{className:"p-4",children:[s&&(0,l.jsx)(()=>(0,l.jsx)("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50",children:(0,l.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-lg flex items-center space-x-3",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),(0,l.jsx)("p",{children:"Loading..."})]})}),{}),(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold",children:"Tax Management"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Manage employee tax information and forms"})]}),"employee-select"===e?(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Select Employee"}),(0,l.jsxs)("div",{className:"mb-6 flex",children:[(0,l.jsx)("input",{type:"text",placeholder:"Search employees...",className:"flex-grow px-4 py-2 border border-gray-300 rounded-l-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:j,onChange:e=>{w(e.target.value)},onKeyPress:e=>"Enter"===e.key&&A()}),(0,l.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-r-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:A,disabled:s,children:s?"Searching...":"Search"})]}),(0,l.jsx)("div",{className:"border rounded-md overflow-hidden",children:(0,l.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,l.jsx)("thead",{className:"bg-gray-50",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Position"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,l.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:x.length>0?x.map(e=>(0,l.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,l.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,l.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:[e.first_name," ",e.last_name]}),(0,l.jsx)("div",{className:"text-sm text-gray-500",children:e.email})]}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.employee_number}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.job_title||"Not specified"}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,l.jsx)("button",{className:"text-blue-600 hover:text-blue-900 mr-3",onClick:()=>M(e),children:"Select"})})]},e.id)):(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:"4",className:"px-6 py-4 text-center text-sm text-gray-500",children:s?"Loading employees...":"No employees found"})})})]})})]}):"tax-forms"===e&&p?(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("h2",{className:"text-xl font-semibold",children:["Tax Forms for ",p.first_name," ",p.last_name]}),(0,l.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Employee ID: ",p.employee_number]})]}),(0,l.jsxs)("div",{className:"flex gap-3",children:[(0,l.jsx)("button",{className:"px-4 py-2 bg-gray-100 text-gray-800 rounded hover:bg-gray-200",onClick:()=>t("employee-select"),children:"Back to Employees"}),(0,l.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",onClick:()=>F(!0),children:"Add Tax Form"})]})]}),(0,l.jsx)("div",{className:"border rounded-md overflow-hidden",children:(0,l.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,l.jsx)("thead",{className:"bg-gray-50",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tax Year"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Filing Status"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"State"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Verified"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,l.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:f.length>0?f.map(e=>(0,l.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.form_type}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.tax_year}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.filing_status}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.state_code||"Federal"}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,l.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(e.is_verified?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:e.is_verified?"Verified":"Not Verified"})}),(0,l.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[e.file&&(0,l.jsx)("button",{className:"text-indigo-600 hover:text-indigo-900 mr-3",onClick:()=>O(e.id,e.form_type,e.tax_year),children:"Download"}),!e.is_verified&&(0,l.jsx)("button",{className:"text-green-600 hover:text-green-900 mr-3",onClick:()=>L(e.id),children:"Verify"}),(0,l.jsx)("button",{className:"text-red-600 hover:text-red-900",onClick:()=>I(e.id),children:"Delete"})]})]},e.id)):(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:"6",className:"px-6 py-4 text-center text-sm text-gray-500",children:s?"Loading tax forms...":"No tax forms found for this employee"})})})]})}),_&&(0,l.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:(0,l.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,l.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true"}),(0,l.jsx)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:(0,l.jsxs)("form",{onSubmit:R,children:[(0,l.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,l.jsx)("div",{className:"sm:flex sm:items-start",children:(0,l.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full",children:[(0,l.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",id:"modal-title",children:"Add Tax Form"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 gap-4 mb-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Form Type ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsxs)("select",{name:"form_type",value:k.form_type,onChange:P,className:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",required:!0,children:[(0,l.jsx)("option",{value:"W2",children:"W-2 Wage and Tax Statement"}),(0,l.jsx)("option",{value:"W4",children:"W-4 Employee Withholding Certificate"}),(0,l.jsx)("option",{value:"1099",children:"1099-MISC Miscellaneous Income"}),(0,l.jsx)("option",{value:"1095C",children:"1095-C Employer-Provided Health Insurance"}),(0,l.jsx)("option",{value:"940",children:"Form 940 Federal Unemployment Tax"}),(0,l.jsx)("option",{value:"941",children:"Form 941 Quarterly Federal Tax Return"}),(0,l.jsx)("option",{value:"STATE_WH",children:"State Withholding Form"}),(0,l.jsx)("option",{value:"OTHER",children:"Other Tax Form"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tax Year ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsx)("input",{type:"number",name:"tax_year",value:k.tax_year,onChange:P,className:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",required:!0,min:"2020",max:"2050"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Filing Status"}),(0,l.jsxs)("select",{name:"filing_status",value:k.filing_status,onChange:P,className:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[(0,l.jsx)("option",{value:"single",children:"Single"}),(0,l.jsx)("option",{value:"married_joint",children:"Married Filing Jointly"}),(0,l.jsx)("option",{value:"married_separate",children:"Married Filing Separately"}),(0,l.jsx)("option",{value:"head_household",children:"Head of Household"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"State (if applicable)"}),(0,l.jsxs)("select",{name:"state_code",value:k.state_code,onChange:P,className:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[(0,l.jsx)("option",{value:"",children:"Federal (No State)"}),y.map(e=>(0,l.jsxs)("option",{value:e.code,children:[e.name," (",e.code,")"]},e.code))]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Form File"}),(0,l.jsx)("input",{type:"file",accept:".pdf,.jpg,.png",onChange:e=>{N(e.target.files[0])},className:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"}),(0,l.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Accepted formats: PDF, JPG, PNG"})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"checkbox",name:"is_verified",checked:k.is_verified,onChange:P,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,l.jsx)("label",{className:"ml-2 block text-sm text-gray-900",children:"Mark as verified"})]})]})]})})}),(0,l.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,l.jsx)("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",disabled:s,children:s?"Submitting...":"Add Form"}),(0,l.jsx)("button",{type:"button",className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",onClick:()=>F(!1),children:"Cancel"})]})]})})]})})]}):(0,l.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6 text-center",children:(0,l.jsx)("p",{children:"Please select an option to continue"})})]})}}}]);