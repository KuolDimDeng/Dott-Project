<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Settings - Dott</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #f3f4f6;
            min-height: 100vh;
            padding-bottom: 60px;
        }
        
        .header {
            background: white;
            padding: 16px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 12px;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .back-button {
            width: 40px;
            height: 40px;
            border: none;
            background: #f3f4f6;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        
        .back-button:active {
            background: #e5e7eb;
        }
        
        .header-title {
            flex: 1;
            font-size: 20px;
            font-weight: 600;
            color: #111827;
        }
        
        .content {
            padding: 16px;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-top: 8px;
        }
        
        .settings-item {
            background: white;
            border-radius: 12px;
            padding: 16px 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 2px solid transparent;
            text-decoration: none;
            color: inherit;
            min-height: 100px;
            justify-content: center;
        }
        
        .settings-item:active {
            transform: scale(0.98);
            background: #f9fafb;
        }
        
        .settings-item:hover {
            border-color: #3b82f6;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
        }
        
        .settings-icon {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            background: #f3f4f6;
        }
        
        .settings-icon svg {
            width: 20px;
            height: 20px;
        }
        
        /* Icon colors */
        .icon-business { background: #dbeafe; color: #2563eb; }
        .icon-users { background: #fce7f3; color: #ec4899; }
        .icon-permissions { background: #e9d5ff; color: #9333ea; }
        .icon-banking { background: #d1fae5; color: #10b981; }
        .icon-currency { background: #fed7aa; color: #ea580c; }
        .icon-geofencing { background: #bfdbfe; color: #3b82f6; }
        .icon-billing { background: #fef3c7; color: #f59e0b; }
        .icon-integrations { background: #e0e7ff; color: #6366f1; }
        .icon-security { background: #fee2e2; color: #ef4444; }
        
        .settings-label {
            font-size: 13px;
            font-weight: 500;
            color: #374151;
            text-align: center;
        }
        
        .section-title {
            font-size: 14px;
            font-weight: 600;
            color: #6b7280;
            margin-top: 24px;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .user-info {
            background: white;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .user-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
            font-weight: 600;
        }
        
        .user-details {
            flex: 1;
        }
        
        .user-name {
            font-size: 16px;
            font-weight: 600;
            color: #111827;
        }
        
        .user-email {
            font-size: 14px;
            color: #6b7280;
        }
        
        .user-role {
            display: inline-block;
            padding: 2px 8px;
            background: #dbeafe;
            color: #1e40af;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            margin-top: 4px;
        }
        
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            border-top: 1px solid #e5e7eb;
            padding: 8px;
            display: flex;
            justify-content: space-around;
        }
        
        .nav-item {
            flex: 1;
            padding: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            border: none;
            background: none;
            color: #9ca3af;
            font-size: 11px;
            cursor: pointer;
        }
        
        .nav-item.active {
            color: #3b82f6;
        }
        
        .nav-icon {
            width: 24px;
            height: 24px;
        }

        @media (max-width: 360px) {
            .settings-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <button class="back-button" onclick="goBack()">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="24" height="24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
            </svg>
        </button>
        <h1 class="header-title">Settings</h1>
    </div>
    
    <div class="content">
        <!-- User Profile Section -->
        <div class="user-info">
            <div class="user-avatar" id="userAvatar">KD</div>
            <div class="user-details">
                <div class="user-name" id="userName">Loading...</div>
                <div class="user-email" id="userEmail">Loading...</div>
                <span class="user-role" id="userRole">OWNER</span>
            </div>
        </div>
        
        <!-- Main Settings Grid -->
        <div class="section-title">General Settings</div>
        <div class="settings-grid">
            <!-- Business -->
            <div class="settings-item" onclick="navigateToSetting('business')">
                <div class="settings-icon icon-business">
                    <svg fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 7V3H2v18h20V7H12zM6 19H4v-2h2v2zm0-4H4v-2h2v2zm0-4H4V9h2v2zm0-4H4V5h2v2zm4 12H8v-2h2v2zm0-4H8v-2h2v2zm0-4H8V9h2v2zm0-4H8V5h2v2zm10 12h-8v-2h2v-2h-2v-2h2v-2h-2V9h8v10zm-2-8h-2v2h2v-2zm0 4h-2v2h2v-2z"/>
                    </svg>
                </div>
                <span class="settings-label">Business</span>
            </div>
            
            <!-- Users -->
            <div class="settings-item" onclick="navigateToSetting('users')">
                <div class="settings-icon icon-users">
                    <svg fill="currentColor" viewBox="0 0 24 24">
                        <path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"/>
                    </svg>
                </div>
                <span class="settings-label">Users</span>
            </div>
            
            <!-- Permissions -->
            <div class="settings-item" onclick="navigateToSetting('permissions')">
                <div class="settings-icon icon-permissions">
                    <svg fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"/>
                    </svg>
                </div>
                <span class="settings-label">Permissions</span>
            </div>
            
            <!-- Banking -->
            <div class="settings-item" onclick="navigateToSetting('banking')">
                <div class="settings-icon icon-banking">
                    <svg fill="currentColor" viewBox="0 0 24 24">
                        <path d="M4 10v7h3v-7H4zm6 0v7h3v-7h-3zM2 22h19v-3H2v3zm14-12v7h3v-7h-3zm-4.5-9L2 6v2h19V6l-9.5-5z"/>
                    </svg>
                </div>
                <span class="settings-label">Banking</span>
            </div>
            
            <!-- Currency -->
            <div class="settings-item" onclick="navigateToSetting('currency')">
                <div class="settings-icon icon-currency">
                    <svg fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1.41 16.09V20h-2.67v-1.93c-1.71-.36-3.16-1.46-3.27-3.4h1.96c.1.81.45 1.61 1.67 1.61 1.16 0 1.6-.64 1.6-1.23 0-.62-.49-1.08-1.75-1.46-1.77-.52-3.26-1.36-3.26-3.08 0-1.64 1.29-2.79 3.02-3.18V6h2.67v1.38c1.51.4 2.59 1.56 2.68 3.04h-1.96c-.09-.72-.38-1.42-1.42-1.42-1.03 0-1.5.52-1.5 1.17 0 .57.42.88 1.67 1.25 1.76.51 3.37 1.19 3.37 3.33 0 1.84-1.36 2.93-3.31 3.34z"/>
                    </svg>
                </div>
                <span class="settings-label">Currency</span>
            </div>
            
            <!-- Geofencing -->
            <div class="settings-item" onclick="navigateToSetting('geofencing')">
                <div class="settings-icon icon-geofencing">
                    <svg fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
                    </svg>
                </div>
                <span class="settings-label">Geofencing</span>
            </div>
            
            <!-- Billing -->
            <div class="settings-item" onclick="navigateToSetting('billing')">
                <div class="settings-icon icon-billing">
                    <svg fill="currentColor" viewBox="0 0 24 24">
                        <path d="M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4v-6h16v6zm0-10H4V6h16v2z"/>
                    </svg>
                </div>
                <span class="settings-label">Billing</span>
            </div>
            
            <!-- Integrations -->
            <div class="settings-item" onclick="navigateToSetting('integrations')">
                <div class="settings-icon icon-integrations">
                    <svg fill="currentColor" viewBox="0 0 24 24">
                        <path d="M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm2 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
                    </svg>
                </div>
                <span class="settings-label">Integrations</span>
            </div>
            
            <!-- Security -->
            <div class="settings-item" onclick="navigateToSetting('security')">
                <div class="settings-icon icon-security">
                    <svg fill="currentColor" viewBox="0 0 24 24">
                        <path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"/>
                    </svg>
                </div>
                <span class="settings-label">Security</span>
            </div>
        </div>
        
        <!-- Additional Options -->
        <div class="section-title">Support</div>
        <div class="settings-grid">
            <div class="settings-item" onclick="navigateToSetting('help')">
                <div class="settings-icon" style="background: #f3f4f6; color: #6b7280;">
                    <svg fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"/>
                    </svg>
                </div>
                <span class="settings-label">Help</span>
            </div>
            
            <div class="settings-item" onclick="navigateToSetting('about')">
                <div class="settings-icon" style="background: #f3f4f6; color: #6b7280;">
                    <svg fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/>
                    </svg>
                </div>
                <span class="settings-label">About</span>
            </div>
            
            <div class="settings-item" onclick="logout()">
                <div class="settings-icon" style="background: #fee2e2; color: #ef4444;">
                    <svg fill="currentColor" viewBox="0 0 24 24">
                        <path d="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"/>
                    </svg>
                </div>
                <span class="settings-label">Logout</span>
            </div>
        </div>
    </div>
    
    <div class="bottom-nav">
        <button class="nav-item" onclick="navigateTo('mobile-menu.html')">
            <svg class="nav-icon" fill="currentColor" viewBox="0 0 24 24">
                <path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/>
            </svg>
            Menu
        </button>
        <button class="nav-item active">
            <svg class="nav-icon" fill="currentColor" viewBox="0 0 24 24">
                <path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"/>
            </svg>
            Settings
        </button>
    </div>
    
    <script>
        // Load user data from storage
        function loadUserData() {
            try {
                // Try secure storage first (for native app)
                if (window.SecureStoragePlugin) {
                    window.SecureStoragePlugin.get(
                        'user',
                        (userData) => {
                            if (userData) {
                                displayUserData(JSON.parse(userData));
                            }
                        },
                        (error) => {
                            // Fallback to localStorage
                            loadFromLocalStorage();
                        }
                    );
                } else {
                    // Use localStorage for web
                    loadFromLocalStorage();
                }
            } catch (e) {
                console.error('Error loading user data:', e);
                loadFromLocalStorage();
            }
        }
        
        function loadFromLocalStorage() {
            const storedUser = localStorage.getItem('user');
            if (storedUser) {
                displayUserData(JSON.parse(storedUser));
            }
        }
        
        function displayUserData(userData) {
            if (userData) {
                // Update user info
                document.getElementById('userName').textContent = userData.name || 'User';
                document.getElementById('userEmail').textContent = userData.email || '';
                document.getElementById('userRole').textContent = userData.role || 'USER';
                
                // Update avatar with initials
                const name = userData.name || userData.email || 'User';
                const initials = name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2);
                document.getElementById('userAvatar').textContent = initials;
            }
        }
        
        function navigateToSetting(setting) {
            console.log('Navigating to:', setting);
            
            // Map settings to their respective pages
            const settingPages = {
                'business': 'mobile-business-settings.html',
                'users': 'mobile-users-settings.html',
                'permissions': 'mobile-permissions-settings.html',
                'banking': 'mobile-banking-settings.html',
                'currency': 'mobile-currency-settings.html',
                'geofencing': 'mobile-geofencing-settings.html',
                'billing': 'mobile-billing-settings.html',
                'integrations': 'mobile-integrations-settings.html',
                'security': 'mobile-security-settings.html',
                'help': 'mobile-help.html',
                'about': 'mobile-about.html'
            };
            
            const page = settingPages[setting];
            if (page) {
                // For now, show a message since these pages don't exist yet
                // In production, you would navigate to the page
                // window.location.href = page;
                alert(`Navigate to ${setting} settings\n(Page: ${page})`);
            }
        }
        
        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                // Clear all storage
                localStorage.clear();
                sessionStorage.clear();
                
                // Clear secure storage if available
                if (window.SecureStoragePlugin) {
                    window.SecureStoragePlugin.clear(
                        () => console.log('Secure storage cleared'),
                        (error) => console.error('Error clearing secure storage:', error)
                    );
                }
                
                // Redirect to auth page
                window.location.href = 'mobile-auth.html';
            }
        }
        
        function goBack() {
            window.location.href = 'mobile-menu.html';
        }
        
        function navigateTo(page) {
            window.location.href = page;
        }
        
        // Load user data on page load
        document.addEventListener('DOMContentLoaded', loadUserData);
    </script>
</body>
</html>