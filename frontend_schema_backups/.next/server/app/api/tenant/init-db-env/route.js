/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/tenant/init-db-env/route";
exports.ids = ["app/api/tenant/init-db-env/route"];
exports.modules = {

/***/ "(rsc)/../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Ftenant%2Finit-db-env%2Froute&page=%2Fapi%2Ftenant%2Finit-db-env%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftenant%2Finit-db-env%2Froute.js&appDir=%2FUsers%2Fkuoldeng%2Fprojectx%2Ffrontend%2Fpyfactor_next%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fkuoldeng%2Fprojectx%2Ffrontend%2Fpyfactor_next&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Ftenant%2Finit-db-env%2Froute&page=%2Fapi%2Ftenant%2Finit-db-env%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftenant%2Finit-db-env%2Froute.js&appDir=%2FUsers%2Fkuoldeng%2Fprojectx%2Ffrontend%2Fpyfactor_next%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fkuoldeng%2Fprojectx%2Ffrontend%2Fpyfactor_next&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_kuoldeng_projectx_frontend_pyfactor_next_src_app_api_tenant_init_db_env_route_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/tenant/init-db-env/route.js */ \"(rsc)/./src/app/api/tenant/init-db-env/route.js\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/tenant/init-db-env/route\",\n        pathname: \"/api/tenant/init-db-env\",\n        filename: \"route\",\n        bundlePath: \"app/api/tenant/init-db-env/route\"\n    },\n    resolvedPagePath: \"/Users/kuoldeng/projectx/frontend/pyfactor_next/src/app/api/tenant/init-db-env/route.js\",\n    nextConfigOutput,\n    userland: _Users_kuoldeng_projectx_frontend_pyfactor_next_src_app_api_tenant_init_db_env_route_js__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL25leHRAMTUuMi4yX0BiYWJlbCtjb3JlQDcuMjYuMTBfcmVhY3QtZG9tQDE4LjMuMV9yZWFjdEAxOC4zLjEvbm9kZV9tb2R1bGVzL25leHQvZGlzdC9idWlsZC93ZWJwYWNrL2xvYWRlcnMvbmV4dC1hcHAtbG9hZGVyL2luZGV4LmpzP25hbWU9YXBwJTJGYXBpJTJGdGVuYW50JTJGaW5pdC1kYi1lbnYlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRnRlbmFudCUyRmluaXQtZGItZW52JTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGdGVuYW50JTJGaW5pdC1kYi1lbnYlMkZyb3V0ZS5qcyZhcHBEaXI9JTJGVXNlcnMlMkZrdW9sZGVuZyUyRnByb2plY3R4JTJGZnJvbnRlbmQlMkZweWZhY3Rvcl9uZXh0JTJGc3JjJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRmt1b2xkZW5nJTJGcHJvamVjdHglMkZmcm9udGVuZCUyRnB5ZmFjdG9yX25leHQmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQStGO0FBQ3ZDO0FBQ3FCO0FBQ3VDO0FBQ3BIO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix5R0FBbUI7QUFDM0M7QUFDQSxjQUFjLGtFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsc0RBQXNEO0FBQzlEO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQzBGOztBQUUxRiIsInNvdXJjZXMiOlsiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvVXNlcnMva3VvbGRlbmcvcHJvamVjdHgvZnJvbnRlbmQvcHlmYWN0b3JfbmV4dC9zcmMvYXBwL2FwaS90ZW5hbnQvaW5pdC1kYi1lbnYvcm91dGUuanNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3RlbmFudC9pbml0LWRiLWVudi9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3RlbmFudC9pbml0LWRiLWVudlwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvdGVuYW50L2luaXQtZGItZW52L3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1VzZXJzL2t1b2xkZW5nL3Byb2plY3R4L2Zyb250ZW5kL3B5ZmFjdG9yX25leHQvc3JjL2FwcC9hcGkvdGVuYW50L2luaXQtZGItZW52L3JvdXRlLmpzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgd29ya0FzeW5jU3RvcmFnZSwgd29ya1VuaXRBc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgd29ya0FzeW5jU3RvcmFnZSxcbiAgICAgICAgd29ya1VuaXRBc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCB3b3JrQXN5bmNTdG9yYWdlLCB3b3JrVW5pdEFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Ftenant%2Finit-db-env%2Froute&page=%2Fapi%2Ftenant%2Finit-db-env%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftenant%2Finit-db-env%2Froute.js&appDir=%2FUsers%2Fkuoldeng%2Fprojectx%2Ffrontend%2Fpyfactor_next%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fkuoldeng%2Fprojectx%2Ffrontend%2Fpyfactor_next&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!*******************************************************************************************************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \*******************************************************************************************************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./src/app/api/tenant/db-config.js":
/*!*****************************************!*\
  !*** ./src/app/api/tenant/db-config.js ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createDbPool: () => (/* binding */ createDbPool),\n/* harmony export */   disconnectAllClients: () => (/* binding */ disconnectAllClients),\n/* harmony export */   getDbConfig: () => (/* binding */ getDbConfig),\n/* harmony export */   getPrismaClient: () => (/* binding */ getPrismaClient),\n/* harmony export */   testDbConnection: () => (/* binding */ testDbConnection)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n/**\n * Database configuration for all tenant-related endpoints\n * Provides consistent connection settings with AWS RDS\n */ \n// Cache for Prisma clients to avoid creating multiple connections\nconst prismaClients = {};\n// Connection settings optimized for AWS RDS\nconst DB_DEFAULTS = {\n    port: 5432,\n    database: 'dott_main',\n    // Connection settings - increase timeouts to prevent client-side aborts\n    connectionTimeoutMillis: 15000,\n    statement_timeout: 30000,\n    query_timeout: 30000,\n    max: 5,\n    idleTimeoutMillis: 10000,\n    // Added connection retry logic\n    retryAttempts: 3,\n    retryDelay: 1000 // 1 second between retry attempts\n};\n/**\n * Get database configuration with fallbacks\n * This ensures consistent settings across all endpoints\n * @returns {object} Database configuration\n */ function getDbConfig() {\n    console.log('Using AWS RDS database connection');\n    // Check if SSL should be disabled\n    const useSSL = process.env.DB_USE_SSL !== 'false';\n    // Base configuration using environment variables with fallbacks for AWS RDS\n    const config = {\n        user: process.env.RDS_USERNAME || process.env.DB_USER || process.env.DJANGO_DB_USER || 'dott_admin',\n        password: process.env.RDS_PASSWORD || process.env.DB_PASSWORD || process.env.DJANGO_DB_PASSWORD || 'RRfXU6uPPUbBEg1JqGTJ',\n        host: process.env.RDS_HOSTNAME || process.env.DB_HOST || process.env.DJANGO_DB_HOST || 'dott-dev.c12qgo6m085e.us-east-1.rds.amazonaws.com',\n        port: parseInt(process.env.RDS_PORT || process.env.DB_PORT || process.env.DJANGO_DB_PORT || DB_DEFAULTS.port, 10),\n        database: process.env.RDS_DB_NAME || process.env.DB_NAME || process.env.DJANGO_DB_NAME || 'dott_main',\n        // Connection settings\n        connectionTimeoutMillis: DB_DEFAULTS.connectionTimeoutMillis,\n        statement_timeout: DB_DEFAULTS.statement_timeout,\n        max: DB_DEFAULTS.max,\n        idleTimeoutMillis: DB_DEFAULTS.idleTimeoutMillis\n    };\n    // Log connection details (without password)\n    console.log('AWS RDS connection details:', {\n        host: config.host,\n        database: config.database,\n        user: config.user,\n        port: config.port\n    });\n    // Always add SSL configuration for AWS RDS unless explicitly disabled\n    if (useSSL) {\n        config.ssl = {\n            rejectUnauthorized: false // Allow self-signed certs for AWS RDS\n        };\n    }\n    return config;\n}\n/**\n * Create a database pool with proper error handlers\n * @returns {Pool} Database connection pool\n */ async function createDbPool() {\n    const { Pool } = __webpack_require__(/*! pg */ \"pg\");\n    const config = getDbConfig();\n    try {\n        console.log('[DB] Creating database pool with config:', {\n            host: config.host,\n            port: config.port,\n            database: config.database,\n            user: config.user,\n            ssl: config.ssl ? 'enabled' : 'disabled',\n            connectionTimeoutMillis: config.connectionTimeoutMillis,\n            max: config.max\n        });\n        const pool = new Pool(config);\n        // Add error handler to prevent uncaught exceptions\n        pool.on('error', (err)=>{\n            // Log full error details for debugging\n            console.error('[DB] Pool error event:', {\n                message: err.message,\n                code: err.code,\n                severity: err.severity,\n                detail: err.detail,\n                hint: err.hint,\n                where: err.where,\n                stack: err.stack\n            });\n        // Don't crash on connection errors\n        });\n        // Test connection to verify settings\n        console.log('[DB] Attempting to get client from pool...');\n        // Implement retry logic for initial connection\n        let client = null;\n        let lastError = null;\n        let attemptCount = 0;\n        while(attemptCount < DB_DEFAULTS.retryAttempts){\n            try {\n                attemptCount++;\n                console.log(`[DB] Connection attempt ${attemptCount}/${DB_DEFAULTS.retryAttempts}...`);\n                client = await pool.connect();\n                // If we got here, connection successful - break retry loop\n                console.log('[DB] Client connected successfully');\n                break;\n            } catch (connectionError) {\n                lastError = connectionError;\n                console.error(`[DB] Connection attempt ${attemptCount} failed:`, {\n                    message: connectionError.message,\n                    code: connectionError.code\n                });\n                // Don't wait on the last attempt\n                if (attemptCount < DB_DEFAULTS.retryAttempts) {\n                    console.log(`[DB] Waiting ${DB_DEFAULTS.retryDelay}ms before retry...`);\n                    await new Promise((resolve)=>setTimeout(resolve, DB_DEFAULTS.retryDelay));\n                }\n            }\n        }\n        // If all connection attempts failed, throw the last error\n        if (!client) {\n            throw lastError || new Error('Failed to connect to database after multiple attempts');\n        }\n        try {\n            console.log('[DB] Running test query...');\n            const testResult = await client.query('SELECT 1 as connection_test');\n            console.log('[DB] Database connection test successful', {\n                host: config.host,\n                database: config.database,\n                timestamp: new Date().toISOString(),\n                result: testResult.rows[0]\n            });\n        } catch (queryError) {\n            console.error('[DB] Test query failed:', {\n                message: queryError.message,\n                code: queryError.code,\n                severity: queryError.severity,\n                detail: queryError.detail\n            });\n            throw queryError;\n        } finally{\n            if (client) client.release();\n        }\n        return pool;\n    } catch (error) {\n        console.error('[DB] Error creating database pool:', {\n            message: error.message,\n            code: error.code,\n            severity: error.severity,\n            detail: error.detail\n        });\n        throw error; // Rethrow original error for proper handling\n    }\n}\n/**\n * Test database connection and return status\n * @returns {object} Connection test result\n */ async function testDbConnection() {\n    let pool = null;\n    try {\n        pool = await createDbPool();\n        const result = await pool.query('SELECT 1 as connection_test');\n        const config = getDbConfig();\n        return {\n            success: true,\n            connected: result.rows[0].connection_test === 1,\n            // Only include non-sensitive configuration details\n            config: {\n                host: config.host,\n                database: config.database,\n                port: config.port,\n                ssl: config.ssl ? 'enabled' : 'disabled'\n            },\n            database: 'aws_rds'\n        };\n    } catch (error) {\n        const config = getDbConfig();\n        return {\n            success: false,\n            error: error.message,\n            code: error.code,\n            // Only include non-sensitive configuration details\n            config: {\n                host: config.host,\n                database: config.database,\n                port: config.port,\n                ssl: config.ssl ? 'enabled' : 'disabled'\n            },\n            database: 'aws_rds'\n        };\n    } finally{\n        if (pool) await pool.end();\n    }\n}\n/**\n * Get a Prisma client for a specific schema\n * @param {string} schema - The schema name to connect to\n * @returns {PrismaClient} A Prisma client connected to the specified schema\n */ async function getPrismaClient(schema = 'public') {\n    try {\n        // Return cached client if it exists\n        if (prismaClients[schema]) {\n            console.log(`Using cached Prisma client for schema: ${schema}`);\n            return prismaClients[schema];\n        }\n        console.log(`Creating new Prisma client for schema: ${schema}`);\n        // Get appropriate database URL\n        const dbUrl = process.env.DATABASE_URL || `postgresql://dott_admin:${process.env.DB_PASSWORD || 'RRfXU6uPPUbBEg1JqGTJ'}@dott-dev.c12qgo6m085e.us-east-1.rds.amazonaws.com:5432/dott_main?schema=${schema}`;\n        console.log(`Using database URL: ${dbUrl.replace(/:[^:]*@/, ':***@')}`);\n        // Create a new Prisma client with the schema connection\n        const prisma = new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n            datasources: {\n                db: {\n                    url: dbUrl\n                }\n            },\n            // Add logging in development\n            log:  true ? [\n                {\n                    level: 'query',\n                    emit: 'event'\n                },\n                {\n                    level: 'error',\n                    emit: 'stdout'\n                },\n                {\n                    level: 'warn',\n                    emit: 'stdout'\n                }\n            ] : 0\n        });\n        // Add query logging in development\n        if (true) {\n            prisma.$on('query', (e)=>{\n                console.log(`[Prisma Query] ${e.query} (${e.duration}ms)`);\n            });\n        }\n        // Cache the client\n        prismaClients[schema] = prisma;\n        // Test the connection\n        try {\n            await prisma.$connect();\n            console.log(`Successfully connected to database schema: ${schema}`);\n            // Execute a simple query to verify\n            const result = await prisma.$queryRaw`SELECT 1 as connection_test`;\n            console.log(`Prisma connection test successful: ${JSON.stringify(result)}`);\n            return prisma;\n        } catch (error) {\n            console.error(`Failed to connect to database schema ${schema}:`, {\n                message: error.message,\n                code: error.code,\n                stack: error.stack\n            });\n            // Remove from cache if connection failed\n            delete prismaClients[schema];\n            throw error;\n        }\n    } catch (error) {\n        console.error(`Error setting up Prisma client for schema ${schema}:`, error);\n        throw error;\n    }\n}\n/**\n * Clean up all Prisma clients on server shutdown\n */ async function disconnectAllClients() {\n    for(const schema in prismaClients){\n        try {\n            await prismaClients[schema].$disconnect();\n            console.log(`Disconnected from schema: ${schema}`);\n        } catch (error) {\n            console.error(`Error disconnecting from schema ${schema}:`, error);\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFNTyxLQUFLO1lBQ3BCO1lBRUEseUNBQXlDO1lBQ3pDLE9BQU9yRCxhQUFhLENBQUM4RSxPQUFPO1lBQzVCLE1BQU1oQztRQUNSO0lBQ0YsRUFBRSxPQUFPQSxPQUFPO1FBQ2RsQyxRQUFRa0MsS0FBSyxDQUFDLENBQUMsMENBQTBDLEVBQUVnQyxPQUFPLENBQUMsQ0FBQyxFQUFFaEM7UUFDdEUsTUFBTUE7SUFDUjtBQUNGO0FBRUE7O0NBRUMsR0FDTSxlQUFla0Q7SUFDcEIsSUFBSyxNQUFNbEIsVUFBVTlFLGNBQWU7UUFDbEMsSUFBSTtZQUNGLE1BQU1BLGFBQWEsQ0FBQzhFLE9BQU8sQ0FBQ21CLFdBQVc7WUFDdkNyRixRQUFRQyxHQUFHLENBQUMsQ0FBQywwQkFBMEIsRUFBRWlFLFFBQVE7UUFDbkQsRUFBRSxPQUFPaEMsT0FBTztZQUNkbEMsUUFBUWtDLEtBQUssQ0FBQyxDQUFDLGdDQUFnQyxFQUFFZ0MsT0FBTyxDQUFDLENBQUMsRUFBRWhDO1FBQzlEO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsiL1VzZXJzL2t1b2xkZW5nL3Byb2plY3R4L2Zyb250ZW5kL3B5ZmFjdG9yX25leHQvc3JjL2FwcC9hcGkvdGVuYW50L2RiLWNvbmZpZy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIERhdGFiYXNlIGNvbmZpZ3VyYXRpb24gZm9yIGFsbCB0ZW5hbnQtcmVsYXRlZCBlbmRwb2ludHNcbiAqIFByb3ZpZGVzIGNvbnNpc3RlbnQgY29ubmVjdGlvbiBzZXR0aW5ncyB3aXRoIEFXUyBSRFNcbiAqL1xuXG5pbXBvcnQgeyBQcmlzbWFDbGllbnQgfSBmcm9tICdAcHJpc21hL2NsaWVudCc7XG5cbi8vIENhY2hlIGZvciBQcmlzbWEgY2xpZW50cyB0byBhdm9pZCBjcmVhdGluZyBtdWx0aXBsZSBjb25uZWN0aW9uc1xuY29uc3QgcHJpc21hQ2xpZW50cyA9IHt9O1xuXG4vLyBDb25uZWN0aW9uIHNldHRpbmdzIG9wdGltaXplZCBmb3IgQVdTIFJEU1xuY29uc3QgREJfREVGQVVMVFMgPSB7XG4gIHBvcnQ6IDU0MzIsXG4gIGRhdGFiYXNlOiAnZG90dF9tYWluJyxcbiAgLy8gQ29ubmVjdGlvbiBzZXR0aW5ncyAtIGluY3JlYXNlIHRpbWVvdXRzIHRvIHByZXZlbnQgY2xpZW50LXNpZGUgYWJvcnRzXG4gIGNvbm5lY3Rpb25UaW1lb3V0TWlsbGlzOiAxNTAwMCwgLy8gSW5jcmVhc2VkIGZyb20gODAwMFxuICBzdGF0ZW1lbnRfdGltZW91dDogMzAwMDAsIC8vIEluY3JlYXNlZCBmcm9tIDE1MDAwXG4gIHF1ZXJ5X3RpbWVvdXQ6IDMwMDAwLCAvLyBBZGRlZCBleHBsaWNpdCBxdWVyeSB0aW1lb3V0XG4gIG1heDogNSwgLy8gSW5jcmVhc2VkIGZyb20gMSB0byBhbGxvdyBtb3JlIGNvbmN1cnJlbnQgY29ubmVjdGlvbnNcbiAgaWRsZVRpbWVvdXRNaWxsaXM6IDEwMDAwLCAvLyBJbmNyZWFzZWQgZnJvbSAzMDAwXG4gIC8vIEFkZGVkIGNvbm5lY3Rpb24gcmV0cnkgbG9naWNcbiAgcmV0cnlBdHRlbXB0czogMyxcbiAgcmV0cnlEZWxheTogMTAwMCAvLyAxIHNlY29uZCBiZXR3ZWVuIHJldHJ5IGF0dGVtcHRzXG59O1xuXG4vKipcbiAqIEdldCBkYXRhYmFzZSBjb25maWd1cmF0aW9uIHdpdGggZmFsbGJhY2tzXG4gKiBUaGlzIGVuc3VyZXMgY29uc2lzdGVudCBzZXR0aW5ncyBhY3Jvc3MgYWxsIGVuZHBvaW50c1xuICogQHJldHVybnMge29iamVjdH0gRGF0YWJhc2UgY29uZmlndXJhdGlvblxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RGJDb25maWcoKSB7XG4gIGNvbnNvbGUubG9nKCdVc2luZyBBV1MgUkRTIGRhdGFiYXNlIGNvbm5lY3Rpb24nKTtcbiAgXG4gIC8vIENoZWNrIGlmIFNTTCBzaG91bGQgYmUgZGlzYWJsZWRcbiAgY29uc3QgdXNlU1NMID0gcHJvY2Vzcy5lbnYuREJfVVNFX1NTTCAhPT0gJ2ZhbHNlJztcbiAgXG4gIC8vIEJhc2UgY29uZmlndXJhdGlvbiB1c2luZyBlbnZpcm9ubWVudCB2YXJpYWJsZXMgd2l0aCBmYWxsYmFja3MgZm9yIEFXUyBSRFNcbiAgY29uc3QgY29uZmlnID0ge1xuICAgIHVzZXI6IHByb2Nlc3MuZW52LlJEU19VU0VSTkFNRSB8fCBwcm9jZXNzLmVudi5EQl9VU0VSIHx8IHByb2Nlc3MuZW52LkRKQU5HT19EQl9VU0VSIHx8ICdkb3R0X2FkbWluJyxcbiAgICBwYXNzd29yZDogcHJvY2Vzcy5lbnYuUkRTX1BBU1NXT1JEIHx8IHByb2Nlc3MuZW52LkRCX1BBU1NXT1JEIHx8IHByb2Nlc3MuZW52LkRKQU5HT19EQl9QQVNTV09SRCB8fCAnUlJmWFU2dVBQVWJCRWcxSnFHVEonLFxuICAgIGhvc3Q6IHByb2Nlc3MuZW52LlJEU19IT1NUTkFNRSB8fCBwcm9jZXNzLmVudi5EQl9IT1NUIHx8IHByb2Nlc3MuZW52LkRKQU5HT19EQl9IT1NUIHx8ICdkb3R0LWRldi5jMTJxZ282bTA4NWUudXMtZWFzdC0xLnJkcy5hbWF6b25hd3MuY29tJyxcbiAgICBwb3J0OiBwYXJzZUludChwcm9jZXNzLmVudi5SRFNfUE9SVCB8fCBwcm9jZXNzLmVudi5EQl9QT1JUIHx8IHByb2Nlc3MuZW52LkRKQU5HT19EQl9QT1JUIHx8IERCX0RFRkFVTFRTLnBvcnQsIDEwKSxcbiAgICBkYXRhYmFzZTogcHJvY2Vzcy5lbnYuUkRTX0RCX05BTUUgfHwgcHJvY2Vzcy5lbnYuREJfTkFNRSB8fCBwcm9jZXNzLmVudi5ESkFOR09fREJfTkFNRSB8fCAnZG90dF9tYWluJyxcbiAgICAvLyBDb25uZWN0aW9uIHNldHRpbmdzXG4gICAgY29ubmVjdGlvblRpbWVvdXRNaWxsaXM6IERCX0RFRkFVTFRTLmNvbm5lY3Rpb25UaW1lb3V0TWlsbGlzLFxuICAgIHN0YXRlbWVudF90aW1lb3V0OiBEQl9ERUZBVUxUUy5zdGF0ZW1lbnRfdGltZW91dCxcbiAgICBtYXg6IERCX0RFRkFVTFRTLm1heCxcbiAgICBpZGxlVGltZW91dE1pbGxpczogREJfREVGQVVMVFMuaWRsZVRpbWVvdXRNaWxsaXNcbiAgfTtcbiAgXG4gIC8vIExvZyBjb25uZWN0aW9uIGRldGFpbHMgKHdpdGhvdXQgcGFzc3dvcmQpXG4gIGNvbnNvbGUubG9nKCdBV1MgUkRTIGNvbm5lY3Rpb24gZGV0YWlsczonLCB7IFxuICAgIGhvc3Q6IGNvbmZpZy5ob3N0LCBcbiAgICBkYXRhYmFzZTogY29uZmlnLmRhdGFiYXNlLCBcbiAgICB1c2VyOiBjb25maWcudXNlcixcbiAgICBwb3J0OiBjb25maWcucG9ydFxuICB9KTtcbiAgXG4gIC8vIEFsd2F5cyBhZGQgU1NMIGNvbmZpZ3VyYXRpb24gZm9yIEFXUyBSRFMgdW5sZXNzIGV4cGxpY2l0bHkgZGlzYWJsZWRcbiAgaWYgKHVzZVNTTCkge1xuICAgIGNvbmZpZy5zc2wgPSB7XG4gICAgICByZWplY3RVbmF1dGhvcml6ZWQ6IGZhbHNlIC8vIEFsbG93IHNlbGYtc2lnbmVkIGNlcnRzIGZvciBBV1MgUkRTXG4gICAgfTtcbiAgfVxuICBcbiAgcmV0dXJuIGNvbmZpZztcbn1cblxuLyoqXG4gKiBDcmVhdGUgYSBkYXRhYmFzZSBwb29sIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsZXJzXG4gKiBAcmV0dXJucyB7UG9vbH0gRGF0YWJhc2UgY29ubmVjdGlvbiBwb29sXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVEYlBvb2woKSB7XG4gIGNvbnN0IHsgUG9vbCB9ID0gcmVxdWlyZSgncGcnKTtcbiAgY29uc3QgY29uZmlnID0gZ2V0RGJDb25maWcoKTtcbiAgXG4gIHRyeSB7XG4gICAgY29uc29sZS5sb2coJ1tEQl0gQ3JlYXRpbmcgZGF0YWJhc2UgcG9vbCB3aXRoIGNvbmZpZzonLCB7XG4gICAgICBob3N0OiBjb25maWcuaG9zdCxcbiAgICAgIHBvcnQ6IGNvbmZpZy5wb3J0LFxuICAgICAgZGF0YWJhc2U6IGNvbmZpZy5kYXRhYmFzZSxcbiAgICAgIHVzZXI6IGNvbmZpZy51c2VyLFxuICAgICAgc3NsOiBjb25maWcuc3NsID8gJ2VuYWJsZWQnIDogJ2Rpc2FibGVkJyxcbiAgICAgIGNvbm5lY3Rpb25UaW1lb3V0TWlsbGlzOiBjb25maWcuY29ubmVjdGlvblRpbWVvdXRNaWxsaXMsXG4gICAgICBtYXg6IGNvbmZpZy5tYXhcbiAgICB9KTtcbiAgICBcbiAgICBjb25zdCBwb29sID0gbmV3IFBvb2woY29uZmlnKTtcbiAgICBcbiAgICAvLyBBZGQgZXJyb3IgaGFuZGxlciB0byBwcmV2ZW50IHVuY2F1Z2h0IGV4Y2VwdGlvbnNcbiAgICBwb29sLm9uKCdlcnJvcicsIChlcnIpID0+IHtcbiAgICAgIC8vIExvZyBmdWxsIGVycm9yIGRldGFpbHMgZm9yIGRlYnVnZ2luZ1xuICAgICAgY29uc29sZS5lcnJvcignW0RCXSBQb29sIGVycm9yIGV2ZW50OicsIHtcbiAgICAgICAgbWVzc2FnZTogZXJyLm1lc3NhZ2UsXG4gICAgICAgIGNvZGU6IGVyci5jb2RlLFxuICAgICAgICBzZXZlcml0eTogZXJyLnNldmVyaXR5LFxuICAgICAgICBkZXRhaWw6IGVyci5kZXRhaWwsXG4gICAgICAgIGhpbnQ6IGVyci5oaW50LFxuICAgICAgICB3aGVyZTogZXJyLndoZXJlLFxuICAgICAgICBzdGFjazogZXJyLnN0YWNrXG4gICAgICB9KTtcbiAgICAgIC8vIERvbid0IGNyYXNoIG9uIGNvbm5lY3Rpb24gZXJyb3JzXG4gICAgfSk7XG4gICAgXG4gICAgLy8gVGVzdCBjb25uZWN0aW9uIHRvIHZlcmlmeSBzZXR0aW5nc1xuICAgIGNvbnNvbGUubG9nKCdbREJdIEF0dGVtcHRpbmcgdG8gZ2V0IGNsaWVudCBmcm9tIHBvb2wuLi4nKTtcbiAgICBcbiAgICAvLyBJbXBsZW1lbnQgcmV0cnkgbG9naWMgZm9yIGluaXRpYWwgY29ubmVjdGlvblxuICAgIGxldCBjbGllbnQgPSBudWxsO1xuICAgIGxldCBsYXN0RXJyb3IgPSBudWxsO1xuICAgIGxldCBhdHRlbXB0Q291bnQgPSAwO1xuICAgIFxuICAgIHdoaWxlIChhdHRlbXB0Q291bnQgPCBEQl9ERUZBVUxUUy5yZXRyeUF0dGVtcHRzKSB7XG4gICAgICB0cnkge1xuICAgICAgICBhdHRlbXB0Q291bnQrKztcbiAgICAgICAgY29uc29sZS5sb2coYFtEQl0gQ29ubmVjdGlvbiBhdHRlbXB0ICR7YXR0ZW1wdENvdW50fS8ke0RCX0RFRkFVTFRTLnJldHJ5QXR0ZW1wdHN9Li4uYCk7XG4gICAgICAgIFxuICAgICAgICBjbGllbnQgPSBhd2FpdCBwb29sLmNvbm5lY3QoKTtcbiAgICAgICAgXG4gICAgICAgIC8vIElmIHdlIGdvdCBoZXJlLCBjb25uZWN0aW9uIHN1Y2Nlc3NmdWwgLSBicmVhayByZXRyeSBsb29wXG4gICAgICAgIGNvbnNvbGUubG9nKCdbREJdIENsaWVudCBjb25uZWN0ZWQgc3VjY2Vzc2Z1bGx5Jyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfSBjYXRjaCAoY29ubmVjdGlvbkVycm9yKSB7XG4gICAgICAgIGxhc3RFcnJvciA9IGNvbm5lY3Rpb25FcnJvcjtcbiAgICAgICAgY29uc29sZS5lcnJvcihgW0RCXSBDb25uZWN0aW9uIGF0dGVtcHQgJHthdHRlbXB0Q291bnR9IGZhaWxlZDpgLCB7XG4gICAgICAgICAgbWVzc2FnZTogY29ubmVjdGlvbkVycm9yLm1lc3NhZ2UsXG4gICAgICAgICAgY29kZTogY29ubmVjdGlvbkVycm9yLmNvZGVcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBEb24ndCB3YWl0IG9uIHRoZSBsYXN0IGF0dGVtcHRcbiAgICAgICAgaWYgKGF0dGVtcHRDb3VudCA8IERCX0RFRkFVTFRTLnJldHJ5QXR0ZW1wdHMpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhgW0RCXSBXYWl0aW5nICR7REJfREVGQVVMVFMucmV0cnlEZWxheX1tcyBiZWZvcmUgcmV0cnkuLi5gKTtcbiAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgREJfREVGQVVMVFMucmV0cnlEZWxheSkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIElmIGFsbCBjb25uZWN0aW9uIGF0dGVtcHRzIGZhaWxlZCwgdGhyb3cgdGhlIGxhc3QgZXJyb3JcbiAgICBpZiAoIWNsaWVudCkge1xuICAgICAgdGhyb3cgbGFzdEVycm9yIHx8IG5ldyBFcnJvcignRmFpbGVkIHRvIGNvbm5lY3QgdG8gZGF0YWJhc2UgYWZ0ZXIgbXVsdGlwbGUgYXR0ZW1wdHMnKTtcbiAgICB9XG4gICAgXG4gICAgdHJ5IHtcbiAgICAgIGNvbnNvbGUubG9nKCdbREJdIFJ1bm5pbmcgdGVzdCBxdWVyeS4uLicpO1xuICAgICAgY29uc3QgdGVzdFJlc3VsdCA9IGF3YWl0IGNsaWVudC5xdWVyeSgnU0VMRUNUIDEgYXMgY29ubmVjdGlvbl90ZXN0Jyk7XG4gICAgICBjb25zb2xlLmxvZygnW0RCXSBEYXRhYmFzZSBjb25uZWN0aW9uIHRlc3Qgc3VjY2Vzc2Z1bCcsIHtcbiAgICAgICAgaG9zdDogY29uZmlnLmhvc3QsXG4gICAgICAgIGRhdGFiYXNlOiBjb25maWcuZGF0YWJhc2UsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICByZXN1bHQ6IHRlc3RSZXN1bHQucm93c1swXVxuICAgICAgfSk7XG4gICAgfSBjYXRjaCAocXVlcnlFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW0RCXSBUZXN0IHF1ZXJ5IGZhaWxlZDonLCB7XG4gICAgICAgIG1lc3NhZ2U6IHF1ZXJ5RXJyb3IubWVzc2FnZSxcbiAgICAgICAgY29kZTogcXVlcnlFcnJvci5jb2RlLFxuICAgICAgICBzZXZlcml0eTogcXVlcnlFcnJvci5zZXZlcml0eSxcbiAgICAgICAgZGV0YWlsOiBxdWVyeUVycm9yLmRldGFpbFxuICAgICAgfSk7XG4gICAgICB0aHJvdyBxdWVyeUVycm9yO1xuICAgIH0gZmluYWxseSB7XG4gICAgICBpZiAoY2xpZW50KSBjbGllbnQucmVsZWFzZSgpO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gcG9vbDtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdbREJdIEVycm9yIGNyZWF0aW5nIGRhdGFiYXNlIHBvb2w6Jywge1xuICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgIGNvZGU6IGVycm9yLmNvZGUsXG4gICAgICBzZXZlcml0eTogZXJyb3Iuc2V2ZXJpdHksXG4gICAgICBkZXRhaWw6IGVycm9yLmRldGFpbFxuICAgIH0pO1xuICAgIHRocm93IGVycm9yOyAvLyBSZXRocm93IG9yaWdpbmFsIGVycm9yIGZvciBwcm9wZXIgaGFuZGxpbmdcbiAgfVxufVxuXG4vKipcbiAqIFRlc3QgZGF0YWJhc2UgY29ubmVjdGlvbiBhbmQgcmV0dXJuIHN0YXR1c1xuICogQHJldHVybnMge29iamVjdH0gQ29ubmVjdGlvbiB0ZXN0IHJlc3VsdFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdGVzdERiQ29ubmVjdGlvbigpIHtcbiAgbGV0IHBvb2wgPSBudWxsO1xuICBcbiAgdHJ5IHtcbiAgICBwb29sID0gYXdhaXQgY3JlYXRlRGJQb29sKCk7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcG9vbC5xdWVyeSgnU0VMRUNUIDEgYXMgY29ubmVjdGlvbl90ZXN0Jyk7XG4gICAgY29uc3QgY29uZmlnID0gZ2V0RGJDb25maWcoKTtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIGNvbm5lY3RlZDogcmVzdWx0LnJvd3NbMF0uY29ubmVjdGlvbl90ZXN0ID09PSAxLFxuICAgICAgLy8gT25seSBpbmNsdWRlIG5vbi1zZW5zaXRpdmUgY29uZmlndXJhdGlvbiBkZXRhaWxzXG4gICAgICBjb25maWc6IHtcbiAgICAgICAgaG9zdDogY29uZmlnLmhvc3QsXG4gICAgICAgIGRhdGFiYXNlOiBjb25maWcuZGF0YWJhc2UsXG4gICAgICAgIHBvcnQ6IGNvbmZpZy5wb3J0LFxuICAgICAgICBzc2w6IGNvbmZpZy5zc2wgPyAnZW5hYmxlZCcgOiAnZGlzYWJsZWQnXG4gICAgICB9LFxuICAgICAgZGF0YWJhc2U6ICdhd3NfcmRzJ1xuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc3QgY29uZmlnID0gZ2V0RGJDb25maWcoKTtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcbiAgICAgIGNvZGU6IGVycm9yLmNvZGUsXG4gICAgICAvLyBPbmx5IGluY2x1ZGUgbm9uLXNlbnNpdGl2ZSBjb25maWd1cmF0aW9uIGRldGFpbHNcbiAgICAgIGNvbmZpZzoge1xuICAgICAgICBob3N0OiBjb25maWcuaG9zdCxcbiAgICAgICAgZGF0YWJhc2U6IGNvbmZpZy5kYXRhYmFzZSxcbiAgICAgICAgcG9ydDogY29uZmlnLnBvcnQsXG4gICAgICAgIHNzbDogY29uZmlnLnNzbCA/ICdlbmFibGVkJyA6ICdkaXNhYmxlZCdcbiAgICAgIH0sXG4gICAgICBkYXRhYmFzZTogJ2F3c19yZHMnXG4gICAgfTtcbiAgfSBmaW5hbGx5IHtcbiAgICBpZiAocG9vbCkgYXdhaXQgcG9vbC5lbmQoKTtcbiAgfVxufVxuXG4vKipcbiAqIEdldCBhIFByaXNtYSBjbGllbnQgZm9yIGEgc3BlY2lmaWMgc2NoZW1hXG4gKiBAcGFyYW0ge3N0cmluZ30gc2NoZW1hIC0gVGhlIHNjaGVtYSBuYW1lIHRvIGNvbm5lY3QgdG9cbiAqIEByZXR1cm5zIHtQcmlzbWFDbGllbnR9IEEgUHJpc21hIGNsaWVudCBjb25uZWN0ZWQgdG8gdGhlIHNwZWNpZmllZCBzY2hlbWFcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByaXNtYUNsaWVudChzY2hlbWEgPSAncHVibGljJykge1xuICB0cnkge1xuICAgIC8vIFJldHVybiBjYWNoZWQgY2xpZW50IGlmIGl0IGV4aXN0c1xuICAgIGlmIChwcmlzbWFDbGllbnRzW3NjaGVtYV0pIHtcbiAgICAgIGNvbnNvbGUubG9nKGBVc2luZyBjYWNoZWQgUHJpc21hIGNsaWVudCBmb3Igc2NoZW1hOiAke3NjaGVtYX1gKTtcbiAgICAgIHJldHVybiBwcmlzbWFDbGllbnRzW3NjaGVtYV07XG4gICAgfVxuICAgIFxuICAgIGNvbnNvbGUubG9nKGBDcmVhdGluZyBuZXcgUHJpc21hIGNsaWVudCBmb3Igc2NoZW1hOiAke3NjaGVtYX1gKTtcbiAgICBcbiAgICAvLyBHZXQgYXBwcm9wcmlhdGUgZGF0YWJhc2UgVVJMXG4gICAgY29uc3QgZGJVcmwgPSBwcm9jZXNzLmVudi5EQVRBQkFTRV9VUkwgfHwgXG4gICAgICBgcG9zdGdyZXNxbDovL2RvdHRfYWRtaW46JHtwcm9jZXNzLmVudi5EQl9QQVNTV09SRCB8fCAnUlJmWFU2dVBQVWJCRWcxSnFHVEonfUBkb3R0LWRldi5jMTJxZ282bTA4NWUudXMtZWFzdC0xLnJkcy5hbWF6b25hd3MuY29tOjU0MzIvZG90dF9tYWluP3NjaGVtYT0ke3NjaGVtYX1gO1xuICAgIFxuICAgIGNvbnNvbGUubG9nKGBVc2luZyBkYXRhYmFzZSBVUkw6ICR7ZGJVcmwucmVwbGFjZSgvOlteOl0qQC8sICc6KioqQCcpfWApO1xuICAgIFxuICAgIC8vIENyZWF0ZSBhIG5ldyBQcmlzbWEgY2xpZW50IHdpdGggdGhlIHNjaGVtYSBjb25uZWN0aW9uXG4gICAgY29uc3QgcHJpc21hID0gbmV3IFByaXNtYUNsaWVudCh7XG4gICAgICBkYXRhc291cmNlczoge1xuICAgICAgICBkYjoge1xuICAgICAgICAgIHVybDogZGJVcmxcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIC8vIEFkZCBsb2dnaW5nIGluIGRldmVsb3BtZW50XG4gICAgICBsb2c6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnID8gW1xuICAgICAgICB7IGxldmVsOiAncXVlcnknLCBlbWl0OiAnZXZlbnQnIH0sXG4gICAgICAgIHsgbGV2ZWw6ICdlcnJvcicsIGVtaXQ6ICdzdGRvdXQnIH0sXG4gICAgICAgIHsgbGV2ZWw6ICd3YXJuJywgZW1pdDogJ3N0ZG91dCcgfSxcbiAgICAgIF0gOiB1bmRlZmluZWQsXG4gICAgfSk7XG4gICAgXG4gICAgLy8gQWRkIHF1ZXJ5IGxvZ2dpbmcgaW4gZGV2ZWxvcG1lbnRcbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcpIHtcbiAgICAgIHByaXNtYS4kb24oJ3F1ZXJ5JywgKGUpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coYFtQcmlzbWEgUXVlcnldICR7ZS5xdWVyeX0gKCR7ZS5kdXJhdGlvbn1tcylgKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICAvLyBDYWNoZSB0aGUgY2xpZW50XG4gICAgcHJpc21hQ2xpZW50c1tzY2hlbWFdID0gcHJpc21hO1xuICAgIFxuICAgIC8vIFRlc3QgdGhlIGNvbm5lY3Rpb25cbiAgICB0cnkge1xuICAgICAgYXdhaXQgcHJpc21hLiRjb25uZWN0KCk7XG4gICAgICBjb25zb2xlLmxvZyhgU3VjY2Vzc2Z1bGx5IGNvbm5lY3RlZCB0byBkYXRhYmFzZSBzY2hlbWE6ICR7c2NoZW1hfWApO1xuICAgICAgXG4gICAgICAvLyBFeGVjdXRlIGEgc2ltcGxlIHF1ZXJ5IHRvIHZlcmlmeVxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcHJpc21hLiRxdWVyeVJhd2BTRUxFQ1QgMSBhcyBjb25uZWN0aW9uX3Rlc3RgO1xuICAgICAgY29uc29sZS5sb2coYFByaXNtYSBjb25uZWN0aW9uIHRlc3Qgc3VjY2Vzc2Z1bDogJHtKU09OLnN0cmluZ2lmeShyZXN1bHQpfWApO1xuICAgICAgXG4gICAgICByZXR1cm4gcHJpc21hO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGBGYWlsZWQgdG8gY29ubmVjdCB0byBkYXRhYmFzZSBzY2hlbWEgJHtzY2hlbWF9OmAsIHtcbiAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgY29kZTogZXJyb3IuY29kZSxcbiAgICAgICAgc3RhY2s6IGVycm9yLnN0YWNrXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgLy8gUmVtb3ZlIGZyb20gY2FjaGUgaWYgY29ubmVjdGlvbiBmYWlsZWRcbiAgICAgIGRlbGV0ZSBwcmlzbWFDbGllbnRzW3NjaGVtYV07XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihgRXJyb3Igc2V0dGluZyB1cCBQcmlzbWEgY2xpZW50IGZvciBzY2hlbWEgJHtzY2hlbWF9OmAsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufVxuXG4vKipcbiAqIENsZWFuIHVwIGFsbCBQcmlzbWEgY2xpZW50cyBvbiBzZXJ2ZXIgc2h1dGRvd25cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRpc2Nvbm5lY3RBbGxDbGllbnRzKCkge1xuICBmb3IgKGNvbnN0IHNjaGVtYSBpbiBwcmlzbWFDbGllbnRzKSB7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHByaXNtYUNsaWVudHNbc2NoZW1hXS4kZGlzY29ubmVjdCgpO1xuICAgICAgY29uc29sZS5sb2coYERpc2Nvbm5lY3RlZCBmcm9tIHNjaGVtYTogJHtzY2hlbWF9YCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIGRpc2Nvbm5lY3RpbmcgZnJvbSBzY2hlbWEgJHtzY2hlbWF9OmAsIGVycm9yKTtcbiAgICB9XG4gIH1cbn0iXSwibmFtZXMiOlsiUHJpc21hQ2xpZW50IiwicHJpc21hQ2xpZW50cyIsIkRCX0RFRkFVTFRTIiwicG9ydCIsImRhdGFiYXNlIiwiY29ubmVjdGlvblRpbWVvdXRNaWxsaXMiLCJzdGF0ZW1lbnRfdGltZW91dCIsInF1ZXJ5X3RpbWVvdXQiLCJtYXgiLCJpZGxlVGltZW91dE1pbGxpcyIsInJldHJ5QXR0ZW1wdHMiLCJyZXRyeURlbGF5IiwiZ2V0RGJDb25maWciLCJjb25zb2xlIiwibG9nIiwidXNlU1NMIiwicHJvY2VzcyIsImVudiIsIkRCX1VTRV9TU0wiLCJjb25maWciLCJ1c2VyIiwiUkRTX1VTRVJOQU1FIiwiREJfVVNFUiIsIkRKQU5HT19EQl9VU0VSIiwicGFzc3dvcmQiLCJSRFNfUEFTU1dPUkQiLCJEQl9QQVNTV09SRCIsIkRKQU5HT19EQl9QQVNTV09SRCIsImhvc3QiLCJSRFNfSE9TVE5BTUUiLCJEQl9IT1NUIiwiREpBTkdPX0RCX0hPU1QiLCJwYXJzZUludCIsIlJEU19QT1JUIiwiREJfUE9SVCIsIkRKQU5HT19EQl9QT1JUIiwiUkRTX0RCX05BTUUiLCJEQl9OQU1FIiwiREpBTkdPX0RCX05BTUUiLCJzc2wiLCJyZWplY3RVbmF1dGhvcml6ZWQiLCJjcmVhdGVEYlBvb2wiLCJQb29sIiwicmVxdWlyZSIsInBvb2wiLCJvbiIsImVyciIsImVycm9yIiwibWVzc2FnZSIsImNvZGUiLCJzZXZlcml0eSIsImRldGFpbCIsImhpbnQiLCJ3aGVyZSIsInN0YWNrIiwiY2xpZW50IiwibGFzdEVycm9yIiwiYXR0ZW1wdENvdW50IiwiY29ubmVjdCIsImNvbm5lY3Rpb25FcnJvciIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsIkVycm9yIiwidGVzdFJlc3VsdCIsInF1ZXJ5IiwidGltZXN0YW1wIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwicmVzdWx0Iiwicm93cyIsInF1ZXJ5RXJyb3IiLCJyZWxlYXNlIiwidGVzdERiQ29ubmVjdGlvbiIsInN1Y2Nlc3MiLCJjb25uZWN0ZWQiLCJjb25uZWN0aW9uX3Rlc3QiLCJlbmQiLCJnZXRQcmlzbWFDbGllbnQiLCJzY2hlbWEiLCJkYlVybCIsIkRBVEFCQVNFX1VSTCIsInJlcGxhY2UiLCJwcmlzbWEiLCJkYXRhc291cmNlcyIsImRiIiwidXJsIiwibGV2ZWwiLCJlbWl0IiwidW5kZWZpbmVkIiwiJG9uIiwiZSIsImR1cmF0aW9uIiwiJGNvbm5lY3QiLCIkcXVlcnlSYXciLCJKU09OIiwic3RyaW5naWZ5IiwiZGlzY29ubmVjdEFsbENsaWVudHMiLCIkZGlzY29ubmVjdCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/tenant/db-config.js\n");

/***/ }),

/***/ "(rsc)/./src/app/api/tenant/init-db-env/route.js":
/*!*************************************************!*\
  !*** ./src/app/api/tenant/init-db-env/route.js ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/api/server.js\");\n/* harmony import */ var _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/utils/serverLogger */ \"(rsc)/./src/utils/serverLogger.js\");\n/* harmony import */ var _db_config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../db-config */ \"(rsc)/./src/app/api/tenant/db-config.js\");\n\n\n\n/**\n * Special endpoint to create initial DB environment\n * Uses hardcoded credentials and creates tenant table if needed\n */ async function GET(request) {\n    let pool = null;\n    try {\n        // Create database pool\n        pool = await (0,_db_config__WEBPACK_IMPORTED_MODULE_2__.createDbPool)();\n        _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.info('[InitDbEnv] Created database pool successfully');\n        // Check if custom_auth_tenant table exists\n        const checkTableQuery = `\n      SELECT EXISTS (\n        SELECT FROM information_schema.tables \n        WHERE table_schema = 'public' AND table_name = 'custom_auth_tenant'\n      );\n    `;\n        const checkResult = await pool.query(checkTableQuery);\n        const tableExists = checkResult.rows[0].exists;\n        if (tableExists) {\n            _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.info('[InitDbEnv] Table custom_auth_tenant already exists');\n        } else {\n            _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.info('[InitDbEnv] Table custom_auth_tenant does not exist, creating now');\n            // Create tenant table if it doesn't exist\n            const createTableQuery = `\n        CREATE TABLE IF NOT EXISTS public.custom_auth_tenant (\n          id UUID PRIMARY KEY,\n          name VARCHAR(255) NOT NULL,\n          owner_id VARCHAR(255),\n          schema_name VARCHAR(255) NOT NULL,\n          created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n          updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n          rls_enabled BOOLEAN DEFAULT TRUE,\n          rls_setup_date TIMESTAMP WITH TIME ZONE,\n          is_active BOOLEAN DEFAULT TRUE\n        );\n      `;\n            await pool.query(createTableQuery);\n            _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.info('[InitDbEnv] Successfully created custom_auth_tenant table');\n        }\n        // Check table structure\n        const tableStructureQuery = `\n      SELECT column_name, data_type, is_nullable\n      FROM information_schema.columns\n      WHERE table_schema = 'public' AND table_name = 'custom_auth_tenant'\n      ORDER BY ordinal_position;\n    `;\n        const structureResult = await pool.query(tableStructureQuery);\n        // Ensure indices exist for performance\n        const createIndexQuery = `\n      CREATE INDEX IF NOT EXISTS idx_tenant_owner_id ON public.custom_auth_tenant(owner_id);\n      CREATE INDEX IF NOT EXISTS idx_tenant_schema_name ON public.custom_auth_tenant(schema_name);\n    `;\n        await pool.query(createIndexQuery);\n        _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.info('[InitDbEnv] Ensured indices exist on custom_auth_tenant table');\n        // Create init function to set up RLS for tenants\n        const createFunctionQuery = `\n      CREATE OR REPLACE FUNCTION setup_tenant_rls(tenant_id UUID, schema_name TEXT)\n      RETURNS VOID AS $$\n      DECLARE\n        table_name TEXT;\n      BEGIN\n        -- Loop through all tables in the schema\n        FOR table_name IN\n          SELECT table_name \n          FROM information_schema.tables \n          WHERE table_schema = schema_name\n        LOOP\n          -- Enable RLS for each table\n          EXECUTE format('ALTER TABLE IF EXISTS %I.%I ENABLE ROW LEVEL SECURITY', \n                        schema_name, table_name);\n          \n          -- Create or replace RLS policy\n          EXECUTE format('DROP POLICY IF EXISTS tenant_isolation_policy ON %I.%I', \n                        schema_name, table_name);\n          \n          EXECUTE format('CREATE POLICY tenant_isolation_policy ON %I.%I \n                          USING (tenant_id = %L)\n                          WITH CHECK (tenant_id = %L)', \n                          schema_name, table_name, tenant_id, tenant_id);\n        END LOOP;\n      END;\n      $$ LANGUAGE plpgsql;\n    `;\n        // Try to create the function\n        try {\n            await pool.query(createFunctionQuery);\n            _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.info('[InitDbEnv] Created RLS setup function');\n        } catch (funcError) {\n            _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.warn('[InitDbEnv] Error creating RLS function (may already exist):', funcError.message);\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            message: 'Database environment initialized successfully',\n            tableExists,\n            tableStructure: structureResult.rows,\n            dbConfig: {\n                host: (0,_db_config__WEBPACK_IMPORTED_MODULE_2__.getDbConfig)().host,\n                port: (0,_db_config__WEBPACK_IMPORTED_MODULE_2__.getDbConfig)().port,\n                database: (0,_db_config__WEBPACK_IMPORTED_MODULE_2__.getDbConfig)().database,\n                user: (0,_db_config__WEBPACK_IMPORTED_MODULE_2__.getDbConfig)().user\n            }\n        });\n    } catch (error) {\n        _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.error('[InitDbEnv] Error initializing database environment:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: error.message,\n            code: error.code,\n            detail: error.detail,\n            message: 'Failed to initialize database environment'\n        }, {\n            status: 500\n        });\n    } finally{\n        if (pool) {\n            try {\n                await pool.end();\n                _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.info('[InitDbEnv] Database connection closed');\n            } catch (closeError) {\n                _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.error('[InitDbEnv] Error closing pool:', closeError.message);\n            }\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS90ZW5hbnQvaW5pdC1kYi1lbnYvcm91dGUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUEyQztBQUNHO0FBQ1c7QUFFekQ7OztDQUdDLEdBQ00sZUFBZUksSUFBSUMsT0FBTztJQUMvQixJQUFJQyxPQUFPO0lBRVgsSUFBSTtRQUNGLHVCQUF1QjtRQUN2QkEsT0FBTyxNQUFNSix3REFBWUE7UUFDekJELHVEQUFNQSxDQUFDTSxJQUFJLENBQUM7UUFFWiwyQ0FBMkM7UUFDM0MsTUFBTUMsa0JBQWtCLENBQUM7Ozs7O0lBS3pCLENBQUM7UUFFRCxNQUFNQyxjQUFjLE1BQU1ILEtBQUtJLEtBQUssQ0FBQ0Y7UUFDckMsTUFBTUcsY0FBY0YsWUFBWUcsSUFBSSxDQUFDLEVBQUUsQ0FBQ0MsTUFBTTtRQUU5QyxJQUFJRixhQUFhO1lBQ2ZWLHVEQUFNQSxDQUFDTSxJQUFJLENBQUM7UUFDZCxPQUFPO1lBQ0xOLHVEQUFNQSxDQUFDTSxJQUFJLENBQUM7WUFFWiwwQ0FBMEM7WUFDMUMsTUFBTU8sbUJBQW1CLENBQUM7Ozs7Ozs7Ozs7OztNQVkxQixDQUFDO1lBRUQsTUFBTVIsS0FBS0ksS0FBSyxDQUFDSTtZQUNqQmIsdURBQU1BLENBQUNNLElBQUksQ0FBQztRQUNkO1FBRUEsd0JBQXdCO1FBQ3hCLE1BQU1RLHNCQUFzQixDQUFDOzs7OztJQUs3QixDQUFDO1FBRUQsTUFBTUMsa0JBQWtCLE1BQU1WLEtBQUtJLEtBQUssQ0FBQ0s7UUFFekMsdUNBQXVDO1FBQ3ZDLE1BQU1FLG1CQUFtQixDQUFDOzs7SUFHMUIsQ0FBQztRQUVELE1BQU1YLEtBQUtJLEtBQUssQ0FBQ087UUFDakJoQix1REFBTUEsQ0FBQ00sSUFBSSxDQUFDO1FBRVosaURBQWlEO1FBQ2pELE1BQU1XLHNCQUFzQixDQUFDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7SUEyQjdCLENBQUM7UUFFRCw2QkFBNkI7UUFDN0IsSUFBSTtZQUNGLE1BQU1aLEtBQUtJLEtBQUssQ0FBQ1E7WUFDakJqQix1REFBTUEsQ0FBQ00sSUFBSSxDQUFDO1FBQ2QsRUFBRSxPQUFPWSxXQUFXO1lBQ2xCbEIsdURBQU1BLENBQUNtQixJQUFJLENBQUMsZ0VBQWdFRCxVQUFVRSxPQUFPO1FBQy9GO1FBRUEsT0FBT3JCLHFEQUFZQSxDQUFDc0IsSUFBSSxDQUFDO1lBQ3ZCQyxTQUFTO1lBQ1RGLFNBQVM7WUFDVFY7WUFDQWEsZ0JBQWdCUixnQkFBZ0JKLElBQUk7WUFDcENhLFVBQVU7Z0JBQ1JDLE1BQU12Qix1REFBV0EsR0FBR3VCLElBQUk7Z0JBQ3hCQyxNQUFNeEIsdURBQVdBLEdBQUd3QixJQUFJO2dCQUN4QkMsVUFBVXpCLHVEQUFXQSxHQUFHeUIsUUFBUTtnQkFDaENDLE1BQU0xQix1REFBV0EsR0FBRzBCLElBQUk7WUFDMUI7UUFDRjtJQUNGLEVBQUUsT0FBT0MsT0FBTztRQUNkN0IsdURBQU1BLENBQUM2QixLQUFLLENBQUMsd0RBQXdEQTtRQUVyRSxPQUFPOUIscURBQVlBLENBQUNzQixJQUFJLENBQUM7WUFDdkJDLFNBQVM7WUFDVE8sT0FBT0EsTUFBTVQsT0FBTztZQUNwQlUsTUFBTUQsTUFBTUMsSUFBSTtZQUNoQkMsUUFBUUYsTUFBTUUsTUFBTTtZQUNwQlgsU0FBUztRQUNYLEdBQUc7WUFBRVksUUFBUTtRQUFJO0lBQ25CLFNBQVU7UUFDUixJQUFJM0IsTUFBTTtZQUNSLElBQUk7Z0JBQ0YsTUFBTUEsS0FBSzRCLEdBQUc7Z0JBQ2RqQyx1REFBTUEsQ0FBQ00sSUFBSSxDQUFDO1lBQ2QsRUFBRSxPQUFPNEIsWUFBWTtnQkFDbkJsQyx1REFBTUEsQ0FBQzZCLEtBQUssQ0FBQyxtQ0FBbUNLLFdBQVdkLE9BQU87WUFDcEU7UUFDRjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIi9Vc2Vycy9rdW9sZGVuZy9wcm9qZWN0eC9mcm9udGVuZC9weWZhY3Rvcl9uZXh0L3NyYy9hcHAvYXBpL3RlbmFudC9pbml0LWRiLWVudi9yb3V0ZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG5pbXBvcnQgeyBsb2dnZXIgfSBmcm9tICdAL3V0aWxzL3NlcnZlckxvZ2dlcic7XG5pbXBvcnQgeyBjcmVhdGVEYlBvb2wsIGdldERiQ29uZmlnIH0gZnJvbSAnLi4vZGItY29uZmlnJztcblxuLyoqXG4gKiBTcGVjaWFsIGVuZHBvaW50IHRvIGNyZWF0ZSBpbml0aWFsIERCIGVudmlyb25tZW50XG4gKiBVc2VzIGhhcmRjb2RlZCBjcmVkZW50aWFscyBhbmQgY3JlYXRlcyB0ZW5hbnQgdGFibGUgaWYgbmVlZGVkXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdCkge1xuICBsZXQgcG9vbCA9IG51bGw7XG4gIFxuICB0cnkge1xuICAgIC8vIENyZWF0ZSBkYXRhYmFzZSBwb29sXG4gICAgcG9vbCA9IGF3YWl0IGNyZWF0ZURiUG9vbCgpO1xuICAgIGxvZ2dlci5pbmZvKCdbSW5pdERiRW52XSBDcmVhdGVkIGRhdGFiYXNlIHBvb2wgc3VjY2Vzc2Z1bGx5Jyk7XG4gICAgXG4gICAgLy8gQ2hlY2sgaWYgY3VzdG9tX2F1dGhfdGVuYW50IHRhYmxlIGV4aXN0c1xuICAgIGNvbnN0IGNoZWNrVGFibGVRdWVyeSA9IGBcbiAgICAgIFNFTEVDVCBFWElTVFMgKFxuICAgICAgICBTRUxFQ1QgRlJPTSBpbmZvcm1hdGlvbl9zY2hlbWEudGFibGVzIFxuICAgICAgICBXSEVSRSB0YWJsZV9zY2hlbWEgPSAncHVibGljJyBBTkQgdGFibGVfbmFtZSA9ICdjdXN0b21fYXV0aF90ZW5hbnQnXG4gICAgICApO1xuICAgIGA7XG4gICAgXG4gICAgY29uc3QgY2hlY2tSZXN1bHQgPSBhd2FpdCBwb29sLnF1ZXJ5KGNoZWNrVGFibGVRdWVyeSk7XG4gICAgY29uc3QgdGFibGVFeGlzdHMgPSBjaGVja1Jlc3VsdC5yb3dzWzBdLmV4aXN0cztcbiAgICBcbiAgICBpZiAodGFibGVFeGlzdHMpIHtcbiAgICAgIGxvZ2dlci5pbmZvKCdbSW5pdERiRW52XSBUYWJsZSBjdXN0b21fYXV0aF90ZW5hbnQgYWxyZWFkeSBleGlzdHMnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgbG9nZ2VyLmluZm8oJ1tJbml0RGJFbnZdIFRhYmxlIGN1c3RvbV9hdXRoX3RlbmFudCBkb2VzIG5vdCBleGlzdCwgY3JlYXRpbmcgbm93Jyk7XG4gICAgICBcbiAgICAgIC8vIENyZWF0ZSB0ZW5hbnQgdGFibGUgaWYgaXQgZG9lc24ndCBleGlzdFxuICAgICAgY29uc3QgY3JlYXRlVGFibGVRdWVyeSA9IGBcbiAgICAgICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgcHVibGljLmN1c3RvbV9hdXRoX3RlbmFudCAoXG4gICAgICAgICAgaWQgVVVJRCBQUklNQVJZIEtFWSxcbiAgICAgICAgICBuYW1lIFZBUkNIQVIoMjU1KSBOT1QgTlVMTCxcbiAgICAgICAgICBvd25lcl9pZCBWQVJDSEFSKDI1NSksXG4gICAgICAgICAgc2NoZW1hX25hbWUgVkFSQ0hBUigyNTUpIE5PVCBOVUxMLFxuICAgICAgICAgIGNyZWF0ZWRfYXQgVElNRVNUQU1QIFdJVEggVElNRSBaT05FIERFRkFVTFQgTk9XKCksXG4gICAgICAgICAgdXBkYXRlZF9hdCBUSU1FU1RBTVAgV0lUSCBUSU1FIFpPTkUgREVGQVVMVCBOT1coKSxcbiAgICAgICAgICBybHNfZW5hYmxlZCBCT09MRUFOIERFRkFVTFQgVFJVRSxcbiAgICAgICAgICBybHNfc2V0dXBfZGF0ZSBUSU1FU1RBTVAgV0lUSCBUSU1FIFpPTkUsXG4gICAgICAgICAgaXNfYWN0aXZlIEJPT0xFQU4gREVGQVVMVCBUUlVFXG4gICAgICAgICk7XG4gICAgICBgO1xuICAgICAgXG4gICAgICBhd2FpdCBwb29sLnF1ZXJ5KGNyZWF0ZVRhYmxlUXVlcnkpO1xuICAgICAgbG9nZ2VyLmluZm8oJ1tJbml0RGJFbnZdIFN1Y2Nlc3NmdWxseSBjcmVhdGVkIGN1c3RvbV9hdXRoX3RlbmFudCB0YWJsZScpO1xuICAgIH1cbiAgICBcbiAgICAvLyBDaGVjayB0YWJsZSBzdHJ1Y3R1cmVcbiAgICBjb25zdCB0YWJsZVN0cnVjdHVyZVF1ZXJ5ID0gYFxuICAgICAgU0VMRUNUIGNvbHVtbl9uYW1lLCBkYXRhX3R5cGUsIGlzX251bGxhYmxlXG4gICAgICBGUk9NIGluZm9ybWF0aW9uX3NjaGVtYS5jb2x1bW5zXG4gICAgICBXSEVSRSB0YWJsZV9zY2hlbWEgPSAncHVibGljJyBBTkQgdGFibGVfbmFtZSA9ICdjdXN0b21fYXV0aF90ZW5hbnQnXG4gICAgICBPUkRFUiBCWSBvcmRpbmFsX3Bvc2l0aW9uO1xuICAgIGA7XG4gICAgXG4gICAgY29uc3Qgc3RydWN0dXJlUmVzdWx0ID0gYXdhaXQgcG9vbC5xdWVyeSh0YWJsZVN0cnVjdHVyZVF1ZXJ5KTtcbiAgICBcbiAgICAvLyBFbnN1cmUgaW5kaWNlcyBleGlzdCBmb3IgcGVyZm9ybWFuY2VcbiAgICBjb25zdCBjcmVhdGVJbmRleFF1ZXJ5ID0gYFxuICAgICAgQ1JFQVRFIElOREVYIElGIE5PVCBFWElTVFMgaWR4X3RlbmFudF9vd25lcl9pZCBPTiBwdWJsaWMuY3VzdG9tX2F1dGhfdGVuYW50KG93bmVyX2lkKTtcbiAgICAgIENSRUFURSBJTkRFWCBJRiBOT1QgRVhJU1RTIGlkeF90ZW5hbnRfc2NoZW1hX25hbWUgT04gcHVibGljLmN1c3RvbV9hdXRoX3RlbmFudChzY2hlbWFfbmFtZSk7XG4gICAgYDtcbiAgICBcbiAgICBhd2FpdCBwb29sLnF1ZXJ5KGNyZWF0ZUluZGV4UXVlcnkpO1xuICAgIGxvZ2dlci5pbmZvKCdbSW5pdERiRW52XSBFbnN1cmVkIGluZGljZXMgZXhpc3Qgb24gY3VzdG9tX2F1dGhfdGVuYW50IHRhYmxlJyk7XG4gICAgXG4gICAgLy8gQ3JlYXRlIGluaXQgZnVuY3Rpb24gdG8gc2V0IHVwIFJMUyBmb3IgdGVuYW50c1xuICAgIGNvbnN0IGNyZWF0ZUZ1bmN0aW9uUXVlcnkgPSBgXG4gICAgICBDUkVBVEUgT1IgUkVQTEFDRSBGVU5DVElPTiBzZXR1cF90ZW5hbnRfcmxzKHRlbmFudF9pZCBVVUlELCBzY2hlbWFfbmFtZSBURVhUKVxuICAgICAgUkVUVVJOUyBWT0lEIEFTICQkXG4gICAgICBERUNMQVJFXG4gICAgICAgIHRhYmxlX25hbWUgVEVYVDtcbiAgICAgIEJFR0lOXG4gICAgICAgIC0tIExvb3AgdGhyb3VnaCBhbGwgdGFibGVzIGluIHRoZSBzY2hlbWFcbiAgICAgICAgRk9SIHRhYmxlX25hbWUgSU5cbiAgICAgICAgICBTRUxFQ1QgdGFibGVfbmFtZSBcbiAgICAgICAgICBGUk9NIGluZm9ybWF0aW9uX3NjaGVtYS50YWJsZXMgXG4gICAgICAgICAgV0hFUkUgdGFibGVfc2NoZW1hID0gc2NoZW1hX25hbWVcbiAgICAgICAgTE9PUFxuICAgICAgICAgIC0tIEVuYWJsZSBSTFMgZm9yIGVhY2ggdGFibGVcbiAgICAgICAgICBFWEVDVVRFIGZvcm1hdCgnQUxURVIgVEFCTEUgSUYgRVhJU1RTICVJLiVJIEVOQUJMRSBST1cgTEVWRUwgU0VDVVJJVFknLCBcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYV9uYW1lLCB0YWJsZV9uYW1lKTtcbiAgICAgICAgICBcbiAgICAgICAgICAtLSBDcmVhdGUgb3IgcmVwbGFjZSBSTFMgcG9saWN5XG4gICAgICAgICAgRVhFQ1VURSBmb3JtYXQoJ0RST1AgUE9MSUNZIElGIEVYSVNUUyB0ZW5hbnRfaXNvbGF0aW9uX3BvbGljeSBPTiAlSS4lSScsIFxuICAgICAgICAgICAgICAgICAgICAgICAgc2NoZW1hX25hbWUsIHRhYmxlX25hbWUpO1xuICAgICAgICAgIFxuICAgICAgICAgIEVYRUNVVEUgZm9ybWF0KCdDUkVBVEUgUE9MSUNZIHRlbmFudF9pc29sYXRpb25fcG9saWN5IE9OICVJLiVJIFxuICAgICAgICAgICAgICAgICAgICAgICAgICBVU0lORyAodGVuYW50X2lkID0gJUwpXG4gICAgICAgICAgICAgICAgICAgICAgICAgIFdJVEggQ0hFQ0sgKHRlbmFudF9pZCA9ICVMKScsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICBzY2hlbWFfbmFtZSwgdGFibGVfbmFtZSwgdGVuYW50X2lkLCB0ZW5hbnRfaWQpO1xuICAgICAgICBFTkQgTE9PUDtcbiAgICAgIEVORDtcbiAgICAgICQkIExBTkdVQUdFIHBscGdzcWw7XG4gICAgYDtcbiAgICBcbiAgICAvLyBUcnkgdG8gY3JlYXRlIHRoZSBmdW5jdGlvblxuICAgIHRyeSB7XG4gICAgICBhd2FpdCBwb29sLnF1ZXJ5KGNyZWF0ZUZ1bmN0aW9uUXVlcnkpO1xuICAgICAgbG9nZ2VyLmluZm8oJ1tJbml0RGJFbnZdIENyZWF0ZWQgUkxTIHNldHVwIGZ1bmN0aW9uJyk7XG4gICAgfSBjYXRjaCAoZnVuY0Vycm9yKSB7XG4gICAgICBsb2dnZXIud2FybignW0luaXREYkVudl0gRXJyb3IgY3JlYXRpbmcgUkxTIGZ1bmN0aW9uIChtYXkgYWxyZWFkeSBleGlzdCk6JywgZnVuY0Vycm9yLm1lc3NhZ2UpO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIG1lc3NhZ2U6ICdEYXRhYmFzZSBlbnZpcm9ubWVudCBpbml0aWFsaXplZCBzdWNjZXNzZnVsbHknLFxuICAgICAgdGFibGVFeGlzdHMsXG4gICAgICB0YWJsZVN0cnVjdHVyZTogc3RydWN0dXJlUmVzdWx0LnJvd3MsXG4gICAgICBkYkNvbmZpZzoge1xuICAgICAgICBob3N0OiBnZXREYkNvbmZpZygpLmhvc3QsXG4gICAgICAgIHBvcnQ6IGdldERiQ29uZmlnKCkucG9ydCxcbiAgICAgICAgZGF0YWJhc2U6IGdldERiQ29uZmlnKCkuZGF0YWJhc2UsXG4gICAgICAgIHVzZXI6IGdldERiQ29uZmlnKCkudXNlclxuICAgICAgfVxuICAgIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGxvZ2dlci5lcnJvcignW0luaXREYkVudl0gRXJyb3IgaW5pdGlhbGl6aW5nIGRhdGFiYXNlIGVudmlyb25tZW50OicsIGVycm9yKTtcbiAgICBcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcbiAgICAgIGNvZGU6IGVycm9yLmNvZGUsXG4gICAgICBkZXRhaWw6IGVycm9yLmRldGFpbCxcbiAgICAgIG1lc3NhZ2U6ICdGYWlsZWQgdG8gaW5pdGlhbGl6ZSBkYXRhYmFzZSBlbnZpcm9ubWVudCdcbiAgICB9LCB7IHN0YXR1czogNTAwIH0pO1xuICB9IGZpbmFsbHkge1xuICAgIGlmIChwb29sKSB7XG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCBwb29sLmVuZCgpO1xuICAgICAgICBsb2dnZXIuaW5mbygnW0luaXREYkVudl0gRGF0YWJhc2UgY29ubmVjdGlvbiBjbG9zZWQnKTtcbiAgICAgIH0gY2F0Y2ggKGNsb3NlRXJyb3IpIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKCdbSW5pdERiRW52XSBFcnJvciBjbG9zaW5nIHBvb2w6JywgY2xvc2VFcnJvci5tZXNzYWdlKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn0iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwibG9nZ2VyIiwiY3JlYXRlRGJQb29sIiwiZ2V0RGJDb25maWciLCJHRVQiLCJyZXF1ZXN0IiwicG9vbCIsImluZm8iLCJjaGVja1RhYmxlUXVlcnkiLCJjaGVja1Jlc3VsdCIsInF1ZXJ5IiwidGFibGVFeGlzdHMiLCJyb3dzIiwiZXhpc3RzIiwiY3JlYXRlVGFibGVRdWVyeSIsInRhYmxlU3RydWN0dXJlUXVlcnkiLCJzdHJ1Y3R1cmVSZXN1bHQiLCJjcmVhdGVJbmRleFF1ZXJ5IiwiY3JlYXRlRnVuY3Rpb25RdWVyeSIsImZ1bmNFcnJvciIsIndhcm4iLCJtZXNzYWdlIiwianNvbiIsInN1Y2Nlc3MiLCJ0YWJsZVN0cnVjdHVyZSIsImRiQ29uZmlnIiwiaG9zdCIsInBvcnQiLCJkYXRhYmFzZSIsInVzZXIiLCJlcnJvciIsImNvZGUiLCJkZXRhaWwiLCJzdGF0dXMiLCJlbmQiLCJjbG9zZUVycm9yIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/tenant/init-db-env/route.js\n");

/***/ }),

/***/ "(rsc)/./src/utils/serverLogger.js":
/*!***********************************!*\
  !*** ./src/utils/serverLogger.js ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createContextualServerLogger: () => (/* binding */ createContextualServerLogger),\n/* harmony export */   createServerLogger: () => (/* binding */ createServerLogger),\n/* harmony export */   debug: () => (/* binding */ debug),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   error: () => (/* binding */ error),\n/* harmony export */   info: () => (/* binding */ info),\n/* harmony export */   logger: () => (/* binding */ logger),\n/* harmony export */   serverLogger: () => (/* binding */ serverLogger),\n/* harmony export */   warn: () => (/* binding */ warn)\n/* harmony export */ });\n// Server-side logger implementation\n// This file should be imported in API routes instead of the client-side logger\n/**\n * Server-side logger utility\n * \n * This logger is specifically designed for server components and API routes\n * where the client-side logger with browser-specific APIs can't be used.\n */ /**\n * Format log prefix to include timestamp and context\n */ function formatPrefix(level, context = {}) {\n    const timestamp = new Date().toISOString();\n    const tenantId = context.tenantId || 'no-tenant';\n    return `[${timestamp}] [SERVER:${level}] [${tenantId}]`;\n}\n/**\n * Server logger instance with standard logging methods\n */ const serverLogger = {\n    /**\n   * Log at DEBUG level\n   */ debug: (message, data, context = {})=>{\n        const prefix = formatPrefix('DEBUG', context);\n        if (data !== undefined) {\n            console.debug(`${prefix} ${message}`, data);\n        } else {\n            console.debug(`${prefix} ${message}`);\n        }\n    },\n    /**\n   * Log at INFO level\n   */ info: (message, data, context = {})=>{\n        const prefix = formatPrefix('INFO', context);\n        if (data !== undefined) {\n            console.info(`${prefix} ${message}`, data);\n        } else {\n            console.info(`${prefix} ${message}`);\n        }\n    },\n    /**\n   * Log at WARN level\n   */ warn: (message, data, context = {})=>{\n        const prefix = formatPrefix('WARN', context);\n        if (data !== undefined) {\n            console.warn(`${prefix} ${message}`, data);\n        } else {\n            console.warn(`${prefix} ${message}`);\n        }\n    },\n    /**\n   * Log at ERROR level\n   */ error: (message, data, context = {})=>{\n        const prefix = formatPrefix('ERROR', context);\n        if (data !== undefined) {\n            console.error(`${prefix} ${message}`, data);\n        } else {\n            console.error(`${prefix} ${message}`);\n        }\n    }\n};\n/**\n * Create a contextualized server logger with pre-bound context\n */ function createContextualServerLogger(context = {}) {\n    return {\n        debug: (message, data)=>serverLogger.debug(message, data, context),\n        info: (message, data)=>serverLogger.info(message, data, context),\n        warn: (message, data)=>serverLogger.warn(message, data, context),\n        error: (message, data)=>serverLogger.error(message, data, context)\n    };\n}\n/**\n * Legacy function for backward compatibility with existing imports\n * Creates a logger with a namespace\n */ function createServerLogger(namespace = 'API') {\n    return {\n        debug: (message, ...args)=>serverLogger.debug(`[${namespace}] ${message}`, args.length ? args[0] : undefined),\n        info: (message, ...args)=>serverLogger.info(`[${namespace}] ${message}`, args.length ? args[0] : undefined),\n        warn: (message, ...args)=>serverLogger.warn(`[${namespace}] ${message}`, args.length ? args[0] : undefined),\n        error: (message, ...args)=>serverLogger.error(`[${namespace}] ${message}`, args.length ? args[0] : undefined),\n        log: (message, ...args)=>serverLogger.info(`[${namespace}] ${message}`, args.length ? args[0] : undefined)\n    };\n}\n// Create a default server logger instance for compatibility with existing imports\nconst logger = createServerLogger('API');\n// Export individual functions directly from serverLogger for convenience\nconst debug = serverLogger.debug;\nconst info = serverLogger.info;\nconst warn = serverLogger.warn;\nconst error = serverLogger.error;\n// For CommonJS compatibility\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({\n    serverLogger,\n    logger,\n    debug,\n    info,\n    warn,\n    error,\n    createContextualServerLogger,\n    createServerLogger\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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U0FBUyxHQUFHVyxPQUFTYixhQUFhTyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUVLLFVBQVUsRUFBRSxFQUFFVixTQUFTLEVBQUVXLEtBQUtDLE1BQU0sR0FBR0QsSUFBSSxDQUFDLEVBQUUsR0FBR1I7UUFDbkdHLE1BQU0sQ0FBQ04sU0FBUyxHQUFHVyxPQUFTYixhQUFhUSxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUVJLFVBQVUsRUFBRSxFQUFFVixTQUFTLEVBQUVXLEtBQUtDLE1BQU0sR0FBR0QsSUFBSSxDQUFDLEVBQUUsR0FBR1I7UUFDbkdJLE9BQU8sQ0FBQ1AsU0FBUyxHQUFHVyxPQUFTYixhQUFhUyxLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUVHLFVBQVUsRUFBRSxFQUFFVixTQUFTLEVBQUVXLEtBQUtDLE1BQU0sR0FBR0QsSUFBSSxDQUFDLEVBQUUsR0FBR1I7UUFDckdVLEtBQUssQ0FBQ2IsU0FBUyxHQUFHVyxPQUFTYixhQUFhTyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUVLLFVBQVUsRUFBRSxFQUFFVixTQUFTLEVBQUVXLEtBQUtDLE1BQU0sR0FBR0QsSUFBSSxDQUFDLEVBQUUsR0FBR1I7SUFDcEc7QUFDRjtBQUVBLGtGQUFrRjtBQUMzRSxNQUFNVyxTQUFTTCxtQkFBbUIsT0FBTztBQUVoRCx5RUFBeUU7QUFDbEUsTUFBTVYsUUFBUUQsYUFBYUMsS0FBSyxDQUFDO0FBQ2pDLE1BQU1NLE9BQU9QLGFBQWFPLElBQUksQ0FBQztBQUMvQixNQUFNQyxPQUFPUixhQUFhUSxJQUFJLENBQUM7QUFDL0IsTUFBTUMsUUFBUVQsYUFBYVMsS0FBSyxDQUFDO0FBRXhDLDZCQUE2QjtBQUM3QixpRUFBZTtJQUNiVDtJQUNBZ0I7SUFDQWY7SUFDQU07SUFDQUM7SUFDQUM7SUFDQUM7SUFDQUM7QUFDRixDQUFDLEVBQUMiLCJzb3VyY2VzIjpbIi9Vc2Vycy9rdW9sZGVuZy9wcm9qZWN0eC9mcm9udGVuZC9weWZhY3Rvcl9uZXh0L3NyYy91dGlscy9zZXJ2ZXJMb2dnZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gU2VydmVyLXNpZGUgbG9nZ2VyIGltcGxlbWVudGF0aW9uXG4vLyBUaGlzIGZpbGUgc2hvdWxkIGJlIGltcG9ydGVkIGluIEFQSSByb3V0ZXMgaW5zdGVhZCBvZiB0aGUgY2xpZW50LXNpZGUgbG9nZ2VyXG5cbi8qKlxuICogU2VydmVyLXNpZGUgbG9nZ2VyIHV0aWxpdHlcbiAqIFxuICogVGhpcyBsb2dnZXIgaXMgc3BlY2lmaWNhbGx5IGRlc2lnbmVkIGZvciBzZXJ2ZXIgY29tcG9uZW50cyBhbmQgQVBJIHJvdXRlc1xuICogd2hlcmUgdGhlIGNsaWVudC1zaWRlIGxvZ2dlciB3aXRoIGJyb3dzZXItc3BlY2lmaWMgQVBJcyBjYW4ndCBiZSB1c2VkLlxuICovXG5cbi8qKlxuICogRm9ybWF0IGxvZyBwcmVmaXggdG8gaW5jbHVkZSB0aW1lc3RhbXAgYW5kIGNvbnRleHRcbiAqL1xuZnVuY3Rpb24gZm9ybWF0UHJlZml4KGxldmVsLCBjb250ZXh0ID0ge30pIHtcbiAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xuICBjb25zdCB0ZW5hbnRJZCA9IGNvbnRleHQudGVuYW50SWQgfHwgJ25vLXRlbmFudCc7XG4gIHJldHVybiBgWyR7dGltZXN0YW1wfV0gW1NFUlZFUjoke2xldmVsfV0gWyR7dGVuYW50SWR9XWA7XG59XG5cbi8qKlxuICogU2VydmVyIGxvZ2dlciBpbnN0YW5jZSB3aXRoIHN0YW5kYXJkIGxvZ2dpbmcgbWV0aG9kc1xuICovXG5leHBvcnQgY29uc3Qgc2VydmVyTG9nZ2VyID0ge1xuICAvKipcbiAgICogTG9nIGF0IERFQlVHIGxldmVsXG4gICAqL1xuICBkZWJ1ZzogKG1lc3NhZ2UsIGRhdGEsIGNvbnRleHQgPSB7fSkgPT4ge1xuICAgIGNvbnN0IHByZWZpeCA9IGZvcm1hdFByZWZpeCgnREVCVUcnLCBjb250ZXh0KTtcbiAgICBpZiAoZGF0YSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBjb25zb2xlLmRlYnVnKGAke3ByZWZpeH0gJHttZXNzYWdlfWAsIGRhdGEpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmRlYnVnKGAke3ByZWZpeH0gJHttZXNzYWdlfWApO1xuICAgIH1cbiAgfSxcbiAgXG4gIC8qKlxuICAgKiBMb2cgYXQgSU5GTyBsZXZlbFxuICAgKi9cbiAgaW5mbzogKG1lc3NhZ2UsIGRhdGEsIGNvbnRleHQgPSB7fSkgPT4ge1xuICAgIGNvbnN0IHByZWZpeCA9IGZvcm1hdFByZWZpeCgnSU5GTycsIGNvbnRleHQpO1xuICAgIGlmIChkYXRhICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGNvbnNvbGUuaW5mbyhgJHtwcmVmaXh9ICR7bWVzc2FnZX1gLCBkYXRhKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5pbmZvKGAke3ByZWZpeH0gJHttZXNzYWdlfWApO1xuICAgIH1cbiAgfSxcbiAgXG4gIC8qKlxuICAgKiBMb2cgYXQgV0FSTiBsZXZlbFxuICAgKi9cbiAgd2FybjogKG1lc3NhZ2UsIGRhdGEsIGNvbnRleHQgPSB7fSkgPT4ge1xuICAgIGNvbnN0IHByZWZpeCA9IGZvcm1hdFByZWZpeCgnV0FSTicsIGNvbnRleHQpO1xuICAgIGlmIChkYXRhICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGNvbnNvbGUud2FybihgJHtwcmVmaXh9ICR7bWVzc2FnZX1gLCBkYXRhKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS53YXJuKGAke3ByZWZpeH0gJHttZXNzYWdlfWApO1xuICAgIH1cbiAgfSxcbiAgXG4gIC8qKlxuICAgKiBMb2cgYXQgRVJST1IgbGV2ZWxcbiAgICovXG4gIGVycm9yOiAobWVzc2FnZSwgZGF0YSwgY29udGV4dCA9IHt9KSA9PiB7XG4gICAgY29uc3QgcHJlZml4ID0gZm9ybWF0UHJlZml4KCdFUlJPUicsIGNvbnRleHQpO1xuICAgIGlmIChkYXRhICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYCR7cHJlZml4fSAke21lc3NhZ2V9YCwgZGF0YSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYCR7cHJlZml4fSAke21lc3NhZ2V9YCk7XG4gICAgfVxuICB9XG59O1xuXG4vKipcbiAqIENyZWF0ZSBhIGNvbnRleHR1YWxpemVkIHNlcnZlciBsb2dnZXIgd2l0aCBwcmUtYm91bmQgY29udGV4dFxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQ29udGV4dHVhbFNlcnZlckxvZ2dlcihjb250ZXh0ID0ge30pIHtcbiAgcmV0dXJuIHtcbiAgICBkZWJ1ZzogKG1lc3NhZ2UsIGRhdGEpID0+IHNlcnZlckxvZ2dlci5kZWJ1ZyhtZXNzYWdlLCBkYXRhLCBjb250ZXh0KSxcbiAgICBpbmZvOiAobWVzc2FnZSwgZGF0YSkgPT4gc2VydmVyTG9nZ2VyLmluZm8obWVzc2FnZSwgZGF0YSwgY29udGV4dCksXG4gICAgd2FybjogKG1lc3NhZ2UsIGRhdGEpID0+IHNlcnZlckxvZ2dlci53YXJuKG1lc3NhZ2UsIGRhdGEsIGNvbnRleHQpLFxuICAgIGVycm9yOiAobWVzc2FnZSwgZGF0YSkgPT4gc2VydmVyTG9nZ2VyLmVycm9yKG1lc3NhZ2UsIGRhdGEsIGNvbnRleHQpXG4gIH07XG59XG5cbi8qKlxuICogTGVnYWN5IGZ1bmN0aW9uIGZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5IHdpdGggZXhpc3RpbmcgaW1wb3J0c1xuICogQ3JlYXRlcyBhIGxvZ2dlciB3aXRoIGEgbmFtZXNwYWNlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVTZXJ2ZXJMb2dnZXIobmFtZXNwYWNlID0gJ0FQSScpIHtcbiAgcmV0dXJuIHtcbiAgICBkZWJ1ZzogKG1lc3NhZ2UsIC4uLmFyZ3MpID0+IHNlcnZlckxvZ2dlci5kZWJ1ZyhgWyR7bmFtZXNwYWNlfV0gJHttZXNzYWdlfWAsIGFyZ3MubGVuZ3RoID8gYXJnc1swXSA6IHVuZGVmaW5lZCksXG4gICAgaW5mbzogKG1lc3NhZ2UsIC4uLmFyZ3MpID0+IHNlcnZlckxvZ2dlci5pbmZvKGBbJHtuYW1lc3BhY2V9XSAke21lc3NhZ2V9YCwgYXJncy5sZW5ndGggPyBhcmdzWzBdIDogdW5kZWZpbmVkKSxcbiAgICB3YXJuOiAobWVzc2FnZSwgLi4uYXJncykgPT4gc2VydmVyTG9nZ2VyLndhcm4oYFske25hbWVzcGFjZX1dICR7bWVzc2FnZX1gLCBhcmdzLmxlbmd0aCA/IGFyZ3NbMF0gOiB1bmRlZmluZWQpLFxuICAgIGVycm9yOiAobWVzc2FnZSwgLi4uYXJncykgPT4gc2VydmVyTG9nZ2VyLmVycm9yKGBbJHtuYW1lc3BhY2V9XSAke21lc3NhZ2V9YCwgYXJncy5sZW5ndGggPyBhcmdzWzBdIDogdW5kZWZpbmVkKSxcbiAgICBsb2c6IChtZXNzYWdlLCAuLi5hcmdzKSA9PiBzZXJ2ZXJMb2dnZXIuaW5mbyhgWyR7bmFtZXNwYWNlfV0gJHttZXNzYWdlfWAsIGFyZ3MubGVuZ3RoID8gYXJnc1swXSA6IHVuZGVmaW5lZClcbiAgfTtcbn1cblxuLy8gQ3JlYXRlIGEgZGVmYXVsdCBzZXJ2ZXIgbG9nZ2VyIGluc3RhbmNlIGZvciBjb21wYXRpYmlsaXR5IHdpdGggZXhpc3RpbmcgaW1wb3J0c1xuZXhwb3J0IGNvbnN0IGxvZ2dlciA9IGNyZWF0ZVNlcnZlckxvZ2dlcignQVBJJyk7XG5cbi8vIEV4cG9ydCBpbmRpdmlkdWFsIGZ1bmN0aW9ucyBkaXJlY3RseSBmcm9tIHNlcnZlckxvZ2dlciBmb3IgY29udmVuaWVuY2VcbmV4cG9ydCBjb25zdCBkZWJ1ZyA9IHNlcnZlckxvZ2dlci5kZWJ1ZztcbmV4cG9ydCBjb25zdCBpbmZvID0gc2VydmVyTG9nZ2VyLmluZm87XG5leHBvcnQgY29uc3Qgd2FybiA9IHNlcnZlckxvZ2dlci53YXJuO1xuZXhwb3J0IGNvbnN0IGVycm9yID0gc2VydmVyTG9nZ2VyLmVycm9yO1xuXG4vLyBGb3IgQ29tbW9uSlMgY29tcGF0aWJpbGl0eVxuZXhwb3J0IGRlZmF1bHQge1xuICBzZXJ2ZXJMb2dnZXIsXG4gIGxvZ2dlcixcbiAgZGVidWcsIFxuICBpbmZvLFxuICB3YXJuLFxuICBlcnJvcixcbiAgY3JlYXRlQ29udGV4dHVhbFNlcnZlckxvZ2dlcixcbiAgY3JlYXRlU2VydmVyTG9nZ2VyXG59OyAiXSwibmFtZXMiOlsiZm9ybWF0UHJlZml4IiwibGV2ZWwiLCJjb250ZXh0IiwidGltZXN0YW1wIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwidGVuYW50SWQiLCJzZXJ2ZXJMb2dnZXIiLCJkZWJ1ZyIsIm1lc3NhZ2UiLCJkYXRhIiwicHJlZml4IiwidW5kZWZpbmVkIiwiY29uc29sZSIsImluZm8iLCJ3YXJuIiwiZXJyb3IiLCJjcmVhdGVDb250ZXh0dWFsU2VydmVyTG9nZ2VyIiwiY3JlYXRlU2VydmVyTG9nZ2VyIiwibmFtZXNwYWNlIiwiYXJncyIsImxlbmd0aCIsImxvZyIsImxvZ2dlciJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/utils/serverLogger.js\n");

/***/ }),

/***/ "(ssr)/../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!*******************************************************************************************************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \*******************************************************************************************************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "../app-render/work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

"use strict";
module.exports = require("@prisma/client");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "pg":
/*!*********************!*\
  !*** external "pg" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("pg");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1"], () => (__webpack_exec__("(rsc)/../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Ftenant%2Finit-db-env%2Froute&page=%2Fapi%2Ftenant%2Finit-db-env%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftenant%2Finit-db-env%2Froute.js&appDir=%2FUsers%2Fkuoldeng%2Fprojectx%2Ffrontend%2Fpyfactor_next%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fkuoldeng%2Fprojectx%2Ffrontend%2Fpyfactor_next&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();