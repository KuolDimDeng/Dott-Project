/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/tenant/ensure-db-record/route";
exports.ids = ["app/api/tenant/ensure-db-record/route"];
exports.modules = {

/***/ "(rsc)/../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Ftenant%2Fensure-db-record%2Froute&page=%2Fapi%2Ftenant%2Fensure-db-record%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftenant%2Fensure-db-record%2Froute.js&appDir=%2FUsers%2Fkuoldeng%2Fprojectx%2Ffrontend%2Fpyfactor_next%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fkuoldeng%2Fprojectx%2Ffrontend%2Fpyfactor_next&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Ftenant%2Fensure-db-record%2Froute&page=%2Fapi%2Ftenant%2Fensure-db-record%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftenant%2Fensure-db-record%2Froute.js&appDir=%2FUsers%2Fkuoldeng%2Fprojectx%2Ffrontend%2Fpyfactor_next%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fkuoldeng%2Fprojectx%2Ffrontend%2Fpyfactor_next&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_kuoldeng_projectx_frontend_pyfactor_next_src_app_api_tenant_ensure_db_record_route_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/tenant/ensure-db-record/route.js */ \"(rsc)/./src/app/api/tenant/ensure-db-record/route.js\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/tenant/ensure-db-record/route\",\n        pathname: \"/api/tenant/ensure-db-record\",\n        filename: \"route\",\n        bundlePath: \"app/api/tenant/ensure-db-record/route\"\n    },\n    resolvedPagePath: \"/Users/kuoldeng/projectx/frontend/pyfactor_next/src/app/api/tenant/ensure-db-record/route.js\",\n    nextConfigOutput,\n    userland: _Users_kuoldeng_projectx_frontend_pyfactor_next_src_app_api_tenant_ensure_db_record_route_js__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL25leHRAMTUuMi4yX0BiYWJlbCtjb3JlQDcuMjYuMTBfcmVhY3QtZG9tQDE4LjMuMV9yZWFjdEAxOC4zLjEvbm9kZV9tb2R1bGVzL25leHQvZGlzdC9idWlsZC93ZWJwYWNrL2xvYWRlcnMvbmV4dC1hcHAtbG9hZGVyL2luZGV4LmpzP25hbWU9YXBwJTJGYXBpJTJGdGVuYW50JTJGZW5zdXJlLWRiLXJlY29yZCUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGdGVuYW50JTJGZW5zdXJlLWRiLXJlY29yZCUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRnRlbmFudCUyRmVuc3VyZS1kYi1yZWNvcmQlMkZyb3V0ZS5qcyZhcHBEaXI9JTJGVXNlcnMlMkZrdW9sZGVuZyUyRnByb2plY3R4JTJGZnJvbnRlbmQlMkZweWZhY3Rvcl9uZXh0JTJGc3JjJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRmt1b2xkZW5nJTJGcHJvamVjdHglMkZmcm9udGVuZCUyRnB5ZmFjdG9yX25leHQmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQStGO0FBQ3ZDO0FBQ3FCO0FBQzRDO0FBQ3pIO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix5R0FBbUI7QUFDM0M7QUFDQSxjQUFjLGtFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsc0RBQXNEO0FBQzlEO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQzBGOztBQUUxRiIsInNvdXJjZXMiOlsiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvVXNlcnMva3VvbGRlbmcvcHJvamVjdHgvZnJvbnRlbmQvcHlmYWN0b3JfbmV4dC9zcmMvYXBwL2FwaS90ZW5hbnQvZW5zdXJlLWRiLXJlY29yZC9yb3V0ZS5qc1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvdGVuYW50L2Vuc3VyZS1kYi1yZWNvcmQvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS90ZW5hbnQvZW5zdXJlLWRiLXJlY29yZFwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvdGVuYW50L2Vuc3VyZS1kYi1yZWNvcmQvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvVXNlcnMva3VvbGRlbmcvcHJvamVjdHgvZnJvbnRlbmQvcHlmYWN0b3JfbmV4dC9zcmMvYXBwL2FwaS90ZW5hbnQvZW5zdXJlLWRiLXJlY29yZC9yb3V0ZS5qc1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHdvcmtBc3luY1N0b3JhZ2UsIHdvcmtVbml0QXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHdvcmtBc3luY1N0b3JhZ2UsXG4gICAgICAgIHdvcmtVbml0QXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgd29ya0FzeW5jU3RvcmFnZSwgd29ya1VuaXRBc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Ftenant%2Fensure-db-record%2Froute&page=%2Fapi%2Ftenant%2Fensure-db-record%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftenant%2Fensure-db-record%2Froute.js&appDir=%2FUsers%2Fkuoldeng%2Fprojectx%2Ffrontend%2Fpyfactor_next%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fkuoldeng%2Fprojectx%2Ffrontend%2Fpyfactor_next&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!*******************************************************************************************************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \*******************************************************************************************************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./src/app/api/tenant/db-config.js":
/*!*****************************************!*\
  !*** ./src/app/api/tenant/db-config.js ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createDbPool: () => (/* binding */ createDbPool),\n/* harmony export */   disconnectAllClients: () => (/* binding */ disconnectAllClients),\n/* harmony export */   getDbConfig: () => (/* binding */ getDbConfig),\n/* harmony export */   getPrismaClient: () => (/* binding */ getPrismaClient),\n/* harmony export */   testDbConnection: () => (/* binding */ testDbConnection)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n/**\n * Database configuration for all tenant-related endpoints\n * Provides consistent connection settings with AWS RDS\n */ \n// Cache for Prisma clients to avoid creating multiple connections\nconst prismaClients = {};\n// Connection settings optimized for AWS RDS\nconst DB_DEFAULTS = {\n    port: 5432,\n    database: 'dott_main',\n    // Connection settings - increase timeouts to prevent client-side aborts\n    connectionTimeoutMillis: 15000,\n    statement_timeout: 30000,\n    query_timeout: 30000,\n    max: 5,\n    idleTimeoutMillis: 10000,\n    // Added connection retry logic\n    retryAttempts: 3,\n    retryDelay: 1000 // 1 second between retry attempts\n};\n/**\n * Get database configuration with fallbacks\n * This ensures consistent settings across all endpoints\n * @returns {object} Database configuration\n */ function getDbConfig() {\n    console.log('Using AWS RDS database connection');\n    // Check if SSL should be disabled\n    const useSSL = process.env.DB_USE_SSL !== 'false';\n    // Base configuration using environment variables with fallbacks for AWS RDS\n    const config = {\n        user: process.env.RDS_USERNAME || process.env.DB_USER || process.env.DJANGO_DB_USER || 'dott_admin',\n        password: process.env.RDS_PASSWORD || process.env.DB_PASSWORD || process.env.DJANGO_DB_PASSWORD || 'RRfXU6uPPUbBEg1JqGTJ',\n        host: process.env.RDS_HOSTNAME || process.env.DB_HOST || process.env.DJANGO_DB_HOST || 'dott-dev.c12qgo6m085e.us-east-1.rds.amazonaws.com',\n        port: parseInt(process.env.RDS_PORT || process.env.DB_PORT || process.env.DJANGO_DB_PORT || DB_DEFAULTS.port, 10),\n        database: process.env.RDS_DB_NAME || process.env.DB_NAME || process.env.DJANGO_DB_NAME || 'dott_main',\n        // Connection settings\n        connectionTimeoutMillis: DB_DEFAULTS.connectionTimeoutMillis,\n        statement_timeout: DB_DEFAULTS.statement_timeout,\n        max: DB_DEFAULTS.max,\n        idleTimeoutMillis: DB_DEFAULTS.idleTimeoutMillis\n    };\n    // Log connection details (without password)\n    console.log('AWS RDS connection details:', {\n        host: config.host,\n        database: config.database,\n        user: config.user,\n        port: config.port\n    });\n    // Always add SSL configuration for AWS RDS unless explicitly disabled\n    if (useSSL) {\n        config.ssl = {\n            rejectUnauthorized: false // Allow self-signed certs for AWS RDS\n        };\n    }\n    return config;\n}\n/**\n * Create a database pool with proper error handlers\n * @returns {Pool} Database connection pool\n */ async function createDbPool() {\n    const { Pool } = __webpack_require__(/*! pg */ \"pg\");\n    const config = getDbConfig();\n    try {\n        console.log('[DB] Creating database pool with config:', {\n            host: config.host,\n            port: config.port,\n            database: config.database,\n            user: config.user,\n            ssl: config.ssl ? 'enabled' : 'disabled',\n            connectionTimeoutMillis: config.connectionTimeoutMillis,\n            max: config.max\n        });\n        const pool = new Pool(config);\n        // Add error handler to prevent uncaught exceptions\n        pool.on('error', (err)=>{\n            // Log full error details for debugging\n            console.error('[DB] Pool error event:', {\n                message: err.message,\n                code: err.code,\n                severity: err.severity,\n                detail: err.detail,\n                hint: err.hint,\n                where: err.where,\n                stack: err.stack\n            });\n        // Don't crash on connection errors\n        });\n        // Test connection to verify settings\n        console.log('[DB] Attempting to get client from pool...');\n        // Implement retry logic for initial connection\n        let client = null;\n        let lastError = null;\n        let attemptCount = 0;\n        while(attemptCount < DB_DEFAULTS.retryAttempts){\n            try {\n                attemptCount++;\n                console.log(`[DB] Connection attempt ${attemptCount}/${DB_DEFAULTS.retryAttempts}...`);\n                client = await pool.connect();\n                // If we got here, connection successful - break retry loop\n                console.log('[DB] Client connected successfully');\n                break;\n            } catch (connectionError) {\n                lastError = connectionError;\n                console.error(`[DB] Connection attempt ${attemptCount} failed:`, {\n                    message: connectionError.message,\n                    code: connectionError.code\n                });\n                // Don't wait on the last attempt\n                if (attemptCount < DB_DEFAULTS.retryAttempts) {\n                    console.log(`[DB] Waiting ${DB_DEFAULTS.retryDelay}ms before retry...`);\n                    await new Promise((resolve)=>setTimeout(resolve, DB_DEFAULTS.retryDelay));\n                }\n            }\n        }\n        // If all connection attempts failed, throw the last error\n        if (!client) {\n            throw lastError || new Error('Failed to connect to database after multiple attempts');\n        }\n        try {\n            console.log('[DB] Running test query...');\n            const testResult = await client.query('SELECT 1 as connection_test');\n            console.log('[DB] Database connection test successful', {\n                host: config.host,\n                database: config.database,\n                timestamp: new Date().toISOString(),\n                result: testResult.rows[0]\n            });\n        } catch (queryError) {\n            console.error('[DB] Test query failed:', {\n                message: queryError.message,\n                code: queryError.code,\n                severity: queryError.severity,\n                detail: queryError.detail\n            });\n            throw queryError;\n        } finally{\n            if (client) client.release();\n        }\n        return pool;\n    } catch (error) {\n        console.error('[DB] Error creating database pool:', {\n            message: error.message,\n            code: error.code,\n            severity: error.severity,\n            detail: error.detail\n        });\n        throw error; // Rethrow original error for proper handling\n    }\n}\n/**\n * Test database connection and return status\n * @returns {object} Connection test result\n */ async function testDbConnection() {\n    let pool = null;\n    try {\n        pool = await createDbPool();\n        const result = await pool.query('SELECT 1 as connection_test');\n        const config = getDbConfig();\n        return {\n            success: true,\n            connected: result.rows[0].connection_test === 1,\n            // Only include non-sensitive configuration details\n            config: {\n                host: config.host,\n                database: config.database,\n                port: config.port,\n                ssl: config.ssl ? 'enabled' : 'disabled'\n            },\n            database: 'aws_rds'\n        };\n    } catch (error) {\n        const config = getDbConfig();\n        return {\n            success: false,\n            error: error.message,\n            code: error.code,\n            // Only include non-sensitive configuration details\n            config: {\n                host: config.host,\n                database: config.database,\n                port: config.port,\n                ssl: config.ssl ? 'enabled' : 'disabled'\n            },\n            database: 'aws_rds'\n        };\n    } finally{\n        if (pool) await pool.end();\n    }\n}\n/**\n * Get a Prisma client for a specific schema\n * @param {string} schema - The schema name to connect to\n * @returns {PrismaClient} A Prisma client connected to the specified schema\n */ async function getPrismaClient(schema = 'public') {\n    try {\n        // Return cached client if it exists\n        if (prismaClients[schema]) {\n            console.log(`Using cached Prisma client for schema: ${schema}`);\n            return prismaClients[schema];\n        }\n        console.log(`Creating new Prisma client for schema: ${schema}`);\n        // Get appropriate database URL\n        const dbUrl = process.env.DATABASE_URL || `postgresql://dott_admin:${process.env.DB_PASSWORD || 'RRfXU6uPPUbBEg1JqGTJ'}@dott-dev.c12qgo6m085e.us-east-1.rds.amazonaws.com:5432/dott_main?schema=${schema}`;\n        console.log(`Using database URL: ${dbUrl.replace(/:[^:]*@/, ':***@')}`);\n        // Create a new Prisma client with the schema connection\n        const prisma = new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n            datasources: {\n                db: {\n                    url: dbUrl\n                }\n            },\n            // Add logging in development\n            log:  true ? [\n                {\n                    level: 'query',\n                    emit: 'event'\n                },\n                {\n                    level: 'error',\n                    emit: 'stdout'\n                },\n                {\n                    level: 'warn',\n                    emit: 'stdout'\n                }\n            ] : 0\n        });\n        // Add query logging in development\n        if (true) {\n            prisma.$on('query', (e)=>{\n                console.log(`[Prisma Query] ${e.query} (${e.duration}ms)`);\n            });\n        }\n        // Cache the client\n        prismaClients[schema] = prisma;\n        // Test the connection\n        try {\n            await prisma.$connect();\n            console.log(`Successfully connected to database schema: ${schema}`);\n            // Execute a simple query to verify\n            const result = await prisma.$queryRaw`SELECT 1 as connection_test`;\n            console.log(`Prisma connection test successful: ${JSON.stringify(result)}`);\n            return prisma;\n        } catch (error) {\n            console.error(`Failed to connect to database schema ${schema}:`, {\n                message: error.message,\n                code: error.code,\n                stack: error.stack\n            });\n            // Remove from cache if connection failed\n            delete prismaClients[schema];\n            throw error;\n        }\n    } catch (error) {\n        console.error(`Error setting up Prisma client for schema ${schema}:`, error);\n        throw error;\n    }\n}\n/**\n * Clean up all Prisma clients on server shutdown\n */ async function disconnectAllClients() {\n    for(const schema in prismaClients){\n        try {\n            await prismaClients[schema].$disconnect();\n            console.log(`Disconnected from schema: ${schema}`);\n        } catch (error) {\n            console.error(`Error disconnecting from schema ${schema}:`, error);\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFNTyxLQUFLO1lBQ3BCO1lBRUEseUNBQXlDO1lBQ3pDLE9BQU9yRCxhQUFhLENBQUM4RSxPQUFPO1lBQzVCLE1BQU1oQztRQUNSO0lBQ0YsRUFBRSxPQUFPQSxPQUFPO1FBQ2RsQyxRQUFRa0MsS0FBSyxDQUFDLENBQUMsMENBQTBDLEVBQUVnQyxPQUFPLENBQUMsQ0FBQyxFQUFFaEM7UUFDdEUsTUFBTUE7SUFDUjtBQUNGO0FBRUE7O0NBRUMsR0FDTSxlQUFla0Q7SUFDcEIsSUFBSyxNQUFNbEIsVUFBVTlFLGNBQWU7UUFDbEMsSUFBSTtZQUNGLE1BQU1BLGFBQWEsQ0FBQzhFLE9BQU8sQ0FBQ21CLFdBQVc7WUFDdkNyRixRQUFRQyxHQUFHLENBQUMsQ0FBQywwQkFBMEIsRUFBRWlFLFFBQVE7UUFDbkQsRUFBRSxPQUFPaEMsT0FBTztZQUNkbEMsUUFBUWtDLEtBQUssQ0FBQyxDQUFDLGdDQUFnQyxFQUFFZ0MsT0FBTyxDQUFDLENBQUMsRUFBRWhDO1FBQzlEO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsiL1VzZXJzL2t1b2xkZW5nL3Byb2plY3R4L2Zyb250ZW5kL3B5ZmFjdG9yX25leHQvc3JjL2FwcC9hcGkvdGVuYW50L2RiLWNvbmZpZy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIERhdGFiYXNlIGNvbmZpZ3VyYXRpb24gZm9yIGFsbCB0ZW5hbnQtcmVsYXRlZCBlbmRwb2ludHNcbiAqIFByb3ZpZGVzIGNvbnNpc3RlbnQgY29ubmVjdGlvbiBzZXR0aW5ncyB3aXRoIEFXUyBSRFNcbiAqL1xuXG5pbXBvcnQgeyBQcmlzbWFDbGllbnQgfSBmcm9tICdAcHJpc21hL2NsaWVudCc7XG5cbi8vIENhY2hlIGZvciBQcmlzbWEgY2xpZW50cyB0byBhdm9pZCBjcmVhdGluZyBtdWx0aXBsZSBjb25uZWN0aW9uc1xuY29uc3QgcHJpc21hQ2xpZW50cyA9IHt9O1xuXG4vLyBDb25uZWN0aW9uIHNldHRpbmdzIG9wdGltaXplZCBmb3IgQVdTIFJEU1xuY29uc3QgREJfREVGQVVMVFMgPSB7XG4gIHBvcnQ6IDU0MzIsXG4gIGRhdGFiYXNlOiAnZG90dF9tYWluJyxcbiAgLy8gQ29ubmVjdGlvbiBzZXR0aW5ncyAtIGluY3JlYXNlIHRpbWVvdXRzIHRvIHByZXZlbnQgY2xpZW50LXNpZGUgYWJvcnRzXG4gIGNvbm5lY3Rpb25UaW1lb3V0TWlsbGlzOiAxNTAwMCwgLy8gSW5jcmVhc2VkIGZyb20gODAwMFxuICBzdGF0ZW1lbnRfdGltZW91dDogMzAwMDAsIC8vIEluY3JlYXNlZCBmcm9tIDE1MDAwXG4gIHF1ZXJ5X3RpbWVvdXQ6IDMwMDAwLCAvLyBBZGRlZCBleHBsaWNpdCBxdWVyeSB0aW1lb3V0XG4gIG1heDogNSwgLy8gSW5jcmVhc2VkIGZyb20gMSB0byBhbGxvdyBtb3JlIGNvbmN1cnJlbnQgY29ubmVjdGlvbnNcbiAgaWRsZVRpbWVvdXRNaWxsaXM6IDEwMDAwLCAvLyBJbmNyZWFzZWQgZnJvbSAzMDAwXG4gIC8vIEFkZGVkIGNvbm5lY3Rpb24gcmV0cnkgbG9naWNcbiAgcmV0cnlBdHRlbXB0czogMyxcbiAgcmV0cnlEZWxheTogMTAwMCAvLyAxIHNlY29uZCBiZXR3ZWVuIHJldHJ5IGF0dGVtcHRzXG59O1xuXG4vKipcbiAqIEdldCBkYXRhYmFzZSBjb25maWd1cmF0aW9uIHdpdGggZmFsbGJhY2tzXG4gKiBUaGlzIGVuc3VyZXMgY29uc2lzdGVudCBzZXR0aW5ncyBhY3Jvc3MgYWxsIGVuZHBvaW50c1xuICogQHJldHVybnMge29iamVjdH0gRGF0YWJhc2UgY29uZmlndXJhdGlvblxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RGJDb25maWcoKSB7XG4gIGNvbnNvbGUubG9nKCdVc2luZyBBV1MgUkRTIGRhdGFiYXNlIGNvbm5lY3Rpb24nKTtcbiAgXG4gIC8vIENoZWNrIGlmIFNTTCBzaG91bGQgYmUgZGlzYWJsZWRcbiAgY29uc3QgdXNlU1NMID0gcHJvY2Vzcy5lbnYuREJfVVNFX1NTTCAhPT0gJ2ZhbHNlJztcbiAgXG4gIC8vIEJhc2UgY29uZmlndXJhdGlvbiB1c2luZyBlbnZpcm9ubWVudCB2YXJpYWJsZXMgd2l0aCBmYWxsYmFja3MgZm9yIEFXUyBSRFNcbiAgY29uc3QgY29uZmlnID0ge1xuICAgIHVzZXI6IHByb2Nlc3MuZW52LlJEU19VU0VSTkFNRSB8fCBwcm9jZXNzLmVudi5EQl9VU0VSIHx8IHByb2Nlc3MuZW52LkRKQU5HT19EQl9VU0VSIHx8ICdkb3R0X2FkbWluJyxcbiAgICBwYXNzd29yZDogcHJvY2Vzcy5lbnYuUkRTX1BBU1NXT1JEIHx8IHByb2Nlc3MuZW52LkRCX1BBU1NXT1JEIHx8IHByb2Nlc3MuZW52LkRKQU5HT19EQl9QQVNTV09SRCB8fCAnUlJmWFU2dVBQVWJCRWcxSnFHVEonLFxuICAgIGhvc3Q6IHByb2Nlc3MuZW52LlJEU19IT1NUTkFNRSB8fCBwcm9jZXNzLmVudi5EQl9IT1NUIHx8IHByb2Nlc3MuZW52LkRKQU5HT19EQl9IT1NUIHx8ICdkb3R0LWRldi5jMTJxZ282bTA4NWUudXMtZWFzdC0xLnJkcy5hbWF6b25hd3MuY29tJyxcbiAgICBwb3J0OiBwYXJzZUludChwcm9jZXNzLmVudi5SRFNfUE9SVCB8fCBwcm9jZXNzLmVudi5EQl9QT1JUIHx8IHByb2Nlc3MuZW52LkRKQU5HT19EQl9QT1JUIHx8IERCX0RFRkFVTFRTLnBvcnQsIDEwKSxcbiAgICBkYXRhYmFzZTogcHJvY2Vzcy5lbnYuUkRTX0RCX05BTUUgfHwgcHJvY2Vzcy5lbnYuREJfTkFNRSB8fCBwcm9jZXNzLmVudi5ESkFOR09fREJfTkFNRSB8fCAnZG90dF9tYWluJyxcbiAgICAvLyBDb25uZWN0aW9uIHNldHRpbmdzXG4gICAgY29ubmVjdGlvblRpbWVvdXRNaWxsaXM6IERCX0RFRkFVTFRTLmNvbm5lY3Rpb25UaW1lb3V0TWlsbGlzLFxuICAgIHN0YXRlbWVudF90aW1lb3V0OiBEQl9ERUZBVUxUUy5zdGF0ZW1lbnRfdGltZW91dCxcbiAgICBtYXg6IERCX0RFRkFVTFRTLm1heCxcbiAgICBpZGxlVGltZW91dE1pbGxpczogREJfREVGQVVMVFMuaWRsZVRpbWVvdXRNaWxsaXNcbiAgfTtcbiAgXG4gIC8vIExvZyBjb25uZWN0aW9uIGRldGFpbHMgKHdpdGhvdXQgcGFzc3dvcmQpXG4gIGNvbnNvbGUubG9nKCdBV1MgUkRTIGNvbm5lY3Rpb24gZGV0YWlsczonLCB7IFxuICAgIGhvc3Q6IGNvbmZpZy5ob3N0LCBcbiAgICBkYXRhYmFzZTogY29uZmlnLmRhdGFiYXNlLCBcbiAgICB1c2VyOiBjb25maWcudXNlcixcbiAgICBwb3J0OiBjb25maWcucG9ydFxuICB9KTtcbiAgXG4gIC8vIEFsd2F5cyBhZGQgU1NMIGNvbmZpZ3VyYXRpb24gZm9yIEFXUyBSRFMgdW5sZXNzIGV4cGxpY2l0bHkgZGlzYWJsZWRcbiAgaWYgKHVzZVNTTCkge1xuICAgIGNvbmZpZy5zc2wgPSB7XG4gICAgICByZWplY3RVbmF1dGhvcml6ZWQ6IGZhbHNlIC8vIEFsbG93IHNlbGYtc2lnbmVkIGNlcnRzIGZvciBBV1MgUkRTXG4gICAgfTtcbiAgfVxuICBcbiAgcmV0dXJuIGNvbmZpZztcbn1cblxuLyoqXG4gKiBDcmVhdGUgYSBkYXRhYmFzZSBwb29sIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsZXJzXG4gKiBAcmV0dXJucyB7UG9vbH0gRGF0YWJhc2UgY29ubmVjdGlvbiBwb29sXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVEYlBvb2woKSB7XG4gIGNvbnN0IHsgUG9vbCB9ID0gcmVxdWlyZSgncGcnKTtcbiAgY29uc3QgY29uZmlnID0gZ2V0RGJDb25maWcoKTtcbiAgXG4gIHRyeSB7XG4gICAgY29uc29sZS5sb2coJ1tEQl0gQ3JlYXRpbmcgZGF0YWJhc2UgcG9vbCB3aXRoIGNvbmZpZzonLCB7XG4gICAgICBob3N0OiBjb25maWcuaG9zdCxcbiAgICAgIHBvcnQ6IGNvbmZpZy5wb3J0LFxuICAgICAgZGF0YWJhc2U6IGNvbmZpZy5kYXRhYmFzZSxcbiAgICAgIHVzZXI6IGNvbmZpZy51c2VyLFxuICAgICAgc3NsOiBjb25maWcuc3NsID8gJ2VuYWJsZWQnIDogJ2Rpc2FibGVkJyxcbiAgICAgIGNvbm5lY3Rpb25UaW1lb3V0TWlsbGlzOiBjb25maWcuY29ubmVjdGlvblRpbWVvdXRNaWxsaXMsXG4gICAgICBtYXg6IGNvbmZpZy5tYXhcbiAgICB9KTtcbiAgICBcbiAgICBjb25zdCBwb29sID0gbmV3IFBvb2woY29uZmlnKTtcbiAgICBcbiAgICAvLyBBZGQgZXJyb3IgaGFuZGxlciB0byBwcmV2ZW50IHVuY2F1Z2h0IGV4Y2VwdGlvbnNcbiAgICBwb29sLm9uKCdlcnJvcicsIChlcnIpID0+IHtcbiAgICAgIC8vIExvZyBmdWxsIGVycm9yIGRldGFpbHMgZm9yIGRlYnVnZ2luZ1xuICAgICAgY29uc29sZS5lcnJvcignW0RCXSBQb29sIGVycm9yIGV2ZW50OicsIHtcbiAgICAgICAgbWVzc2FnZTogZXJyLm1lc3NhZ2UsXG4gICAgICAgIGNvZGU6IGVyci5jb2RlLFxuICAgICAgICBzZXZlcml0eTogZXJyLnNldmVyaXR5LFxuICAgICAgICBkZXRhaWw6IGVyci5kZXRhaWwsXG4gICAgICAgIGhpbnQ6IGVyci5oaW50LFxuICAgICAgICB3aGVyZTogZXJyLndoZXJlLFxuICAgICAgICBzdGFjazogZXJyLnN0YWNrXG4gICAgICB9KTtcbiAgICAgIC8vIERvbid0IGNyYXNoIG9uIGNvbm5lY3Rpb24gZXJyb3JzXG4gICAgfSk7XG4gICAgXG4gICAgLy8gVGVzdCBjb25uZWN0aW9uIHRvIHZlcmlmeSBzZXR0aW5nc1xuICAgIGNvbnNvbGUubG9nKCdbREJdIEF0dGVtcHRpbmcgdG8gZ2V0IGNsaWVudCBmcm9tIHBvb2wuLi4nKTtcbiAgICBcbiAgICAvLyBJbXBsZW1lbnQgcmV0cnkgbG9naWMgZm9yIGluaXRpYWwgY29ubmVjdGlvblxuICAgIGxldCBjbGllbnQgPSBudWxsO1xuICAgIGxldCBsYXN0RXJyb3IgPSBudWxsO1xuICAgIGxldCBhdHRlbXB0Q291bnQgPSAwO1xuICAgIFxuICAgIHdoaWxlIChhdHRlbXB0Q291bnQgPCBEQl9ERUZBVUxUUy5yZXRyeUF0dGVtcHRzKSB7XG4gICAgICB0cnkge1xuICAgICAgICBhdHRlbXB0Q291bnQrKztcbiAgICAgICAgY29uc29sZS5sb2coYFtEQl0gQ29ubmVjdGlvbiBhdHRlbXB0ICR7YXR0ZW1wdENvdW50fS8ke0RCX0RFRkFVTFRTLnJldHJ5QXR0ZW1wdHN9Li4uYCk7XG4gICAgICAgIFxuICAgICAgICBjbGllbnQgPSBhd2FpdCBwb29sLmNvbm5lY3QoKTtcbiAgICAgICAgXG4gICAgICAgIC8vIElmIHdlIGdvdCBoZXJlLCBjb25uZWN0aW9uIHN1Y2Nlc3NmdWwgLSBicmVhayByZXRyeSBsb29wXG4gICAgICAgIGNvbnNvbGUubG9nKCdbREJdIENsaWVudCBjb25uZWN0ZWQgc3VjY2Vzc2Z1bGx5Jyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfSBjYXRjaCAoY29ubmVjdGlvbkVycm9yKSB7XG4gICAgICAgIGxhc3RFcnJvciA9IGNvbm5lY3Rpb25FcnJvcjtcbiAgICAgICAgY29uc29sZS5lcnJvcihgW0RCXSBDb25uZWN0aW9uIGF0dGVtcHQgJHthdHRlbXB0Q291bnR9IGZhaWxlZDpgLCB7XG4gICAgICAgICAgbWVzc2FnZTogY29ubmVjdGlvbkVycm9yLm1lc3NhZ2UsXG4gICAgICAgICAgY29kZTogY29ubmVjdGlvbkVycm9yLmNvZGVcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBEb24ndCB3YWl0IG9uIHRoZSBsYXN0IGF0dGVtcHRcbiAgICAgICAgaWYgKGF0dGVtcHRDb3VudCA8IERCX0RFRkFVTFRTLnJldHJ5QXR0ZW1wdHMpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhgW0RCXSBXYWl0aW5nICR7REJfREVGQVVMVFMucmV0cnlEZWxheX1tcyBiZWZvcmUgcmV0cnkuLi5gKTtcbiAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgREJfREVGQVVMVFMucmV0cnlEZWxheSkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIElmIGFsbCBjb25uZWN0aW9uIGF0dGVtcHRzIGZhaWxlZCwgdGhyb3cgdGhlIGxhc3QgZXJyb3JcbiAgICBpZiAoIWNsaWVudCkge1xuICAgICAgdGhyb3cgbGFzdEVycm9yIHx8IG5ldyBFcnJvcignRmFpbGVkIHRvIGNvbm5lY3QgdG8gZGF0YWJhc2UgYWZ0ZXIgbXVsdGlwbGUgYXR0ZW1wdHMnKTtcbiAgICB9XG4gICAgXG4gICAgdHJ5IHtcbiAgICAgIGNvbnNvbGUubG9nKCdbREJdIFJ1bm5pbmcgdGVzdCBxdWVyeS4uLicpO1xuICAgICAgY29uc3QgdGVzdFJlc3VsdCA9IGF3YWl0IGNsaWVudC5xdWVyeSgnU0VMRUNUIDEgYXMgY29ubmVjdGlvbl90ZXN0Jyk7XG4gICAgICBjb25zb2xlLmxvZygnW0RCXSBEYXRhYmFzZSBjb25uZWN0aW9uIHRlc3Qgc3VjY2Vzc2Z1bCcsIHtcbiAgICAgICAgaG9zdDogY29uZmlnLmhvc3QsXG4gICAgICAgIGRhdGFiYXNlOiBjb25maWcuZGF0YWJhc2UsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICByZXN1bHQ6IHRlc3RSZXN1bHQucm93c1swXVxuICAgICAgfSk7XG4gICAgfSBjYXRjaCAocXVlcnlFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW0RCXSBUZXN0IHF1ZXJ5IGZhaWxlZDonLCB7XG4gICAgICAgIG1lc3NhZ2U6IHF1ZXJ5RXJyb3IubWVzc2FnZSxcbiAgICAgICAgY29kZTogcXVlcnlFcnJvci5jb2RlLFxuICAgICAgICBzZXZlcml0eTogcXVlcnlFcnJvci5zZXZlcml0eSxcbiAgICAgICAgZGV0YWlsOiBxdWVyeUVycm9yLmRldGFpbFxuICAgICAgfSk7XG4gICAgICB0aHJvdyBxdWVyeUVycm9yO1xuICAgIH0gZmluYWxseSB7XG4gICAgICBpZiAoY2xpZW50KSBjbGllbnQucmVsZWFzZSgpO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gcG9vbDtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdbREJdIEVycm9yIGNyZWF0aW5nIGRhdGFiYXNlIHBvb2w6Jywge1xuICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgIGNvZGU6IGVycm9yLmNvZGUsXG4gICAgICBzZXZlcml0eTogZXJyb3Iuc2V2ZXJpdHksXG4gICAgICBkZXRhaWw6IGVycm9yLmRldGFpbFxuICAgIH0pO1xuICAgIHRocm93IGVycm9yOyAvLyBSZXRocm93IG9yaWdpbmFsIGVycm9yIGZvciBwcm9wZXIgaGFuZGxpbmdcbiAgfVxufVxuXG4vKipcbiAqIFRlc3QgZGF0YWJhc2UgY29ubmVjdGlvbiBhbmQgcmV0dXJuIHN0YXR1c1xuICogQHJldHVybnMge29iamVjdH0gQ29ubmVjdGlvbiB0ZXN0IHJlc3VsdFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdGVzdERiQ29ubmVjdGlvbigpIHtcbiAgbGV0IHBvb2wgPSBudWxsO1xuICBcbiAgdHJ5IHtcbiAgICBwb29sID0gYXdhaXQgY3JlYXRlRGJQb29sKCk7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcG9vbC5xdWVyeSgnU0VMRUNUIDEgYXMgY29ubmVjdGlvbl90ZXN0Jyk7XG4gICAgY29uc3QgY29uZmlnID0gZ2V0RGJDb25maWcoKTtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIGNvbm5lY3RlZDogcmVzdWx0LnJvd3NbMF0uY29ubmVjdGlvbl90ZXN0ID09PSAxLFxuICAgICAgLy8gT25seSBpbmNsdWRlIG5vbi1zZW5zaXRpdmUgY29uZmlndXJhdGlvbiBkZXRhaWxzXG4gICAgICBjb25maWc6IHtcbiAgICAgICAgaG9zdDogY29uZmlnLmhvc3QsXG4gICAgICAgIGRhdGFiYXNlOiBjb25maWcuZGF0YWJhc2UsXG4gICAgICAgIHBvcnQ6IGNvbmZpZy5wb3J0LFxuICAgICAgICBzc2w6IGNvbmZpZy5zc2wgPyAnZW5hYmxlZCcgOiAnZGlzYWJsZWQnXG4gICAgICB9LFxuICAgICAgZGF0YWJhc2U6ICdhd3NfcmRzJ1xuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc3QgY29uZmlnID0gZ2V0RGJDb25maWcoKTtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcbiAgICAgIGNvZGU6IGVycm9yLmNvZGUsXG4gICAgICAvLyBPbmx5IGluY2x1ZGUgbm9uLXNlbnNpdGl2ZSBjb25maWd1cmF0aW9uIGRldGFpbHNcbiAgICAgIGNvbmZpZzoge1xuICAgICAgICBob3N0OiBjb25maWcuaG9zdCxcbiAgICAgICAgZGF0YWJhc2U6IGNvbmZpZy5kYXRhYmFzZSxcbiAgICAgICAgcG9ydDogY29uZmlnLnBvcnQsXG4gICAgICAgIHNzbDogY29uZmlnLnNzbCA/ICdlbmFibGVkJyA6ICdkaXNhYmxlZCdcbiAgICAgIH0sXG4gICAgICBkYXRhYmFzZTogJ2F3c19yZHMnXG4gICAgfTtcbiAgfSBmaW5hbGx5IHtcbiAgICBpZiAocG9vbCkgYXdhaXQgcG9vbC5lbmQoKTtcbiAgfVxufVxuXG4vKipcbiAqIEdldCBhIFByaXNtYSBjbGllbnQgZm9yIGEgc3BlY2lmaWMgc2NoZW1hXG4gKiBAcGFyYW0ge3N0cmluZ30gc2NoZW1hIC0gVGhlIHNjaGVtYSBuYW1lIHRvIGNvbm5lY3QgdG9cbiAqIEByZXR1cm5zIHtQcmlzbWFDbGllbnR9IEEgUHJpc21hIGNsaWVudCBjb25uZWN0ZWQgdG8gdGhlIHNwZWNpZmllZCBzY2hlbWFcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByaXNtYUNsaWVudChzY2hlbWEgPSAncHVibGljJykge1xuICB0cnkge1xuICAgIC8vIFJldHVybiBjYWNoZWQgY2xpZW50IGlmIGl0IGV4aXN0c1xuICAgIGlmIChwcmlzbWFDbGllbnRzW3NjaGVtYV0pIHtcbiAgICAgIGNvbnNvbGUubG9nKGBVc2luZyBjYWNoZWQgUHJpc21hIGNsaWVudCBmb3Igc2NoZW1hOiAke3NjaGVtYX1gKTtcbiAgICAgIHJldHVybiBwcmlzbWFDbGllbnRzW3NjaGVtYV07XG4gICAgfVxuICAgIFxuICAgIGNvbnNvbGUubG9nKGBDcmVhdGluZyBuZXcgUHJpc21hIGNsaWVudCBmb3Igc2NoZW1hOiAke3NjaGVtYX1gKTtcbiAgICBcbiAgICAvLyBHZXQgYXBwcm9wcmlhdGUgZGF0YWJhc2UgVVJMXG4gICAgY29uc3QgZGJVcmwgPSBwcm9jZXNzLmVudi5EQVRBQkFTRV9VUkwgfHwgXG4gICAgICBgcG9zdGdyZXNxbDovL2RvdHRfYWRtaW46JHtwcm9jZXNzLmVudi5EQl9QQVNTV09SRCB8fCAnUlJmWFU2dVBQVWJCRWcxSnFHVEonfUBkb3R0LWRldi5jMTJxZ282bTA4NWUudXMtZWFzdC0xLnJkcy5hbWF6b25hd3MuY29tOjU0MzIvZG90dF9tYWluP3NjaGVtYT0ke3NjaGVtYX1gO1xuICAgIFxuICAgIGNvbnNvbGUubG9nKGBVc2luZyBkYXRhYmFzZSBVUkw6ICR7ZGJVcmwucmVwbGFjZSgvOlteOl0qQC8sICc6KioqQCcpfWApO1xuICAgIFxuICAgIC8vIENyZWF0ZSBhIG5ldyBQcmlzbWEgY2xpZW50IHdpdGggdGhlIHNjaGVtYSBjb25uZWN0aW9uXG4gICAgY29uc3QgcHJpc21hID0gbmV3IFByaXNtYUNsaWVudCh7XG4gICAgICBkYXRhc291cmNlczoge1xuICAgICAgICBkYjoge1xuICAgICAgICAgIHVybDogZGJVcmxcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIC8vIEFkZCBsb2dnaW5nIGluIGRldmVsb3BtZW50XG4gICAgICBsb2c6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnID8gW1xuICAgICAgICB7IGxldmVsOiAncXVlcnknLCBlbWl0OiAnZXZlbnQnIH0sXG4gICAgICAgIHsgbGV2ZWw6ICdlcnJvcicsIGVtaXQ6ICdzdGRvdXQnIH0sXG4gICAgICAgIHsgbGV2ZWw6ICd3YXJuJywgZW1pdDogJ3N0ZG91dCcgfSxcbiAgICAgIF0gOiB1bmRlZmluZWQsXG4gICAgfSk7XG4gICAgXG4gICAgLy8gQWRkIHF1ZXJ5IGxvZ2dpbmcgaW4gZGV2ZWxvcG1lbnRcbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcpIHtcbiAgICAgIHByaXNtYS4kb24oJ3F1ZXJ5JywgKGUpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coYFtQcmlzbWEgUXVlcnldICR7ZS5xdWVyeX0gKCR7ZS5kdXJhdGlvbn1tcylgKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICAvLyBDYWNoZSB0aGUgY2xpZW50XG4gICAgcHJpc21hQ2xpZW50c1tzY2hlbWFdID0gcHJpc21hO1xuICAgIFxuICAgIC8vIFRlc3QgdGhlIGNvbm5lY3Rpb25cbiAgICB0cnkge1xuICAgICAgYXdhaXQgcHJpc21hLiRjb25uZWN0KCk7XG4gICAgICBjb25zb2xlLmxvZyhgU3VjY2Vzc2Z1bGx5IGNvbm5lY3RlZCB0byBkYXRhYmFzZSBzY2hlbWE6ICR7c2NoZW1hfWApO1xuICAgICAgXG4gICAgICAvLyBFeGVjdXRlIGEgc2ltcGxlIHF1ZXJ5IHRvIHZlcmlmeVxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcHJpc21hLiRxdWVyeVJhd2BTRUxFQ1QgMSBhcyBjb25uZWN0aW9uX3Rlc3RgO1xuICAgICAgY29uc29sZS5sb2coYFByaXNtYSBjb25uZWN0aW9uIHRlc3Qgc3VjY2Vzc2Z1bDogJHtKU09OLnN0cmluZ2lmeShyZXN1bHQpfWApO1xuICAgICAgXG4gICAgICByZXR1cm4gcHJpc21hO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGBGYWlsZWQgdG8gY29ubmVjdCB0byBkYXRhYmFzZSBzY2hlbWEgJHtzY2hlbWF9OmAsIHtcbiAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgY29kZTogZXJyb3IuY29kZSxcbiAgICAgICAgc3RhY2s6IGVycm9yLnN0YWNrXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgLy8gUmVtb3ZlIGZyb20gY2FjaGUgaWYgY29ubmVjdGlvbiBmYWlsZWRcbiAgICAgIGRlbGV0ZSBwcmlzbWFDbGllbnRzW3NjaGVtYV07XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihgRXJyb3Igc2V0dGluZyB1cCBQcmlzbWEgY2xpZW50IGZvciBzY2hlbWEgJHtzY2hlbWF9OmAsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufVxuXG4vKipcbiAqIENsZWFuIHVwIGFsbCBQcmlzbWEgY2xpZW50cyBvbiBzZXJ2ZXIgc2h1dGRvd25cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRpc2Nvbm5lY3RBbGxDbGllbnRzKCkge1xuICBmb3IgKGNvbnN0IHNjaGVtYSBpbiBwcmlzbWFDbGllbnRzKSB7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHByaXNtYUNsaWVudHNbc2NoZW1hXS4kZGlzY29ubmVjdCgpO1xuICAgICAgY29uc29sZS5sb2coYERpc2Nvbm5lY3RlZCBmcm9tIHNjaGVtYTogJHtzY2hlbWF9YCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIGRpc2Nvbm5lY3RpbmcgZnJvbSBzY2hlbWEgJHtzY2hlbWF9OmAsIGVycm9yKTtcbiAgICB9XG4gIH1cbn0iXSwibmFtZXMiOlsiUHJpc21hQ2xpZW50IiwicHJpc21hQ2xpZW50cyIsIkRCX0RFRkFVTFRTIiwicG9ydCIsImRhdGFiYXNlIiwiY29ubmVjdGlvblRpbWVvdXRNaWxsaXMiLCJzdGF0ZW1lbnRfdGltZW91dCIsInF1ZXJ5X3RpbWVvdXQiLCJtYXgiLCJpZGxlVGltZW91dE1pbGxpcyIsInJldHJ5QXR0ZW1wdHMiLCJyZXRyeURlbGF5IiwiZ2V0RGJDb25maWciLCJjb25zb2xlIiwibG9nIiwidXNlU1NMIiwicHJvY2VzcyIsImVudiIsIkRCX1VTRV9TU0wiLCJjb25maWciLCJ1c2VyIiwiUkRTX1VTRVJOQU1FIiwiREJfVVNFUiIsIkRKQU5HT19EQl9VU0VSIiwicGFzc3dvcmQiLCJSRFNfUEFTU1dPUkQiLCJEQl9QQVNTV09SRCIsIkRKQU5HT19EQl9QQVNTV09SRCIsImhvc3QiLCJSRFNfSE9TVE5BTUUiLCJEQl9IT1NUIiwiREpBTkdPX0RCX0hPU1QiLCJwYXJzZUludCIsIlJEU19QT1JUIiwiREJfUE9SVCIsIkRKQU5HT19EQl9QT1JUIiwiUkRTX0RCX05BTUUiLCJEQl9OQU1FIiwiREpBTkdPX0RCX05BTUUiLCJzc2wiLCJyZWplY3RVbmF1dGhvcml6ZWQiLCJjcmVhdGVEYlBvb2wiLCJQb29sIiwicmVxdWlyZSIsInBvb2wiLCJvbiIsImVyciIsImVycm9yIiwibWVzc2FnZSIsImNvZGUiLCJzZXZlcml0eSIsImRldGFpbCIsImhpbnQiLCJ3aGVyZSIsInN0YWNrIiwiY2xpZW50IiwibGFzdEVycm9yIiwiYXR0ZW1wdENvdW50IiwiY29ubmVjdCIsImNvbm5lY3Rpb25FcnJvciIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsIkVycm9yIiwidGVzdFJlc3VsdCIsInF1ZXJ5IiwidGltZXN0YW1wIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwicmVzdWx0Iiwicm93cyIsInF1ZXJ5RXJyb3IiLCJyZWxlYXNlIiwidGVzdERiQ29ubmVjdGlvbiIsInN1Y2Nlc3MiLCJjb25uZWN0ZWQiLCJjb25uZWN0aW9uX3Rlc3QiLCJlbmQiLCJnZXRQcmlzbWFDbGllbnQiLCJzY2hlbWEiLCJkYlVybCIsIkRBVEFCQVNFX1VSTCIsInJlcGxhY2UiLCJwcmlzbWEiLCJkYXRhc291cmNlcyIsImRiIiwidXJsIiwibGV2ZWwiLCJlbWl0IiwidW5kZWZpbmVkIiwiJG9uIiwiZSIsImR1cmF0aW9uIiwiJGNvbm5lY3QiLCIkcXVlcnlSYXciLCJKU09OIiwic3RyaW5naWZ5IiwiZGlzY29ubmVjdEFsbENsaWVudHMiLCIkZGlzY29ubmVjdCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/tenant/db-config.js\n");

/***/ }),

/***/ "(rsc)/./src/app/api/tenant/ensure-db-record/route.js":
/*!******************************************************!*\
  !*** ./src/app/api/tenant/ensure-db-record/route.js ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/api/server.js\");\n/* harmony import */ var _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/utils/serverLogger */ \"(rsc)/./src/utils/serverLogger.js\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! uuid */ \"(rsc)/./node_modules/uuid/dist/esm-node/v5.js\");\n\n\n\n// Namespace for deterministic tenant ID generation\nconst TENANT_NAMESPACE = '9a551c44-4ade-4f89-b078-0af8be794c23';\n/**\n * A minimal endpoint to ensure a tenant record exists in the database\n * This is deliberately designed to work without authentication\n * for resilience during onboarding flows\n */ async function POST(request) {\n    let pool = null;\n    let tenantId = '';\n    let schemaName = '';\n    try {\n        // Parse request body\n        let body;\n        try {\n            body = await request.json();\n        } catch (parseError) {\n            _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.warn('[EnsureDBRecord] Failed to parse request body:', parseError);\n            body = {};\n        }\n        // Get tenant data from request body\n        tenantId = body.tenantId || '';\n        let userId = body.userId || '';\n        const email = body.email || '';\n        const businessName = body.businessName || body.business_name || '';\n        const businessType = body.businessType || body.business_type || 'Other';\n        // If no userId is provided, generate a proper UUID for it\n        if (!userId) {\n            try {\n                // Generate a UUID using a timestamp-based namespace\n                const USER_NAMESPACE = '8a551c44-4ade-4f89-b078-0af8be794c10';\n                userId = (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(`anonymous_${Date.now()}`, USER_NAMESPACE);\n                _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.info('[EnsureDBRecord] Generated UUID for anonymous user:', userId);\n            } catch (uuidError) {\n                _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.error('[EnsureDBRecord] Error generating UUID for user:', uuidError);\n                // Use a fallback ID that's a valid UUID\n                userId = '28609ed2-1a46-4d50-bc4e-483d6e3405ff';\n            }\n        }\n        // If no tenant ID, try to generate one from user ID\n        if (!tenantId && userId) {\n            try {\n                tenantId = (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(userId, TENANT_NAMESPACE);\n                _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.info('[EnsureDBRecord] Generated deterministic tenant ID:', tenantId);\n            } catch (uuidError) {\n                _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.error('[EnsureDBRecord] Error generating UUID:', uuidError);\n                // Use a fallback ID\n                tenantId = '18609ed2-1a46-4d50-bc4e-483d6e3405ff';\n            }\n        }\n        // Final fallback - use a default tenant ID\n        if (!tenantId) {\n            tenantId = '18609ed2-1a46-4d50-bc4e-483d6e3405ff';\n            _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.warn('[EnsureDBRecord] Using fallback tenant ID:', tenantId);\n        }\n        // Generate schema name - convert hyphens to underscores for schema name (PostgreSQL limitation)\n        schemaName = `tenant_${tenantId.replace(/-/g, '_')}`;\n        // Connect directly to the database\n        try {\n            // First explicitly create the table to ensure it exists\n            try {\n                _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.info('[EnsureDBRecord] Ensuring table exists');\n                const createTableUrl = new URL('/api/tenant/create-table', request.url).toString();\n                _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.info('[EnsureDBRecord] Using create-table URL:', createTableUrl);\n                const createTableResponse = await fetch(createTableUrl);\n                if (createTableResponse.ok) {\n                    _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.info('[EnsureDBRecord] Table creation check successful');\n                } else {\n                    _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.warn('[EnsureDBRecord] Table creation check failed:', await createTableResponse.text().catch(()=>createTableResponse.status.toString()));\n                }\n            } catch (tableError) {\n                _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.warn('[EnsureDBRecord] Error checking/creating table:', tableError.message);\n            }\n            // Then ensure the database environment is initialized\n            try {\n                _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.info('[EnsureDBRecord] Initializing database environment');\n                const initUrl = new URL('/api/tenant/init-db-env', request.url).toString();\n                _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.info('[EnsureDBRecord] Using init-db-env URL:', initUrl);\n                const initResponse = await fetch(initUrl);\n                if (initResponse.ok) {\n                    const initData = await initResponse.json();\n                    _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.info('[EnsureDBRecord] Database initialization successful:', initData.message, 'Table exists:', initData.tableExists);\n                } else {\n                    _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.warn('[EnsureDBRecord] Database initialization failed:', await initResponse.text().catch(()=>initResponse.status.toString()));\n                // Continue anyway, as the operation might still succeed\n                }\n            } catch (initError) {\n                _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.warn('[EnsureDBRecord] Error initializing database environment:', initError.message);\n            // Continue anyway, as the operation might still succeed\n            }\n            // Import the database configuration helper\n            const { createDbPool } = __webpack_require__(/*! ../db-config */ \"(rsc)/./src/app/api/tenant/db-config.js\");\n            // Get a configured database pool\n            pool = await createDbPool();\n            // Log connection attempt for debugging\n            _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.info('[EnsureDBRecord] Created database pool');\n            // Ping database to verify connection\n            try {\n                await pool.query('SELECT 1');\n                _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.info('[EnsureDBRecord] Database connection successful');\n            } catch (pingError) {\n                _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.error('[EnsureDBRecord] Database ping failed:', pingError.message);\n                throw pingError;\n            }\n            // Begin transaction for atomicity\n            await pool.query('BEGIN');\n            try {\n                // First create the schema\n                await pool.query(`CREATE SCHEMA IF NOT EXISTS ${schemaName};`);\n                _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.info('[EnsureDBRecord] Created schema:', schemaName);\n                // Verify schema creation and wait if needed\n                let schemaExists = false;\n                let retryCount = 0;\n                const maxRetries = 3;\n                while(!schemaExists && retryCount < maxRetries){\n                    try {\n                        // Check if schema exists\n                        const checkSchemaQuery = `\n              SELECT EXISTS (\n                SELECT FROM information_schema.schemata \n                WHERE schema_name = $1\n              );\n            `;\n                        const schemaResult = await pool.query(checkSchemaQuery, [\n                            schemaName\n                        ]);\n                        schemaExists = schemaResult.rows[0].exists;\n                        if (schemaExists) {\n                            _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.info(`[EnsureDBRecord] Schema ${schemaName} exists and is ready`);\n                        } else {\n                            // Wait a bit before retrying\n                            _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.info(`[EnsureDBRecord] Schema ${schemaName} not ready yet, waiting... (attempt ${retryCount + 1}/${maxRetries})`);\n                            await new Promise((resolve)=>setTimeout(resolve, 500)); // 500ms delay\n                            retryCount++;\n                        }\n                    } catch (checkError) {\n                        _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.warn(`[EnsureDBRecord] Error checking schema existence: ${checkError.message}`);\n                        retryCount++;\n                        await new Promise((resolve)=>setTimeout(resolve, 500)); // 500ms delay\n                    }\n                }\n                if (!schemaExists) {\n                    _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.warn(`[EnsureDBRecord] Schema ${schemaName} may not be fully created yet, but continuing...`);\n                }\n                // Add owner to users table if not exists\n                // This is critical for proper tenant setup with RLS\n                try {\n                    // First insert a user record into custom_auth_user\n                    const userEmail = body.email || `${userId}@example.com`;\n                    const userInsertQuery = `\n            INSERT INTO custom_auth_user (\n              id, email, password, is_active, is_staff, is_superuser, date_joined,\n              first_name, last_name, email_confirmed, confirmation_token,\n              is_onboarded, role, occupation, tenant_id\n            )\n            VALUES (\n              $1, $2, 'pbkdf2_sha256$placeholder', true, false, false, NOW(),\n              'User', 'User', false, gen_random_uuid(),\n              false, 'OWNER', 'OWNER', $3\n            )\n            ON CONFLICT (id) DO NOTHING;\n          `;\n                    await pool.query(userInsertQuery, [\n                        userId,\n                        userEmail,\n                        tenantId\n                    ]);\n                    _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.info('[EnsureDBRecord] Ensured user record exists for:', userId);\n                    // Now insert the user profile\n                    const profileInsertQuery = `\n            INSERT INTO users_userprofile (id, user_id, tenant_id, created_at, updated_at)\n            VALUES ($1, $1, $2, NOW(), NOW())\n            ON CONFLICT (id) DO NOTHING;\n          `;\n                    await pool.query(profileInsertQuery, [\n                        userId,\n                        tenantId\n                    ]);\n                    _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.info('[EnsureDBRecord] Ensured user profile record exists for:', userId);\n                } catch (userError) {\n                    _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.warn('[EnsureDBRecord] Error ensuring user exists (non-fatal):', userError.message);\n                // Continue even if user creation fails\n                }\n                // Add business record if not exists\n                try {\n                    const businessInsertQuery = `\n            INSERT INTO users_business (id, name, tenant_id, created_at, updated_at)\n            VALUES ($1, $2, $1, NOW(), NOW())\n            ON CONFLICT (id) DO UPDATE\n            SET name = $2, updated_at = NOW()\n            RETURNING id, name;\n          `;\n                    const businessId = tenantId; // Use same ID for simplicity\n                    const businessResult = await pool.query(businessInsertQuery, [\n                        businessId,\n                        businessName\n                    ]);\n                    if (businessResult.rows && businessResult.rows.length > 0) {\n                        _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.info('[EnsureDBRecord] Business record inserted/updated:', businessResult.rows[0]);\n                    }\n                } catch (businessError) {\n                    _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.warn('[EnsureDBRecord] Error ensuring business exists (non-fatal):', businessError.message);\n                // Continue even if business creation fails\n                }\n                // Create tenant record\n                const tenantInsertQuery = `\n          INSERT INTO custom_auth_tenant (\n            id, name, owner_id, schema_name, created_at, updated_at,\n            rls_enabled, rls_setup_date\n          )\n          VALUES ($1, $2, $3, $4, NOW(), NOW(), true, NOW())\n          ON CONFLICT (id) DO UPDATE\n          SET name = $2, updated_at = NOW()\n          RETURNING id, name, schema_name, owner_id, rls_enabled;\n        `;\n                const tenantResult = await pool.query(tenantInsertQuery, [\n                    tenantId,\n                    businessName,\n                    userId,\n                    schemaName\n                ]);\n                if (tenantResult.rows && tenantResult.rows.length > 0) {\n                    _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.info('[EnsureDBRecord] Tenant record inserted/updated:', tenantResult.rows[0]);\n                    // Set up RLS policy right away\n                    try {\n                        // Grant permissions\n                        await pool.query(`GRANT USAGE ON SCHEMA ${schemaName} TO dott_admin;`);\n                        await pool.query(`GRANT ALL PRIVILEGES ON SCHEMA ${schemaName} TO dott_admin;`);\n                        // Check if product table exists in the schema, create if not\n                        const checkTableQuery = `\n              SELECT EXISTS (\n                SELECT FROM information_schema.tables \n                WHERE table_schema = '${schemaName}' \n                AND table_name = 'product'\n              );\n            `;\n                        const tableExists = await pool.query(checkTableQuery);\n                        // If product table doesn't exist, create it\n                        if (!tableExists.rows[0].exists) {\n                            _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.info(`[EnsureDBRecord] Product table doesn't exist in schema ${schemaName}, creating it`);\n                            const createTableQuery = `\n                CREATE TABLE IF NOT EXISTS ${schemaName}.product (\n                  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n                  name VARCHAR(255) NOT NULL,\n                  description TEXT,\n                  price DECIMAL(10, 2),\n                  tenant_id UUID NOT NULL,\n                  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n                  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n                );\n              `;\n                            await pool.query(createTableQuery);\n                            _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.info(`[EnsureDBRecord] Created product table in schema ${schemaName}`);\n                        }\n                        // Create a basic RLS policy (this will be expanded through migrations)\n                        const rlsQuery = `\n              ALTER TABLE IF EXISTS ${schemaName}.product ENABLE ROW LEVEL SECURITY;\n              DROP POLICY IF EXISTS tenant_isolation_policy ON ${schemaName}.product;\n              CREATE POLICY tenant_isolation_policy ON ${schemaName}.product \n              USING (tenant_id = '${tenantId}')\n              WITH CHECK (tenant_id = '${tenantId}');\n            `;\n                        await pool.query(rlsQuery);\n                        _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.info('[EnsureDBRecord] Set up RLS policy for schema');\n                    } catch (rlsError) {\n                        _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.warn('[EnsureDBRecord] Error setting up RLS policy (non-fatal):', rlsError.message);\n                    // Continue even if RLS setup fails\n                    }\n                    // Update user profile with business ID\n                    try {\n                        const userProfileQuery = `\n              UPDATE users_userprofile \n              SET business_id = $1\n              WHERE id = $2;\n            `;\n                        await pool.query(userProfileQuery, [\n                            tenantId,\n                            userId\n                        ]);\n                        _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.info('[EnsureDBRecord] Updated user profile with business ID');\n                    } catch (profileError) {\n                        _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.warn('[EnsureDBRecord] Error updating user profile (non-fatal):', profileError.message);\n                    // Continue even if profile update fails\n                    }\n                    // Commit the transaction\n                    await pool.query('COMMIT');\n                    _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.info('[EnsureDBRecord] Transaction committed successfully');\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        success: true,\n                        tenantId: tenantResult.rows[0].id,\n                        name: tenantResult.rows[0].name,\n                        schemaName: tenantResult.rows[0].schema_name,\n                        ownerId: tenantResult.rows[0].owner_id,\n                        rlsEnabled: tenantResult.rows[0].rls_enabled,\n                        created: true,\n                        message: 'Successfully created tenant record and schema'\n                    });\n                } else {\n                    throw new Error(\"Tenant record creation didn't return expected data\");\n                }\n            } catch (transactionError) {\n                // Rollback on any error\n                await pool.query('ROLLBACK');\n                _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.error('[EnsureDBRecord] Transaction failed:', transactionError.message);\n                throw transactionError;\n            }\n        } catch (dbError) {\n            // Reraise for outer catch block\n            throw dbError;\n        } finally{\n            // Close connection\n            if (pool) {\n                try {\n                    await pool.end();\n                    _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.info('[EnsureDBRecord] Database connection closed');\n                } catch (closeError) {\n                    _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.error('[EnsureDBRecord] Error closing connection:', closeError.message);\n                }\n            }\n        }\n    } catch (error) {\n        _utils_serverLogger__WEBPACK_IMPORTED_MODULE_1__.logger.error('[EnsureDBRecord] Error creating tenant record:', error.message);\n        // Always return a valid JSON response, even on errors\n        // Add proper Content-Type header to ensure browser treats it as JSON\n        return new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(JSON.stringify({\n            success: true,\n            tenantId,\n            schemaName,\n            clientSideOnly: true,\n            message: 'Failed to create tenant record in database, but client can use tenant ID',\n            error: error.message\n        }), {\n            status: 200,\n            headers: {\n                'Content-Type': 'application/json'\n            }\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS90ZW5hbnQvZW5zdXJlLWRiLXJlY29yZC9yb3V0ZS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQTJDO0FBQ0c7QUFDVjtBQUVwQyxtREFBbUQ7QUFDbkQsTUFBTUksbUJBQW1CO0FBRXpCOzs7O0NBSUMsR0FDTSxlQUFlQyxLQUFLQyxPQUFPO0lBQ2hDLElBQUlDLE9BQU87SUFDWCxJQUFJQyxXQUFXO0lBQ2YsSUFBSUMsYUFBYTtJQUVqQixJQUFJO1FBQ0YscUJBQXFCO1FBQ3JCLElBQUlDO1FBQ0osSUFBSTtZQUNGQSxPQUFPLE1BQU1KLFFBQVFLLElBQUk7UUFDM0IsRUFBRSxPQUFPQyxZQUFZO1lBQ25CWCx1REFBTUEsQ0FBQ1ksSUFBSSxDQUFDLGtEQUFrREQ7WUFDOURGLE9BQU8sQ0FBQztRQUNWO1FBRUEsb0NBQW9DO1FBQ3BDRixXQUFXRSxLQUFLRixRQUFRLElBQUk7UUFDNUIsSUFBSU0sU0FBU0osS0FBS0ksTUFBTSxJQUFJO1FBQzVCLE1BQU1DLFFBQVFMLEtBQUtLLEtBQUssSUFBSTtRQUM1QixNQUFNQyxlQUFlTixLQUFLTSxZQUFZLElBQUlOLEtBQUtPLGFBQWEsSUFBSTtRQUNoRSxNQUFNQyxlQUFlUixLQUFLUSxZQUFZLElBQUlSLEtBQUtTLGFBQWEsSUFBSTtRQUVoRSwwREFBMEQ7UUFDMUQsSUFBSSxDQUFDTCxRQUFRO1lBQ1gsSUFBSTtnQkFDRixvREFBb0Q7Z0JBQ3BELE1BQU1NLGlCQUFpQjtnQkFDdkJOLFNBQVNYLGdEQUFNQSxDQUFDLENBQUMsVUFBVSxFQUFFa0IsS0FBS0MsR0FBRyxJQUFJLEVBQUVGO2dCQUMzQ25CLHVEQUFNQSxDQUFDc0IsSUFBSSxDQUFDLHVEQUF1RFQ7WUFDckUsRUFBRSxPQUFPVSxXQUFXO2dCQUNsQnZCLHVEQUFNQSxDQUFDd0IsS0FBSyxDQUFDLG9EQUFvREQ7Z0JBQ2pFLHdDQUF3QztnQkFDeENWLFNBQVM7WUFDWDtRQUNGO1FBRUEsb0RBQW9EO1FBQ3BELElBQUks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QzVDQyxTQUFTO3dCQUNUOUMsU0FBUztvQkFDWDtnQkFDRixPQUFPO29CQUNMLE1BQU0sSUFBSStDLE1BQU07Z0JBQ2xCO1lBQ0YsRUFBRSxPQUFPQyxrQkFBa0I7Z0JBQ3pCLHdCQUF3QjtnQkFDeEIsTUFBTS9FLEtBQUt1QyxLQUFLLENBQUM7Z0JBQ2pCN0MsdURBQU1BLENBQUN3QixLQUFLLENBQUMsd0NBQXdDNkQsaUJBQWlCaEQsT0FBTztnQkFDN0UsTUFBTWdEO1lBQ1I7UUFDRixFQUFFLE9BQU9DLFNBQVM7WUFDaEIsZ0NBQWdDO1lBQ2hDLE1BQU1BO1FBQ1IsU0FBVTtZQUNSLG1CQUFtQjtZQUNuQixJQUFJaEYsTUFBTTtnQkFDUixJQUFJO29CQUNGLE1BQU1BLEtBQUtpRixHQUFHO29CQUNkdkYsdURBQU1BLENBQUNzQixJQUFJLENBQUM7Z0JBQ2QsRUFBRSxPQUFPa0UsWUFBWTtvQkFDbkJ4Rix1REFBTUEsQ0FBQ3dCLEtBQUssQ0FBQyw4Q0FBOENnRSxXQUFXbkQsT0FBTztnQkFDL0U7WUFDRjtRQUNGO0lBQ0YsRUFBRSxPQUFPYixPQUFPO1FBQ2R4Qix1REFBTUEsQ0FBQ3dCLEtBQUssQ0FBQyxrREFBa0RBLE1BQU1hLE9BQU87UUFFNUUsc0RBQXNEO1FBQ3RELHFFQUFxRTtRQUNyRSxPQUFPLElBQUl0QyxxREFBWUEsQ0FBQzBGLEtBQUtDLFNBQVMsQ0FBQztZQUNyQ2YsU0FBUztZQUNUcEU7WUFDQUM7WUFDQW1GLGdCQUFnQjtZQUNoQnRELFNBQVM7WUFDVGIsT0FBT0EsTUFBTWEsT0FBTztRQUN0QixJQUFJO1lBQ0ZGLFFBQVE7WUFDUnlELFNBQVM7Z0JBQ1AsZ0JBQWdCO1lBQ2xCO1FBQ0Y7SUFDRjtBQUNGIiwic291cmNlcyI6WyIvVXNlcnMva3VvbGRlbmcvcHJvamVjdHgvZnJvbnRlbmQvcHlmYWN0b3JfbmV4dC9zcmMvYXBwL2FwaS90ZW5hbnQvZW5zdXJlLWRiLXJlY29yZC9yb3V0ZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG5pbXBvcnQgeyBsb2dnZXIgfSBmcm9tICdAL3V0aWxzL3NlcnZlckxvZ2dlcic7XG5pbXBvcnQgeyB2NSBhcyB1dWlkdjUgfSBmcm9tICd1dWlkJztcblxuLy8gTmFtZXNwYWNlIGZvciBkZXRlcm1pbmlzdGljIHRlbmFudCBJRCBnZW5lcmF0aW9uXG5jb25zdCBURU5BTlRfTkFNRVNQQUNFID0gJzlhNTUxYzQ0LTRhZGUtNGY4OS1iMDc4LTBhZjhiZTc5NGMyMyc7XG5cbi8qKlxuICogQSBtaW5pbWFsIGVuZHBvaW50IHRvIGVuc3VyZSBhIHRlbmFudCByZWNvcmQgZXhpc3RzIGluIHRoZSBkYXRhYmFzZVxuICogVGhpcyBpcyBkZWxpYmVyYXRlbHkgZGVzaWduZWQgdG8gd29yayB3aXRob3V0IGF1dGhlbnRpY2F0aW9uXG4gKiBmb3IgcmVzaWxpZW5jZSBkdXJpbmcgb25ib2FyZGluZyBmbG93c1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0KSB7XG4gIGxldCBwb29sID0gbnVsbDtcbiAgbGV0IHRlbmFudElkID0gJyc7XG4gIGxldCBzY2hlbWFOYW1lID0gJyc7XG4gIFxuICB0cnkge1xuICAgIC8vIFBhcnNlIHJlcXVlc3QgYm9keVxuICAgIGxldCBib2R5O1xuICAgIHRyeSB7XG4gICAgICBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XG4gICAgfSBjYXRjaCAocGFyc2VFcnJvcikge1xuICAgICAgbG9nZ2VyLndhcm4oJ1tFbnN1cmVEQlJlY29yZF0gRmFpbGVkIHRvIHBhcnNlIHJlcXVlc3QgYm9keTonLCBwYXJzZUVycm9yKTtcbiAgICAgIGJvZHkgPSB7fTtcbiAgICB9XG4gICAgXG4gICAgLy8gR2V0IHRlbmFudCBkYXRhIGZyb20gcmVxdWVzdCBib2R5XG4gICAgdGVuYW50SWQgPSBib2R5LnRlbmFudElkIHx8ICcnO1xuICAgIGxldCB1c2VySWQgPSBib2R5LnVzZXJJZCB8fCAnJztcbiAgICBjb25zdCBlbWFpbCA9IGJvZHkuZW1haWwgfHwgJyc7XG4gICAgY29uc3QgYnVzaW5lc3NOYW1lID0gYm9keS5idXNpbmVzc05hbWUgfHwgYm9keS5idXNpbmVzc19uYW1lIHx8ICcnO1xuICAgIGNvbnN0IGJ1c2luZXNzVHlwZSA9IGJvZHkuYnVzaW5lc3NUeXBlIHx8IGJvZHkuYnVzaW5lc3NfdHlwZSB8fCAnT3RoZXInO1xuICAgIFxuICAgIC8vIElmIG5vIHVzZXJJZCBpcyBwcm92aWRlZCwgZ2VuZXJhdGUgYSBwcm9wZXIgVVVJRCBmb3IgaXRcbiAgICBpZiAoIXVzZXJJZCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gR2VuZXJhdGUgYSBVVUlEIHVzaW5nIGEgdGltZXN0YW1wLWJhc2VkIG5hbWVzcGFjZVxuICAgICAgICBjb25zdCBVU0VSX05BTUVTUEFDRSA9ICc4YTU1MWM0NC00YWRlLTRmODktYjA3OC0wYWY4YmU3OTRjMTAnO1xuICAgICAgICB1c2VySWQgPSB1dWlkdjUoYGFub255bW91c18ke0RhdGUubm93KCl9YCwgVVNFUl9OQU1FU1BBQ0UpO1xuICAgICAgICBsb2dnZXIuaW5mbygnW0Vuc3VyZURCUmVjb3JkXSBHZW5lcmF0ZWQgVVVJRCBmb3IgYW5vbnltb3VzIHVzZXI6JywgdXNlcklkKTtcbiAgICAgIH0gY2F0Y2ggKHV1aWRFcnJvcikge1xuICAgICAgICBsb2dnZXIuZXJyb3IoJ1tFbnN1cmVEQlJlY29yZF0gRXJyb3IgZ2VuZXJhdGluZyBVVUlEIGZvciB1c2VyOicsIHV1aWRFcnJvcik7XG4gICAgICAgIC8vIFVzZSBhIGZhbGxiYWNrIElEIHRoYXQncyBhIHZhbGlkIFVVSURcbiAgICAgICAgdXNlcklkID0gJzI4NjA5ZWQyLTFhNDYtNGQ1MC1iYzRlLTQ4M2Q2ZTM0MDVmZic7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIElmIG5vIHRlbmFudCBJRCwgdHJ5IHRvIGdlbmVyYXRlIG9uZSBmcm9tIHVzZXIgSURcbiAgICBpZiAoIXRlbmFudElkICYmIHVzZXJJZCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgdGVuYW50SWQgPSB1dWlkdjUodXNlcklkLCBURU5BTlRfTkFNRVNQQUNFKTtcbiAgICAgICAgbG9nZ2VyLmluZm8oJ1tFbnN1cmVEQlJlY29yZF0gR2VuZXJhdGVkIGRldGVybWluaXN0aWMgdGVuYW50IElEOicsIHRlbmFudElkKTtcbiAgICAgIH0gY2F0Y2ggKHV1aWRFcnJvcikge1xuICAgICAgICBsb2dnZXIuZXJyb3IoJ1tFbnN1cmVEQlJlY29yZF0gRXJyb3IgZ2VuZXJhdGluZyBVVUlEOicsIHV1aWRFcnJvcik7XG4gICAgICAgIC8vIFVzZSBhIGZhbGxiYWNrIElEXG4gICAgICAgIHRlbmFudElkID0gJzE4NjA5ZWQyLTFhNDYtNGQ1MC1iYzRlLTQ4M2Q2ZTM0MDVmZic7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIEZpbmFsIGZhbGxiYWNrIC0gdXNlIGEgZGVmYXVsdCB0ZW5hbnQgSURcbiAgICBpZiAoIXRlbmFudElkKSB7XG4gICAgICB0ZW5hbnRJZCA9ICcxODYwOWVkMi0xYTQ2LTRkNTAtYmM0ZS00ODNkNmUzNDA1ZmYnO1xuICAgICAgbG9nZ2VyLndhcm4oJ1tFbnN1cmVEQlJlY29yZF0gVXNpbmcgZmFsbGJhY2sgdGVuYW50IElEOicsIHRlbmFudElkKTtcbiAgICB9XG4gICAgXG4gICAgLy8gR2VuZXJhdGUgc2NoZW1hIG5hbWUgLSBjb252ZXJ0IGh5cGhlbnMgdG8gdW5kZXJzY29yZXMgZm9yIHNjaGVtYSBuYW1lIChQb3N0Z3JlU1FMIGxpbWl0YXRpb24pXG4gICAgc2NoZW1hTmFtZSA9IGB0ZW5hbnRfJHt0ZW5hbnRJZC5yZXBsYWNlKC8tL2csICdfJyl9YDtcbiAgICBcbiAgICAvLyBDb25uZWN0IGRpcmVjdGx5IHRvIHRoZSBkYXRhYmFzZVxuICAgIHRyeSB7XG4gICAgICAvLyBGaXJzdCBleHBsaWNpdGx5IGNyZWF0ZSB0aGUgdGFibGUgdG8gZW5zdXJlIGl0IGV4aXN0c1xuICAgICAgdHJ5IHtcbiAgICAgICAgbG9nZ2VyLmluZm8oJ1tFbnN1cmVEQlJlY29yZF0gRW5zdXJpbmcgdGFibGUgZXhpc3RzJyk7XG4gICAgICAgIGNvbnN0IGNyZWF0ZVRhYmxlVXJsID0gbmV3IFVSTCgnL2FwaS90ZW5hbnQvY3JlYXRlLXRhYmxlJywgcmVxdWVzdC51cmwpLnRvU3RyaW5nKCk7XG4gICAgICAgIGxvZ2dlci5pbmZvKCdbRW5zdXJlREJSZWNvcmRdIFVzaW5nIGNyZWF0ZS10YWJsZSBVUkw6JywgY3JlYXRlVGFibGVVcmwpO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgY3JlYXRlVGFibGVSZXNwb25zZSA9IGF3YWl0IGZldGNoKGNyZWF0ZVRhYmxlVXJsKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChjcmVhdGVUYWJsZVJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgbG9nZ2VyLmluZm8oJ1tFbnN1cmVEQlJlY29yZF0gVGFibGUgY3JlYXRpb24gY2hlY2sgc3VjY2Vzc2Z1bCcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGxvZ2dlci53YXJuKCdbRW5zdXJlREJSZWNvcmRdIFRhYmxlIGNyZWF0aW9uIGNoZWNrIGZhaWxlZDonLCBcbiAgICAgICAgICAgIGF3YWl0IGNyZWF0ZVRhYmxlUmVzcG9uc2UudGV4dCgpLmNhdGNoKCgpID0+IGNyZWF0ZVRhYmxlUmVzcG9uc2Uuc3RhdHVzLnRvU3RyaW5nKCkpKTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAodGFibGVFcnJvcikge1xuICAgICAgICBsb2dnZXIud2FybignW0Vuc3VyZURCUmVjb3JkXSBFcnJvciBjaGVja2luZy9jcmVhdGluZyB0YWJsZTonLCB0YWJsZUVycm9yLm1lc3NhZ2UpO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBUaGVuIGVuc3VyZSB0aGUgZGF0YWJhc2UgZW52aXJvbm1lbnQgaXMgaW5pdGlhbGl6ZWRcbiAgICAgIHRyeSB7XG4gICAgICAgIGxvZ2dlci5pbmZvKCdbRW5zdXJlREJSZWNvcmRdIEluaXRpYWxpemluZyBkYXRhYmFzZSBlbnZpcm9ubWVudCcpO1xuICAgICAgICBjb25zdCBpbml0VXJsID0gbmV3IFVSTCgnL2FwaS90ZW5hbnQvaW5pdC1kYi1lbnYnLCByZXF1ZXN0LnVybCkudG9TdHJpbmcoKTtcbiAgICAgICAgbG9nZ2VyLmluZm8oJ1tFbnN1cmVEQlJlY29yZF0gVXNpbmcgaW5pdC1kYi1lbnYgVVJMOicsIGluaXRVcmwpO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgaW5pdFJlc3BvbnNlID0gYXdhaXQgZmV0Y2goaW5pdFVybCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoaW5pdFJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgY29uc3QgaW5pdERhdGEgPSBhd2FpdCBpbml0UmVzcG9uc2UuanNvbigpO1xuICAgICAgICAgIGxvZ2dlci5pbmZvKCdbRW5zdXJlREJSZWNvcmRdIERhdGFiYXNlIGluaXRpYWxpemF0aW9uIHN1Y2Nlc3NmdWw6JywgXG4gICAgICAgICAgICBpbml0RGF0YS5tZXNzYWdlLCAnVGFibGUgZXhpc3RzOicsIGluaXREYXRhLnRhYmxlRXhpc3RzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBsb2dnZXIud2FybignW0Vuc3VyZURCUmVjb3JkXSBEYXRhYmFzZSBpbml0aWFsaXphdGlvbiBmYWlsZWQ6JywgXG4gICAgICAgICAgICBhd2FpdCBpbml0UmVzcG9uc2UudGV4dCgpLmNhdGNoKCgpID0+IGluaXRSZXNwb25zZS5zdGF0dXMudG9TdHJpbmcoKSkpO1xuICAgICAgICAgIC8vIENvbnRpbnVlIGFueXdheSwgYXMgdGhlIG9wZXJhdGlvbiBtaWdodCBzdGlsbCBzdWNjZWVkXG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGluaXRFcnJvcikge1xuICAgICAgICBsb2dnZXIud2FybignW0Vuc3VyZURCUmVjb3JkXSBFcnJvciBpbml0aWFsaXppbmcgZGF0YWJhc2UgZW52aXJvbm1lbnQ6JywgaW5pdEVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAvLyBDb250aW51ZSBhbnl3YXksIGFzIHRoZSBvcGVyYXRpb24gbWlnaHQgc3RpbGwgc3VjY2VlZFxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBJbXBvcnQgdGhlIGRhdGFiYXNlIGNvbmZpZ3VyYXRpb24gaGVscGVyXG4gICAgICBjb25zdCB7IGNyZWF0ZURiUG9vbCB9ID0gcmVxdWlyZSgnLi4vZGItY29uZmlnJyk7XG4gICAgICBcbiAgICAgIC8vIEdldCBhIGNvbmZpZ3VyZWQgZGF0YWJhc2UgcG9vbFxuICAgICAgcG9vbCA9IGF3YWl0IGNyZWF0ZURiUG9vbCgpO1xuICAgICAgXG4gICAgICAvLyBMb2cgY29ubmVjdGlvbiBhdHRlbXB0IGZvciBkZWJ1Z2dpbmdcbiAgICAgIGxvZ2dlci5pbmZvKCdbRW5zdXJlREJSZWNvcmRdIENyZWF0ZWQgZGF0YWJhc2UgcG9vbCcpO1xuICAgICAgXG4gICAgICAvLyBQaW5nIGRhdGFiYXNlIHRvIHZlcmlmeSBjb25uZWN0aW9uXG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCBwb29sLnF1ZXJ5KCdTRUxFQ1QgMScpO1xuICAgICAgICBsb2dnZXIuaW5mbygnW0Vuc3VyZURCUmVjb3JkXSBEYXRhYmFzZSBjb25uZWN0aW9uIHN1Y2Nlc3NmdWwnKTtcbiAgICAgIH0gY2F0Y2ggKHBpbmdFcnJvcikge1xuICAgICAgICBsb2dnZXIuZXJyb3IoJ1tFbnN1cmVEQlJlY29yZF0gRGF0YWJhc2UgcGluZyBmYWlsZWQ6JywgcGluZ0Vycm9yLm1lc3NhZ2UpO1xuICAgICAgICB0aHJvdyBwaW5nRXJyb3I7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIEJlZ2luIHRyYW5zYWN0aW9uIGZvciBhdG9taWNpdHlcbiAgICAgIGF3YWl0IHBvb2wucXVlcnkoJ0JFR0lOJyk7XG4gICAgICBcbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIEZpcnN0IGNyZWF0ZSB0aGUgc2NoZW1hXG4gICAgICAgIGF3YWl0IHBvb2wucXVlcnkoYENSRUFURSBTQ0hFTUEgSUYgTk9UIEVYSVNUUyAke3NjaGVtYU5hbWV9O2ApO1xuICAgICAgICBsb2dnZXIuaW5mbygnW0Vuc3VyZURCUmVjb3JkXSBDcmVhdGVkIHNjaGVtYTonLCBzY2hlbWFOYW1lKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFZlcmlmeSBzY2hlbWEgY3JlYXRpb24gYW5kIHdhaXQgaWYgbmVlZGVkXG4gICAgICAgIGxldCBzY2hlbWFFeGlzdHMgPSBmYWxzZTtcbiAgICAgICAgbGV0IHJldHJ5Q291bnQgPSAwO1xuICAgICAgICBjb25zdCBtYXhSZXRyaWVzID0gMztcbiAgICAgICAgXG4gICAgICAgIHdoaWxlICghc2NoZW1hRXhpc3RzICYmIHJldHJ5Q291bnQgPCBtYXhSZXRyaWVzKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIHNjaGVtYSBleGlzdHNcbiAgICAgICAgICAgIGNvbnN0IGNoZWNrU2NoZW1hUXVlcnkgPSBgXG4gICAgICAgICAgICAgIFNFTEVDVCBFWElTVFMgKFxuICAgICAgICAgICAgICAgIFNFTEVDVCBGUk9NIGluZm9ybWF0aW9uX3NjaGVtYS5zY2hlbWF0YSBcbiAgICAgICAgICAgICAgICBXSEVSRSBzY2hlbWFfbmFtZSA9ICQxXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICBgO1xuICAgICAgICAgICAgY29uc3Qgc2NoZW1hUmVzdWx0ID0gYXdhaXQgcG9vbC5xdWVyeShjaGVja1NjaGVtYVF1ZXJ5LCBbc2NoZW1hTmFtZV0pO1xuICAgICAgICAgICAgc2NoZW1hRXhpc3RzID0gc2NoZW1hUmVzdWx0LnJvd3NbMF0uZXhpc3RzO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoc2NoZW1hRXhpc3RzKSB7XG4gICAgICAgICAgICAgIGxvZ2dlci5pbmZvKGBbRW5zdXJlREJSZWNvcmRdIFNjaGVtYSAke3NjaGVtYU5hbWV9IGV4aXN0cyBhbmQgaXMgcmVhZHlgKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIC8vIFdhaXQgYSBiaXQgYmVmb3JlIHJldHJ5aW5nXG4gICAgICAgICAgICAgIGxvZ2dlci5pbmZvKGBbRW5zdXJlREJSZWNvcmRdIFNjaGVtYSAke3NjaGVtYU5hbWV9IG5vdCByZWFkeSB5ZXQsIHdhaXRpbmcuLi4gKGF0dGVtcHQgJHtyZXRyeUNvdW50ICsgMX0vJHttYXhSZXRyaWVzfSlgKTtcbiAgICAgICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDUwMCkpOyAvLyA1MDBtcyBkZWxheVxuICAgICAgICAgICAgICByZXRyeUNvdW50Kys7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBjYXRjaCAoY2hlY2tFcnJvcikge1xuICAgICAgICAgICAgbG9nZ2VyLndhcm4oYFtFbnN1cmVEQlJlY29yZF0gRXJyb3IgY2hlY2tpbmcgc2NoZW1hIGV4aXN0ZW5jZTogJHtjaGVja0Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgICAgICAgICByZXRyeUNvdW50Kys7XG4gICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgNTAwKSk7IC8vIDUwMG1zIGRlbGF5XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBpZiAoIXNjaGVtYUV4aXN0cykge1xuICAgICAgICAgIGxvZ2dlci53YXJuKGBbRW5zdXJlREJSZWNvcmRdIFNjaGVtYSAke3NjaGVtYU5hbWV9IG1heSBub3QgYmUgZnVsbHkgY3JlYXRlZCB5ZXQsIGJ1dCBjb250aW51aW5nLi4uYCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEFkZCBvd25lciB0byB1c2VycyB0YWJsZSBpZiBub3QgZXhpc3RzXG4gICAgICAgIC8vIFRoaXMgaXMgY3JpdGljYWwgZm9yIHByb3BlciB0ZW5hbnQgc2V0dXAgd2l0aCBSTFNcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAvLyBGaXJzdCBpbnNlcnQgYSB1c2VyIHJlY29yZCBpbnRvIGN1c3RvbV9hdXRoX3VzZXJcbiAgICAgICAgICBjb25zdCB1c2VyRW1haWwgPSBib2R5LmVtYWlsIHx8IGAke3VzZXJJZH1AZXhhbXBsZS5jb21gO1xuICAgICAgICAgIGNvbnN0IHVzZXJJbnNlcnRRdWVyeSA9IGBcbiAgICAgICAgICAgIElOU0VSVCBJTlRPIGN1c3RvbV9hdXRoX3VzZXIgKFxuICAgICAgICAgICAgICBpZCwgZW1haWwsIHBhc3N3b3JkLCBpc19hY3RpdmUsIGlzX3N0YWZmLCBpc19zdXBlcnVzZXIsIGRhdGVfam9pbmVkLFxuICAgICAgICAgICAgICBmaXJzdF9uYW1lLCBsYXN0X25hbWUsIGVtYWlsX2NvbmZpcm1lZCwgY29uZmlybWF0aW9uX3Rva2VuLFxuICAgICAgICAgICAgICBpc19vbmJvYXJkZWQsIHJvbGUsIG9jY3VwYXRpb24sIHRlbmFudF9pZFxuICAgICAgICAgICAgKVxuICAgICAgICAgICAgVkFMVUVTIChcbiAgICAgICAgICAgICAgJDEsICQyLCAncGJrZGYyX3NoYTI1NiRwbGFjZWhvbGRlcicsIHRydWUsIGZhbHNlLCBmYWxzZSwgTk9XKCksXG4gICAgICAgICAgICAgICdVc2VyJywgJ1VzZXInLCBmYWxzZSwgZ2VuX3JhbmRvbV91dWlkKCksXG4gICAgICAgICAgICAgIGZhbHNlLCAnT1dORVInLCAnT1dORVInLCAkM1xuICAgICAgICAgICAgKVxuICAgICAgICAgICAgT04gQ09ORkxJQ1QgKGlkKSBETyBOT1RISU5HO1xuICAgICAgICAgIGA7XG4gICAgICAgICAgXG4gICAgICAgICAgYXdhaXQgcG9vbC5xdWVyeSh1c2VySW5zZXJ0UXVlcnksIFt1c2VySWQsIHVzZXJFbWFpbCwgdGVuYW50SWRdKTtcbiAgICAgICAgICBsb2dnZXIuaW5mbygnW0Vuc3VyZURCUmVjb3JkXSBFbnN1cmVkIHVzZXIgcmVjb3JkIGV4aXN0cyBmb3I6JywgdXNlcklkKTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBOb3cgaW5zZXJ0IHRoZSB1c2VyIHByb2ZpbGVcbiAgICAgICAgICBjb25zdCBwcm9maWxlSW5zZXJ0UXVlcnkgPSBgXG4gICAgICAgICAgICBJTlNFUlQgSU5UTyB1c2Vyc191c2VycHJvZmlsZSAoaWQsIHVzZXJfaWQsIHRlbmFudF9pZCwgY3JlYXRlZF9hdCwgdXBkYXRlZF9hdClcbiAgICAgICAgICAgIFZBTFVFUyAoJDEsICQxLCAkMiwgTk9XKCksIE5PVygpKVxuICAgICAgICAgICAgT04gQ09ORkxJQ1QgKGlkKSBETyBOT1RISU5HO1xuICAgICAgICAgIGA7XG4gICAgICAgICAgXG4gICAgICAgICAgYXdhaXQgcG9vbC5xdWVyeShwcm9maWxlSW5zZXJ0UXVlcnksIFt1c2VySWQsIHRlbmFudElkXSk7XG4gICAgICAgICAgbG9nZ2VyLmluZm8oJ1tFbnN1cmVEQlJlY29yZF0gRW5zdXJlZCB1c2VyIHByb2ZpbGUgcmVjb3JkIGV4aXN0cyBmb3I6JywgdXNlcklkKTtcbiAgICAgICAgfSBjYXRjaCAodXNlckVycm9yKSB7XG4gICAgICAgICAgbG9nZ2VyLndhcm4oJ1tFbnN1cmVEQlJlY29yZF0gRXJyb3IgZW5zdXJpbmcgdXNlciBleGlzdHMgKG5vbi1mYXRhbCk6JywgdXNlckVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAgIC8vIENvbnRpbnVlIGV2ZW4gaWYgdXNlciBjcmVhdGlvbiBmYWlsc1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgYnVzaW5lc3MgcmVjb3JkIGlmIG5vdCBleGlzdHNcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBidXNpbmVzc0luc2VydFF1ZXJ5ID0gYFxuICAgICAgICAgICAgSU5TRVJUIElOVE8gdXNlcnNfYnVzaW5lc3MgKGlkLCBuYW1lLCB0ZW5hbnRfaWQsIGNyZWF0ZWRfYXQsIHVwZGF0ZWRfYXQpXG4gICAgICAgICAgICBWQUxVRVMgKCQxLCAkMiwgJDEsIE5PVygpLCBOT1coKSlcbiAgICAgICAgICAgIE9OIENPTkZMSUNUIChpZCkgRE8gVVBEQVRFXG4gICAgICAgICAgICBTRVQgbmFtZSA9ICQyLCB1cGRhdGVkX2F0ID0gTk9XKClcbiAgICAgICAgICAgIFJFVFVSTklORyBpZCwgbmFtZTtcbiAgICAgICAgICBgO1xuICAgICAgICAgIFxuICAgICAgICAgIGNvbnN0IGJ1c2luZXNzSWQgPSB0ZW5hbnRJZDsgLy8gVXNlIHNhbWUgSUQgZm9yIHNpbXBsaWNpdHlcbiAgICAgICAgICBjb25zdCBidXNpbmVzc1Jlc3VsdCA9IGF3YWl0IHBvb2wucXVlcnkoYnVzaW5lc3NJbnNlcnRRdWVyeSwgW2J1c2luZXNzSWQsIGJ1c2luZXNzTmFtZV0pO1xuICAgICAgICAgIFxuICAgICAgICAgIGlmIChidXNpbmVzc1Jlc3VsdC5yb3dzICYmIGJ1c2luZXNzUmVzdWx0LnJvd3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgbG9nZ2VyLmluZm8oJ1tFbnN1cmVEQlJlY29yZF0gQnVzaW5lc3MgcmVjb3JkIGluc2VydGVkL3VwZGF0ZWQ6JywgYnVzaW5lc3NSZXN1bHQucm93c1swXSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChidXNpbmVzc0Vycm9yKSB7XG4gICAgICAgICAgbG9nZ2VyLndhcm4oJ1tFbnN1cmVEQlJlY29yZF0gRXJyb3IgZW5zdXJpbmcgYnVzaW5lc3MgZXhpc3RzIChub24tZmF0YWwpOicsIGJ1c2luZXNzRXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgLy8gQ29udGludWUgZXZlbiBpZiBidXNpbmVzcyBjcmVhdGlvbiBmYWlsc1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBDcmVhdGUgdGVuYW50IHJlY29yZFxuICAgICAgICBjb25zdCB0ZW5hbnRJbnNlcnRRdWVyeSA9IGBcbiAgICAgICAgICBJTlNFUlQgSU5UTyBjdXN0b21fYXV0aF90ZW5hbnQgKFxuICAgICAgICAgICAgaWQsIG5hbWUsIG93bmVyX2lkLCBzY2hlbWFfbmFtZSwgY3JlYXRlZF9hdCwgdXBkYXRlZF9hdCxcbiAgICAgICAgICAgIHJsc19lbmFibGVkLCBybHNfc2V0dXBfZGF0ZVxuICAgICAgICAgIClcbiAgICAgICAgICBWQUxVRVMgKCQxLCAkMiwgJDMsICQ0LCBOT1coKSwgTk9XKCksIHRydWUsIE5PVygpKVxuICAgICAgICAgIE9OIENPTkZMSUNUIChpZCkgRE8gVVBEQVRFXG4gICAgICAgICAgU0VUIG5hbWUgPSAkMiwgdXBkYXRlZF9hdCA9IE5PVygpXG4gICAgICAgICAgUkVUVVJOSU5HIGlkLCBuYW1lLCBzY2hlbWFfbmFtZSwgb3duZXJfaWQsIHJsc19lbmFibGVkO1xuICAgICAgICBgO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgdGVuYW50UmVzdWx0ID0gYXdhaXQgcG9vbC5xdWVyeSh0ZW5hbnRJbnNlcnRRdWVyeSwgW1xuICAgICAgICAgIHRlbmFudElkLCBcbiAgICAgICAgICBidXNpbmVzc05hbWUsXG4gICAgICAgICAgdXNlcklkLCBcbiAgICAgICAgICBzY2hlbWFOYW1lXG4gICAgICAgIF0pO1xuICAgICAgICBcbiAgICAgICAgaWYgKHRlbmFudFJlc3VsdC5yb3dzICYmIHRlbmFudFJlc3VsdC5yb3dzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBsb2dnZXIuaW5mbygnW0Vuc3VyZURCUmVjb3JkXSBUZW5hbnQgcmVjb3JkIGluc2VydGVkL3VwZGF0ZWQ6JywgdGVuYW50UmVzdWx0LnJvd3NbMF0pO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIFNldCB1cCBSTFMgcG9saWN5IHJpZ2h0IGF3YXlcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gR3JhbnQgcGVybWlzc2lvbnNcbiAgICAgICAgICAgIGF3YWl0IHBvb2wucXVlcnkoYEdSQU5UIFVTQUdFIE9OIFNDSEVNQSAke3NjaGVtYU5hbWV9IFRPIGRvdHRfYWRtaW47YCk7XG4gICAgICAgICAgICBhd2FpdCBwb29sLnF1ZXJ5KGBHUkFOVCBBTEwgUFJJVklMRUdFUyBPTiBTQ0hFTUEgJHtzY2hlbWFOYW1lfSBUTyBkb3R0X2FkbWluO2ApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBDaGVjayBpZiBwcm9kdWN0IHRhYmxlIGV4aXN0cyBpbiB0aGUgc2NoZW1hLCBjcmVhdGUgaWYgbm90XG4gICAgICAgICAgICBjb25zdCBjaGVja1RhYmxlUXVlcnkgPSBgXG4gICAgICAgICAgICAgIFNFTEVDVCBFWElTVFMgKFxuICAgICAgICAgICAgICAgIFNFTEVDVCBGUk9NIGluZm9ybWF0aW9uX3NjaGVtYS50YWJsZXMgXG4gICAgICAgICAgICAgICAgV0hFUkUgdGFibGVfc2NoZW1hID0gJyR7c2NoZW1hTmFtZX0nIFxuICAgICAgICAgICAgICAgIEFORCB0YWJsZV9uYW1lID0gJ3Byb2R1Y3QnXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICBgO1xuICAgICAgICAgICAgY29uc3QgdGFibGVFeGlzdHMgPSBhd2FpdCBwb29sLnF1ZXJ5KGNoZWNrVGFibGVRdWVyeSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIElmIHByb2R1Y3QgdGFibGUgZG9lc24ndCBleGlzdCwgY3JlYXRlIGl0XG4gICAgICAgICAgICBpZiAoIXRhYmxlRXhpc3RzLnJvd3NbMF0uZXhpc3RzKSB7XG4gICAgICAgICAgICAgIGxvZ2dlci5pbmZvKGBbRW5zdXJlREJSZWNvcmRdIFByb2R1Y3QgdGFibGUgZG9lc24ndCBleGlzdCBpbiBzY2hlbWEgJHtzY2hlbWFOYW1lfSwgY3JlYXRpbmcgaXRgKTtcbiAgICAgICAgICAgICAgY29uc3QgY3JlYXRlVGFibGVRdWVyeSA9IGBcbiAgICAgICAgICAgICAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyAke3NjaGVtYU5hbWV9LnByb2R1Y3QgKFxuICAgICAgICAgICAgICAgICAgaWQgVVVJRCBQUklNQVJZIEtFWSBERUZBVUxUIGdlbl9yYW5kb21fdXVpZCgpLFxuICAgICAgICAgICAgICAgICAgbmFtZSBWQVJDSEFSKDI1NSkgTk9UIE5VTEwsXG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiBURVhULFxuICAgICAgICAgICAgICAgICAgcHJpY2UgREVDSU1BTCgxMCwgMiksXG4gICAgICAgICAgICAgICAgICB0ZW5hbnRfaWQgVVVJRCBOT1QgTlVMTCxcbiAgICAgICAgICAgICAgICAgIGNyZWF0ZWRfYXQgVElNRVNUQU1QIFdJVEggVElNRSBaT05FIERFRkFVTFQgTk9XKCksXG4gICAgICAgICAgICAgICAgICB1cGRhdGVkX2F0IFRJTUVTVEFNUCBXSVRIIFRJTUUgWk9ORSBERUZBVUxUIE5PVygpXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgYDtcbiAgICAgICAgICAgICAgYXdhaXQgcG9vbC5xdWVyeShjcmVhdGVUYWJsZVF1ZXJ5KTtcbiAgICAgICAgICAgICAgbG9nZ2VyLmluZm8oYFtFbnN1cmVEQlJlY29yZF0gQ3JlYXRlZCBwcm9kdWN0IHRhYmxlIGluIHNjaGVtYSAke3NjaGVtYU5hbWV9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIENyZWF0ZSBhIGJhc2ljIFJMUyBwb2xpY3kgKHRoaXMgd2lsbCBiZSBleHBhbmRlZCB0aHJvdWdoIG1pZ3JhdGlvbnMpXG4gICAgICAgICAgICBjb25zdCBybHNRdWVyeSA9IGBcbiAgICAgICAgICAgICAgQUxURVIgVEFCTEUgSUYgRVhJU1RTICR7c2NoZW1hTmFtZX0ucHJvZHVjdCBFTkFCTEUgUk9XIExFVkVMIFNFQ1VSSVRZO1xuICAgICAgICAgICAgICBEUk9QIFBPTElDWSBJRiBFWElTVFMgdGVuYW50X2lzb2xhdGlvbl9wb2xpY3kgT04gJHtzY2hlbWFOYW1lfS5wcm9kdWN0O1xuICAgICAgICAgICAgICBDUkVBVEUgUE9MSUNZIHRlbmFudF9pc29sYXRpb25fcG9saWN5IE9OICR7c2NoZW1hTmFtZX0ucHJvZHVjdCBcbiAgICAgICAgICAgICAgVVNJTkcgKHRlbmFudF9pZCA9ICcke3RlbmFudElkfScpXG4gICAgICAgICAgICAgIFdJVEggQ0hFQ0sgKHRlbmFudF9pZCA9ICcke3RlbmFudElkfScpO1xuICAgICAgICAgICAgYDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgYXdhaXQgcG9vbC5xdWVyeShybHNRdWVyeSk7XG4gICAgICAgICAgICBsb2dnZXIuaW5mbygnW0Vuc3VyZURCUmVjb3JkXSBTZXQgdXAgUkxTIHBvbGljeSBmb3Igc2NoZW1hJyk7XG4gICAgICAgICAgfSBjYXRjaCAocmxzRXJyb3IpIHtcbiAgICAgICAgICAgIGxvZ2dlci53YXJuKCdbRW5zdXJlREJSZWNvcmRdIEVycm9yIHNldHRpbmcgdXAgUkxTIHBvbGljeSAobm9uLWZhdGFsKTonLCBybHNFcnJvci5tZXNzYWdlKTtcbiAgICAgICAgICAgIC8vIENvbnRpbnVlIGV2ZW4gaWYgUkxTIHNldHVwIGZhaWxzXG4gICAgICAgICAgfVxuICAgICAgICAgIFxuICAgICAgICAgIC8vIFVwZGF0ZSB1c2VyIHByb2ZpbGUgd2l0aCBidXNpbmVzcyBJRFxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCB1c2VyUHJvZmlsZVF1ZXJ5ID0gYFxuICAgICAgICAgICAgICBVUERBVEUgdXNlcnNfdXNlcnByb2ZpbGUgXG4gICAgICAgICAgICAgIFNFVCBidXNpbmVzc19pZCA9ICQxXG4gICAgICAgICAgICAgIFdIRVJFIGlkID0gJDI7XG4gICAgICAgICAgICBgO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBhd2FpdCBwb29sLnF1ZXJ5KHVzZXJQcm9maWxlUXVlcnksIFt0ZW5hbnRJZCwgdXNlcklkXSk7XG4gICAgICAgICAgICBsb2dnZXIuaW5mbygnW0Vuc3VyZURCUmVjb3JkXSBVcGRhdGVkIHVzZXIgcHJvZmlsZSB3aXRoIGJ1c2luZXNzIElEJyk7XG4gICAgICAgICAgfSBjYXRjaCAocHJvZmlsZUVycm9yKSB7XG4gICAgICAgICAgICBsb2dnZXIud2FybignW0Vuc3VyZURCUmVjb3JkXSBFcnJvciB1cGRhdGluZyB1c2VyIHByb2ZpbGUgKG5vbi1mYXRhbCk6JywgcHJvZmlsZUVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAgICAgLy8gQ29udGludWUgZXZlbiBpZiBwcm9maWxlIHVwZGF0ZSBmYWlsc1xuICAgICAgICAgIH1cbiAgICAgICAgICBcbiAgICAgICAgICAvLyBDb21taXQgdGhlIHRyYW5zYWN0aW9uXG4gICAgICAgICAgYXdhaXQgcG9vbC5xdWVyeSgnQ09NTUlUJyk7XG4gICAgICAgICAgbG9nZ2VyLmluZm8oJ1tFbnN1cmVEQlJlY29yZF0gVHJhbnNhY3Rpb24gY29tbWl0dGVkIHN1Y2Nlc3NmdWxseScpO1xuICAgICAgICAgIFxuICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgdGVuYW50SWQ6IHRlbmFudFJlc3VsdC5yb3dzWzBdLmlkLFxuICAgICAgICAgICAgbmFtZTogdGVuYW50UmVzdWx0LnJvd3NbMF0ubmFtZSxcbiAgICAgICAgICAgIHNjaGVtYU5hbWU6IHRlbmFudFJlc3VsdC5yb3dzWzBdLnNjaGVtYV9uYW1lLFxuICAgICAgICAgICAgb3duZXJJZDogdGVuYW50UmVzdWx0LnJvd3NbMF0ub3duZXJfaWQsXG4gICAgICAgICAgICBybHNFbmFibGVkOiB0ZW5hbnRSZXN1bHQucm93c1swXS5ybHNfZW5hYmxlZCxcbiAgICAgICAgICAgIGNyZWF0ZWQ6IHRydWUsXG4gICAgICAgICAgICBtZXNzYWdlOiAnU3VjY2Vzc2Z1bGx5IGNyZWF0ZWQgdGVuYW50IHJlY29yZCBhbmQgc2NoZW1hJ1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRlbmFudCByZWNvcmQgY3JlYXRpb24gZGlkbid0IHJldHVybiBleHBlY3RlZCBkYXRhXCIpO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoICh0cmFuc2FjdGlvbkVycm9yKSB7XG4gICAgICAgIC8vIFJvbGxiYWNrIG9uIGFueSBlcnJvclxuICAgICAgICBhd2FpdCBwb29sLnF1ZXJ5KCdST0xMQkFDSycpO1xuICAgICAgICBsb2dnZXIuZXJyb3IoJ1tFbnN1cmVEQlJlY29yZF0gVHJhbnNhY3Rpb24gZmFpbGVkOicsIHRyYW5zYWN0aW9uRXJyb3IubWVzc2FnZSk7XG4gICAgICAgIHRocm93IHRyYW5zYWN0aW9uRXJyb3I7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZGJFcnJvcikge1xuICAgICAgLy8gUmVyYWlzZSBmb3Igb3V0ZXIgY2F0Y2ggYmxvY2tcbiAgICAgIHRocm93IGRiRXJyb3I7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIC8vIENsb3NlIGNvbm5lY3Rpb25cbiAgICAgIGlmIChwb29sKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgYXdhaXQgcG9vbC5lbmQoKTtcbiAgICAgICAgICBsb2dnZXIuaW5mbygnW0Vuc3VyZURCUmVjb3JkXSBEYXRhYmFzZSBjb25uZWN0aW9uIGNsb3NlZCcpO1xuICAgICAgICB9IGNhdGNoIChjbG9zZUVycm9yKSB7XG4gICAgICAgICAgbG9nZ2VyLmVycm9yKCdbRW5zdXJlREJSZWNvcmRdIEVycm9yIGNsb3NpbmcgY29ubmVjdGlvbjonLCBjbG9zZUVycm9yLm1lc3NhZ2UpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGxvZ2dlci5lcnJvcignW0Vuc3VyZURCUmVjb3JkXSBFcnJvciBjcmVhdGluZyB0ZW5hbnQgcmVjb3JkOicsIGVycm9yLm1lc3NhZ2UpO1xuICAgIFxuICAgIC8vIEFsd2F5cyByZXR1cm4gYSB2YWxpZCBKU09OIHJlc3BvbnNlLCBldmVuIG9uIGVycm9yc1xuICAgIC8vIEFkZCBwcm9wZXIgQ29udGVudC1UeXBlIGhlYWRlciB0byBlbnN1cmUgYnJvd3NlciB0cmVhdHMgaXQgYXMgSlNPTlxuICAgIHJldHVybiBuZXcgTmV4dFJlc3BvbnNlKEpTT04uc3RyaW5naWZ5KHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICB0ZW5hbnRJZCxcbiAgICAgIHNjaGVtYU5hbWUsXG4gICAgICBjbGllbnRTaWRlT25seTogdHJ1ZSxcbiAgICAgIG1lc3NhZ2U6ICdGYWlsZWQgdG8gY3JlYXRlIHRlbmFudCByZWNvcmQgaW4gZGF0YWJhc2UsIGJ1dCBjbGllbnQgY2FuIHVzZSB0ZW5hbnQgSUQnLFxuICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2VcbiAgICB9KSwge1xuICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufSJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJsb2dnZXIiLCJ2NSIsInV1aWR2NSIsIlRFTkFOVF9OQU1FU1BBQ0UiLCJQT1NUIiwicmVxdWVzdCIsInBvb2wiLCJ0ZW5hbnRJZCIsInNjaGVtYU5hbWUiLCJib2R5IiwianNvbiIsInBhcnNlRXJyb3IiLCJ3YXJuIiwidXNlcklkIiwiZW1haWwiLCJidXNpbmVzc05hbWUiLCJidXNpbmVzc19uYW1lIiwiYnVzaW5lc3NUeXBlIiwiYnVzaW5lc3NfdHlwZSIsIlVTRVJfTkFNRVNQQUNFIiwiRGF0ZSIsIm5vdyIsImluZm8iLCJ1dWlkRXJyb3IiLCJlcnJvciIsInJlcGxhY2UiLCJjcmVhdGVUYWJsZVVybCIsIlVSTCIsInVybCIsInRvU3RyaW5nIiwiY3JlYXRlVGFibGVSZXNwb25zZSIsImZldGNoIiwib2siLCJ0ZXh0IiwiY2F0Y2giLCJzdGF0dXMiLCJ0YWJsZUVycm9yIiwibWVzc2FnZSIsImluaXRVcmwiLCJpbml0UmVzcG9uc2UiLCJpbml0RGF0YSIsInRhYmxlRXhpc3RzIiwiaW5pdEVycm9yIiwiY3JlYXRlRGJQb29sIiwicmVxdWlyZSIsInF1ZXJ5IiwicGluZ0Vycm9yIiwic2NoZW1hRXhpc3RzIiwicmV0cnlDb3VudCIsIm1heFJldHJpZXMiLCJjaGVja1NjaGVtYVF1ZXJ5Iiwic2NoZW1hUmVzdWx0Iiwicm93cyIsImV4aXN0cyIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsImNoZWNrRXJyb3IiLCJ1c2VyRW1haWwiLCJ1c2VySW5zZXJ0UXVlcnkiLCJwcm9maWxlSW5zZXJ0UXVlcnkiLCJ1c2VyRXJyb3IiLCJidXNpbmVzc0luc2VydFF1ZXJ5IiwiYnVzaW5lc3NJZCIsImJ1c2luZXNzUmVzdWx0IiwibGVuZ3RoIiwiYnVzaW5lc3NFcnJvciIsInRlbmFudEluc2VydFF1ZXJ5IiwidGVuYW50UmVzdWx0IiwiY2hlY2tUYWJsZVF1ZXJ5IiwiY3JlYXRlVGFibGVRdWVyeSIsInJsc1F1ZXJ5IiwicmxzRXJyb3IiLCJ1c2VyUHJvZmlsZVF1ZXJ5IiwicHJvZmlsZUVycm9yIiwic3VjY2VzcyIsImlkIiwibmFtZSIsInNjaGVtYV9uYW1lIiwib3duZXJJZCIsIm93bmVyX2lkIiwicmxzRW5hYmxlZCIsInJsc19lbmFibGVkIiwiY3JlYXRlZCIsIkVycm9yIiwidHJhbnNhY3Rpb25FcnJvciIsImRiRXJyb3IiLCJlbmQiLCJjbG9zZUVycm9yIiwiSlNPTiIsInN0cmluZ2lmeSIsImNsaWVudFNpZGVPbmx5IiwiaGVhZGVycyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/tenant/ensure-db-record/route.js\n");

/***/ }),

/***/ "(rsc)/./src/utils/serverLogger.js":
/*!***********************************!*\
  !*** ./src/utils/serverLogger.js ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createContextualServerLogger: () => (/* binding */ createContextualServerLogger),\n/* harmony export */   createServerLogger: () => (/* binding */ createServerLogger),\n/* harmony export */   debug: () => (/* binding */ debug),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   error: () => (/* binding */ error),\n/* harmony export */   info: () => (/* binding */ info),\n/* harmony export */   logger: () => (/* binding */ logger),\n/* harmony export */   serverLogger: () => (/* binding */ serverLogger),\n/* harmony export */   warn: () => (/* binding */ warn)\n/* harmony export */ });\n// Server-side logger implementation\n// This file should be imported in API routes instead of the client-side logger\n/**\n * Server-side logger utility\n * \n * This logger is specifically designed for server components and API routes\n * where the client-side logger with browser-specific APIs can't be used.\n */ /**\n * Format log prefix to include timestamp and context\n */ function formatPrefix(level, context = {}) {\n    const timestamp = new Date().toISOString();\n    const tenantId = context.tenantId || 'no-tenant';\n    return `[${timestamp}] [SERVER:${level}] [${tenantId}]`;\n}\n/**\n * Server logger instance with standard logging methods\n */ const serverLogger = {\n    /**\n   * Log at DEBUG level\n   */ debug: (message, data, context = {})=>{\n        const prefix = formatPrefix('DEBUG', context);\n        if (data !== undefined) {\n            console.debug(`${prefix} ${message}`, data);\n        } else {\n            console.debug(`${prefix} ${message}`);\n        }\n    },\n    /**\n   * Log at INFO level\n   */ info: (message, data, context = {})=>{\n        const prefix = formatPrefix('INFO', context);\n        if (data !== undefined) {\n            console.info(`${prefix} ${message}`, data);\n        } else {\n            console.info(`${prefix} ${message}`);\n        }\n    },\n    /**\n   * Log at WARN level\n   */ warn: (message, data, context = {})=>{\n        const prefix = formatPrefix('WARN', context);\n        if (data !== undefined) {\n            console.warn(`${prefix} ${message}`, data);\n        } else {\n            console.warn(`${prefix} ${message}`);\n        }\n    },\n    /**\n   * Log at ERROR level\n   */ error: (message, data, context = {})=>{\n        const prefix = formatPrefix('ERROR', context);\n        if (data !== undefined) {\n            console.error(`${prefix} ${message}`, data);\n        } else {\n            console.error(`${prefix} ${message}`);\n        }\n    }\n};\n/**\n * Create a contextualized server logger with pre-bound context\n */ function createContextualServerLogger(context = {}) {\n    return {\n        debug: (message, data)=>serverLogger.debug(message, data, context),\n        info: (message, data)=>serverLogger.info(message, data, context),\n        warn: (message, data)=>serverLogger.warn(message, data, context),\n        error: (message, data)=>serverLogger.error(message, data, context)\n    };\n}\n/**\n * Legacy function for backward compatibility with existing imports\n * Creates a logger with a namespace\n */ function createServerLogger(namespace = 'API') {\n    return {\n        debug: (message, ...args)=>serverLogger.debug(`[${namespace}] ${message}`, args.length ? args[0] : undefined),\n        info: (message, ...args)=>serverLogger.info(`[${namespace}] ${message}`, args.length ? args[0] : undefined),\n        warn: (message, ...args)=>serverLogger.warn(`[${namespace}] ${message}`, args.length ? args[0] : undefined),\n        error: (message, ...args)=>serverLogger.error(`[${namespace}] ${message}`, args.length ? args[0] : undefined),\n        log: (message, ...args)=>serverLogger.info(`[${namespace}] ${message}`, args.length ? args[0] : undefined)\n    };\n}\n// Create a default server logger instance for compatibility with existing imports\nconst logger = createServerLogger('API');\n// Export individual functions directly from serverLogger for convenience\nconst debug = serverLogger.debug;\nconst info = serverLogger.info;\nconst warn = serverLogger.warn;\nconst error = serverLogger.error;\n// For CommonJS compatibility\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({\n    serverLogger,\n    logger,\n    debug,\n    info,\n    warn,\n    error,\n    createContextualServerLogger,\n    createServerLogger\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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U0FBUyxHQUFHVyxPQUFTYixhQUFhTyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUVLLFVBQVUsRUFBRSxFQUFFVixTQUFTLEVBQUVXLEtBQUtDLE1BQU0sR0FBR0QsSUFBSSxDQUFDLEVBQUUsR0FBR1I7UUFDbkdHLE1BQU0sQ0FBQ04sU0FBUyxHQUFHVyxPQUFTYixhQUFhUSxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUVJLFVBQVUsRUFBRSxFQUFFVixTQUFTLEVBQUVXLEtBQUtDLE1BQU0sR0FBR0QsSUFBSSxDQUFDLEVBQUUsR0FBR1I7UUFDbkdJLE9BQU8sQ0FBQ1AsU0FBUyxHQUFHVyxPQUFTYixhQUFhUyxLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUVHLFVBQVUsRUFBRSxFQUFFVixTQUFTLEVBQUVXLEtBQUtDLE1BQU0sR0FBR0QsSUFBSSxDQUFDLEVBQUUsR0FBR1I7UUFDckdVLEtBQUssQ0FBQ2IsU0FBUyxHQUFHVyxPQUFTYixhQUFhTyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUVLLFVBQVUsRUFBRSxFQUFFVixTQUFTLEVBQUVXLEtBQUtDLE1BQU0sR0FBR0QsSUFBSSxDQUFDLEVBQUUsR0FBR1I7SUFDcEc7QUFDRjtBQUVBLGtGQUFrRjtBQUMzRSxNQUFNVyxTQUFTTCxtQkFBbUIsT0FBTztBQUVoRCx5RUFBeUU7QUFDbEUsTUFBTVYsUUFBUUQsYUFBYUMsS0FBSyxDQUFDO0FBQ2pDLE1BQU1NLE9BQU9QLGFBQWFPLElBQUksQ0FBQztBQUMvQixNQUFNQyxPQUFPUixhQUFhUSxJQUFJLENBQUM7QUFDL0IsTUFBTUMsUUFBUVQsYUFBYVMsS0FBSyxDQUFDO0FBRXhDLDZCQUE2QjtBQUM3QixpRUFBZTtJQUNiVDtJQUNBZ0I7SUFDQWY7SUFDQU07SUFDQUM7SUFDQUM7SUFDQUM7SUFDQUM7QUFDRixDQUFDLEVBQUMiLCJzb3VyY2VzIjpbIi9Vc2Vycy9rdW9sZGVuZy9wcm9qZWN0eC9mcm9udGVuZC9weWZhY3Rvcl9uZXh0L3NyYy91dGlscy9zZXJ2ZXJMb2dnZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gU2VydmVyLXNpZGUgbG9nZ2VyIGltcGxlbWVudGF0aW9uXG4vLyBUaGlzIGZpbGUgc2hvdWxkIGJlIGltcG9ydGVkIGluIEFQSSByb3V0ZXMgaW5zdGVhZCBvZiB0aGUgY2xpZW50LXNpZGUgbG9nZ2VyXG5cbi8qKlxuICogU2VydmVyLXNpZGUgbG9nZ2VyIHV0aWxpdHlcbiAqIFxuICogVGhpcyBsb2dnZXIgaXMgc3BlY2lmaWNhbGx5IGRlc2lnbmVkIGZvciBzZXJ2ZXIgY29tcG9uZW50cyBhbmQgQVBJIHJvdXRlc1xuICogd2hlcmUgdGhlIGNsaWVudC1zaWRlIGxvZ2dlciB3aXRoIGJyb3dzZXItc3BlY2lmaWMgQVBJcyBjYW4ndCBiZSB1c2VkLlxuICovXG5cbi8qKlxuICogRm9ybWF0IGxvZyBwcmVmaXggdG8gaW5jbHVkZSB0aW1lc3RhbXAgYW5kIGNvbnRleHRcbiAqL1xuZnVuY3Rpb24gZm9ybWF0UHJlZml4KGxldmVsLCBjb250ZXh0ID0ge30pIHtcbiAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xuICBjb25zdCB0ZW5hbnRJZCA9IGNvbnRleHQudGVuYW50SWQgfHwgJ25vLXRlbmFudCc7XG4gIHJldHVybiBgWyR7dGltZXN0YW1wfV0gW1NFUlZFUjoke2xldmVsfV0gWyR7dGVuYW50SWR9XWA7XG59XG5cbi8qKlxuICogU2VydmVyIGxvZ2dlciBpbnN0YW5jZSB3aXRoIHN0YW5kYXJkIGxvZ2dpbmcgbWV0aG9kc1xuICovXG5leHBvcnQgY29uc3Qgc2VydmVyTG9nZ2VyID0ge1xuICAvKipcbiAgICogTG9nIGF0IERFQlVHIGxldmVsXG4gICAqL1xuICBkZWJ1ZzogKG1lc3NhZ2UsIGRhdGEsIGNvbnRleHQgPSB7fSkgPT4ge1xuICAgIGNvbnN0IHByZWZpeCA9IGZvcm1hdFByZWZpeCgnREVCVUcnLCBjb250ZXh0KTtcbiAgICBpZiAoZGF0YSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBjb25zb2xlLmRlYnVnKGAke3ByZWZpeH0gJHttZXNzYWdlfWAsIGRhdGEpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmRlYnVnKGAke3ByZWZpeH0gJHttZXNzYWdlfWApO1xuICAgIH1cbiAgfSxcbiAgXG4gIC8qKlxuICAgKiBMb2cgYXQgSU5GTyBsZXZlbFxuICAgKi9cbiAgaW5mbzogKG1lc3NhZ2UsIGRhdGEsIGNvbnRleHQgPSB7fSkgPT4ge1xuICAgIGNvbnN0IHByZWZpeCA9IGZvcm1hdFByZWZpeCgnSU5GTycsIGNvbnRleHQpO1xuICAgIGlmIChkYXRhICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGNvbnNvbGUuaW5mbyhgJHtwcmVmaXh9ICR7bWVzc2FnZX1gLCBkYXRhKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5pbmZvKGAke3ByZWZpeH0gJHttZXNzYWdlfWApO1xuICAgIH1cbiAgfSxcbiAgXG4gIC8qKlxuICAgKiBMb2cgYXQgV0FSTiBsZXZlbFxuICAgKi9cbiAgd2FybjogKG1lc3NhZ2UsIGRhdGEsIGNvbnRleHQgPSB7fSkgPT4ge1xuICAgIGNvbnN0IHByZWZpeCA9IGZvcm1hdFByZWZpeCgnV0FSTicsIGNvbnRleHQpO1xuICAgIGlmIChkYXRhICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGNvbnNvbGUud2FybihgJHtwcmVmaXh9ICR7bWVzc2FnZX1gLCBkYXRhKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS53YXJuKGAke3ByZWZpeH0gJHttZXNzYWdlfWApO1xuICAgIH1cbiAgfSxcbiAgXG4gIC8qKlxuICAgKiBMb2cgYXQgRVJST1IgbGV2ZWxcbiAgICovXG4gIGVycm9yOiAobWVzc2FnZSwgZGF0YSwgY29udGV4dCA9IHt9KSA9PiB7XG4gICAgY29uc3QgcHJlZml4ID0gZm9ybWF0UHJlZml4KCdFUlJPUicsIGNvbnRleHQpO1xuICAgIGlmIChkYXRhICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYCR7cHJlZml4fSAke21lc3NhZ2V9YCwgZGF0YSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYCR7cHJlZml4fSAke21lc3NhZ2V9YCk7XG4gICAgfVxuICB9XG59O1xuXG4vKipcbiAqIENyZWF0ZSBhIGNvbnRleHR1YWxpemVkIHNlcnZlciBsb2dnZXIgd2l0aCBwcmUtYm91bmQgY29udGV4dFxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQ29udGV4dHVhbFNlcnZlckxvZ2dlcihjb250ZXh0ID0ge30pIHtcbiAgcmV0dXJuIHtcbiAgICBkZWJ1ZzogKG1lc3NhZ2UsIGRhdGEpID0+IHNlcnZlckxvZ2dlci5kZWJ1ZyhtZXNzYWdlLCBkYXRhLCBjb250ZXh0KSxcbiAgICBpbmZvOiAobWVzc2FnZSwgZGF0YSkgPT4gc2VydmVyTG9nZ2VyLmluZm8obWVzc2FnZSwgZGF0YSwgY29udGV4dCksXG4gICAgd2FybjogKG1lc3NhZ2UsIGRhdGEpID0+IHNlcnZlckxvZ2dlci53YXJuKG1lc3NhZ2UsIGRhdGEsIGNvbnRleHQpLFxuICAgIGVycm9yOiAobWVzc2FnZSwgZGF0YSkgPT4gc2VydmVyTG9nZ2VyLmVycm9yKG1lc3NhZ2UsIGRhdGEsIGNvbnRleHQpXG4gIH07XG59XG5cbi8qKlxuICogTGVnYWN5IGZ1bmN0aW9uIGZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5IHdpdGggZXhpc3RpbmcgaW1wb3J0c1xuICogQ3JlYXRlcyBhIGxvZ2dlciB3aXRoIGEgbmFtZXNwYWNlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVTZXJ2ZXJMb2dnZXIobmFtZXNwYWNlID0gJ0FQSScpIHtcbiAgcmV0dXJuIHtcbiAgICBkZWJ1ZzogKG1lc3NhZ2UsIC4uLmFyZ3MpID0+IHNlcnZlckxvZ2dlci5kZWJ1ZyhgWyR7bmFtZXNwYWNlfV0gJHttZXNzYWdlfWAsIGFyZ3MubGVuZ3RoID8gYXJnc1swXSA6IHVuZGVmaW5lZCksXG4gICAgaW5mbzogKG1lc3NhZ2UsIC4uLmFyZ3MpID0+IHNlcnZlckxvZ2dlci5pbmZvKGBbJHtuYW1lc3BhY2V9XSAke21lc3NhZ2V9YCwgYXJncy5sZW5ndGggPyBhcmdzWzBdIDogdW5kZWZpbmVkKSxcbiAgICB3YXJuOiAobWVzc2FnZSwgLi4uYXJncykgPT4gc2VydmVyTG9nZ2VyLndhcm4oYFske25hbWVzcGFjZX1dICR7bWVzc2FnZX1gLCBhcmdzLmxlbmd0aCA/IGFyZ3NbMF0gOiB1bmRlZmluZWQpLFxuICAgIGVycm9yOiAobWVzc2FnZSwgLi4uYXJncykgPT4gc2VydmVyTG9nZ2VyLmVycm9yKGBbJHtuYW1lc3BhY2V9XSAke21lc3NhZ2V9YCwgYXJncy5sZW5ndGggPyBhcmdzWzBdIDogdW5kZWZpbmVkKSxcbiAgICBsb2c6IChtZXNzYWdlLCAuLi5hcmdzKSA9PiBzZXJ2ZXJMb2dnZXIuaW5mbyhgWyR7bmFtZXNwYWNlfV0gJHttZXNzYWdlfWAsIGFyZ3MubGVuZ3RoID8gYXJnc1swXSA6IHVuZGVmaW5lZClcbiAgfTtcbn1cblxuLy8gQ3JlYXRlIGEgZGVmYXVsdCBzZXJ2ZXIgbG9nZ2VyIGluc3RhbmNlIGZvciBjb21wYXRpYmlsaXR5IHdpdGggZXhpc3RpbmcgaW1wb3J0c1xuZXhwb3J0IGNvbnN0IGxvZ2dlciA9IGNyZWF0ZVNlcnZlckxvZ2dlcignQVBJJyk7XG5cbi8vIEV4cG9ydCBpbmRpdmlkdWFsIGZ1bmN0aW9ucyBkaXJlY3RseSBmcm9tIHNlcnZlckxvZ2dlciBmb3IgY29udmVuaWVuY2VcbmV4cG9ydCBjb25zdCBkZWJ1ZyA9IHNlcnZlckxvZ2dlci5kZWJ1ZztcbmV4cG9ydCBjb25zdCBpbmZvID0gc2VydmVyTG9nZ2VyLmluZm87XG5leHBvcnQgY29uc3Qgd2FybiA9IHNlcnZlckxvZ2dlci53YXJuO1xuZXhwb3J0IGNvbnN0IGVycm9yID0gc2VydmVyTG9nZ2VyLmVycm9yO1xuXG4vLyBGb3IgQ29tbW9uSlMgY29tcGF0aWJpbGl0eVxuZXhwb3J0IGRlZmF1bHQge1xuICBzZXJ2ZXJMb2dnZXIsXG4gIGxvZ2dlcixcbiAgZGVidWcsIFxuICBpbmZvLFxuICB3YXJuLFxuICBlcnJvcixcbiAgY3JlYXRlQ29udGV4dHVhbFNlcnZlckxvZ2dlcixcbiAgY3JlYXRlU2VydmVyTG9nZ2VyXG59OyAiXSwibmFtZXMiOlsiZm9ybWF0UHJlZml4IiwibGV2ZWwiLCJjb250ZXh0IiwidGltZXN0YW1wIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwidGVuYW50SWQiLCJzZXJ2ZXJMb2dnZXIiLCJkZWJ1ZyIsIm1lc3NhZ2UiLCJkYXRhIiwicHJlZml4IiwidW5kZWZpbmVkIiwiY29uc29sZSIsImluZm8iLCJ3YXJuIiwiZXJyb3IiLCJjcmVhdGVDb250ZXh0dWFsU2VydmVyTG9nZ2VyIiwiY3JlYXRlU2VydmVyTG9nZ2VyIiwibmFtZXNwYWNlIiwiYXJncyIsImxlbmd0aCIsImxvZyIsImxvZ2dlciJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/utils/serverLogger.js\n");

/***/ }),

/***/ "(ssr)/../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!*******************************************************************************************************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \*******************************************************************************************************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "../app-render/work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

"use strict";
module.exports = require("@prisma/client");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "pg":
/*!*********************!*\
  !*** external "pg" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("pg");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1","vendor-chunks/uuid"], () => (__webpack_exec__("(rsc)/../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Ftenant%2Fensure-db-record%2Froute&page=%2Fapi%2Ftenant%2Fensure-db-record%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftenant%2Fensure-db-record%2Froute.js&appDir=%2FUsers%2Fkuoldeng%2Fprojectx%2Ffrontend%2Fpyfactor_next%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fkuoldeng%2Fprojectx%2Ffrontend%2Fpyfactor_next&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();