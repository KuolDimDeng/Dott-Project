/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/onboarding/business-info/route";
exports.ids = ["app/api/onboarding/business-info/route"];
exports.modules = {

/***/ "(rsc)/../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fonboarding%2Fbusiness-info%2Froute&page=%2Fapi%2Fonboarding%2Fbusiness-info%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fonboarding%2Fbusiness-info%2Froute.js&appDir=%2FUsers%2Fkuoldeng%2Fprojectx%2Ffrontend%2Fpyfactor_next%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fkuoldeng%2Fprojectx%2Ffrontend%2Fpyfactor_next&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fonboarding%2Fbusiness-info%2Froute&page=%2Fapi%2Fonboarding%2Fbusiness-info%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fonboarding%2Fbusiness-info%2Froute.js&appDir=%2FUsers%2Fkuoldeng%2Fprojectx%2Ffrontend%2Fpyfactor_next%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fkuoldeng%2Fprojectx%2Ffrontend%2Fpyfactor_next&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_kuoldeng_projectx_frontend_pyfactor_next_src_app_api_onboarding_business_info_route_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/onboarding/business-info/route.js */ \"(rsc)/./src/app/api/onboarding/business-info/route.js\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/onboarding/business-info/route\",\n        pathname: \"/api/onboarding/business-info\",\n        filename: \"route\",\n        bundlePath: \"app/api/onboarding/business-info/route\"\n    },\n    resolvedPagePath: \"/Users/kuoldeng/projectx/frontend/pyfactor_next/src/app/api/onboarding/business-info/route.js\",\n    nextConfigOutput,\n    userland: _Users_kuoldeng_projectx_frontend_pyfactor_next_src_app_api_onboarding_business_info_route_js__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL25leHRAMTUuMi4yX0BiYWJlbCtjb3JlQDcuMjYuMTBfcmVhY3QtZG9tQDE4LjMuMV9yZWFjdEAxOC4zLjEvbm9kZV9tb2R1bGVzL25leHQvZGlzdC9idWlsZC93ZWJwYWNrL2xvYWRlcnMvbmV4dC1hcHAtbG9hZGVyL2luZGV4LmpzP25hbWU9YXBwJTJGYXBpJTJGb25ib2FyZGluZyUyRmJ1c2luZXNzLWluZm8lMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRm9uYm9hcmRpbmclMkZidXNpbmVzcy1pbmZvJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGb25ib2FyZGluZyUyRmJ1c2luZXNzLWluZm8lMkZyb3V0ZS5qcyZhcHBEaXI9JTJGVXNlcnMlMkZrdW9sZGVuZyUyRnByb2plY3R4JTJGZnJvbnRlbmQlMkZweWZhY3Rvcl9uZXh0JTJGc3JjJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRmt1b2xkZW5nJTJGcHJvamVjdHglMkZmcm9udGVuZCUyRnB5ZmFjdG9yX25leHQmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQStGO0FBQ3ZDO0FBQ3FCO0FBQzZDO0FBQzFIO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix5R0FBbUI7QUFDM0M7QUFDQSxjQUFjLGtFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsc0RBQXNEO0FBQzlEO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQzBGOztBQUUxRiIsInNvdXJjZXMiOlsiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvVXNlcnMva3VvbGRlbmcvcHJvamVjdHgvZnJvbnRlbmQvcHlmYWN0b3JfbmV4dC9zcmMvYXBwL2FwaS9vbmJvYXJkaW5nL2J1c2luZXNzLWluZm8vcm91dGUuanNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL29uYm9hcmRpbmcvYnVzaW5lc3MtaW5mby9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL29uYm9hcmRpbmcvYnVzaW5lc3MtaW5mb1wiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvb25ib2FyZGluZy9idXNpbmVzcy1pbmZvL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1VzZXJzL2t1b2xkZW5nL3Byb2plY3R4L2Zyb250ZW5kL3B5ZmFjdG9yX25leHQvc3JjL2FwcC9hcGkvb25ib2FyZGluZy9idXNpbmVzcy1pbmZvL3JvdXRlLmpzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgd29ya0FzeW5jU3RvcmFnZSwgd29ya1VuaXRBc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgd29ya0FzeW5jU3RvcmFnZSxcbiAgICAgICAgd29ya1VuaXRBc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCB3b3JrQXN5bmNTdG9yYWdlLCB3b3JrVW5pdEFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fonboarding%2Fbusiness-info%2Froute&page=%2Fapi%2Fonboarding%2Fbusiness-info%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fonboarding%2Fbusiness-info%2Froute.js&appDir=%2FUsers%2Fkuoldeng%2Fprojectx%2Ffrontend%2Fpyfactor_next%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fkuoldeng%2Fprojectx%2Ffrontend%2Fpyfactor_next&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!*******************************************************************************************************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \*******************************************************************************************************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./src/app/api/onboarding/business-info/route.js":
/*!*******************************************************!*\
  !*** ./src/app/api/onboarding/business-info/route.js ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/api/server.js\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/headers */ \"(rsc)/../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _utils_getServerUser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/utils/getServerUser */ \"(rsc)/./src/utils/getServerUser.js\");\n// Server component - no 'use client' directive needed for API routes\n\n\n\n// Increased cookie expiration for onboarding (7 days)\nconst COOKIE_MAX_AGE = 7 * 24 * 60 * 60;\nconst COOKIE_OPTIONS = {\n    path: '/',\n    maxAge: COOKIE_MAX_AGE,\n    httpOnly: false,\n    sameSite: 'lax'\n};\n/**\n * Ensure a proper response is always returned\n */ function createSafeResponse(data, status = 200, additionalHeaders = null) {\n    try {\n        // Create response object with headers\n        const headers = additionalHeaders || new Headers();\n        headers.append('Content-Type', 'application/json');\n        headers.append('Cache-Control', 'no-cache, no-store');\n        // Add navigation header for subscription page\n        headers.append('X-Next-Route', '/onboarding/subscription');\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(data, {\n            status,\n            headers\n        });\n    } catch (error) {\n        console.error('[api/onboarding/business-info] Error creating response:', error);\n        // Absolutely minimal response that should never fail\n        const headers = new Headers();\n        headers.append('Content-Type', 'application/json');\n        headers.append('Cache-Control', 'no-cache, no-store');\n        headers.append('X-Next-Route', '/onboarding/subscription');\n        return new Response(JSON.stringify({\n            success: false,\n            error: 'Failed to create response'\n        }), {\n            status: 500,\n            headers\n        });\n    }\n}\n/**\n * Handle business information update\n */ async function POST(request) {\n    try {\n        console.log('[api/onboarding/business-info] POST request received');\n        // Get request body, handling empty requests gracefully\n        let data = {};\n        try {\n            if (request.body) {\n                data = await request.json();\n                console.log('[api/onboarding/business-info] Request body parsed:', {\n                    fields: Object.keys(data)\n                });\n            }\n        } catch (parseError) {\n            console.warn('[api/onboarding/business-info] Error parsing request body:', parseError.message);\n        // Continue with empty data object\n        }\n        console.log('[api/onboarding/business-info] Setting up response data');\n        // Start the cookie setup early\n        const responseData = {\n            success: true,\n            message: 'Business information updated successfully',\n            nextRoute: '/onboarding/subscription'\n        };\n        console.log('[api/onboarding/business-info] About to access cookies');\n        // Set critical cookies immediately\n        try {\n            const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n            console.log('[api/onboarding/business-info] Setting cookies');\n            // Mark business info step as completed\n            await cookieStore.set('businessInfoCompleted', 'true', COOKIE_OPTIONS);\n            await cookieStore.set('onboardingStep', 'subscription', COOKIE_OPTIONS);\n            await cookieStore.set('onboardedStatus', 'BUSINESS_INFO', COOKIE_OPTIONS);\n            // Set timestamp for token verification\n            await cookieStore.set('lastOnboardingUpdate', new Date().toISOString(), COOKIE_OPTIONS);\n            console.log('[api/onboarding/business-info] Cookies set successfully');\n        } catch (cookieError) {\n            console.error('[api/onboarding/business-info] Error setting cookies:', cookieError);\n            throw new Error(`Cookie error: ${cookieError.message}`);\n        }\n        // Check for faster path header\n        const headers = Object.fromEntries(request.headers.entries());\n        const isFastPath = headers['x-fast-path'] === 'true';\n        // Set navigation response header to help with redirect\n        const responseHeaders = new Headers();\n        responseHeaders.append('X-Next-Route', '/onboarding/subscription');\n        // If fast path, return immediately with just the navigation cookies\n        if (isFastPath) {\n            console.log('[api/onboarding/business-info] Using fast path, returning early');\n            return createSafeResponse(responseData, 200, responseHeaders);\n        }\n        console.log('[api/onboarding/business-info] Getting server user');\n        // Try to get authenticated user but don't fail if not present\n        let user = null;\n        try {\n            user = await (0,_utils_getServerUser__WEBPACK_IMPORTED_MODULE_2__.getServerUser)(request);\n            console.log('[api/onboarding/business-info] User retrieved:', {\n                hasUser: !!user\n            });\n        } catch (authError) {\n            console.error('[api/onboarding/business-info] Auth error:', {\n                message: authError.message,\n                code: authError.code,\n                name: authError.name\n            });\n        // Continue processing without user\n        }\n        // Ensure we have at least some data - use defaults if necessary\n        const businessName = data.businessName || user?.attributes?.['custom:businessname'] || '';\n        const businessType = data.businessType || user?.attributes?.['custom:businesstype'] || '';\n        const country = data.country || user?.attributes?.['custom:businesscountry'] || '';\n        const legalStructure = data.legalStructure || user?.attributes?.['custom:legalstructure'] || '';\n        console.log('[api/onboarding/business-info] Business info update:', {\n            userPresent: !!user,\n            fields: Object.keys(data),\n            businessName,\n            businessType\n        });\n        try {\n            const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n            // Store business info in cookies\n            await cookieStore.set('businessName', businessName, COOKIE_OPTIONS);\n            await cookieStore.set('businessType', businessType, COOKIE_OPTIONS);\n            // Only set these if they have values\n            if (country) {\n                await cookieStore.set('businessCountry', country, COOKIE_OPTIONS);\n            }\n            if (legalStructure) {\n                await cookieStore.set('legalStructure', legalStructure, COOKIE_OPTIONS);\n            }\n        } catch (cookieError) {\n            console.error('[api/onboarding/business-info] Error setting additional cookies:', cookieError);\n        // Continue even if these cookies fail\n        }\n        console.log('[api/onboarding/business-info] Creating successful response');\n        // Update response with business info\n        return createSafeResponse({\n            success: true,\n            message: 'Business information updated successfully',\n            nextRoute: '/onboarding/subscription',\n            businessInfo: {\n                businessName,\n                businessType,\n                country,\n                legalStructure\n            }\n        });\n    } catch (error) {\n        console.error('[api/onboarding/business-info] Error updating business info:', {\n            message: error.message,\n            name: error.name,\n            stack: error.stack\n        });\n        // Even on error, still try to set the essential cookies\n        try {\n            const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n            // Mark business info step as completed\n            await cookieStore.set('businessInfoCompleted', 'true', COOKIE_OPTIONS);\n            await cookieStore.set('onboardingStep', 'subscription', COOKIE_OPTIONS);\n            await cookieStore.set('onboardedStatus', 'BUSINESS_INFO', COOKIE_OPTIONS);\n            return createSafeResponse({\n                success: false,\n                error: 'Failed to update business information',\n                message: error.message,\n                fallback: true\n            }, 500);\n        } catch (cookieError) {\n            // Last resort error response if even cookie setting fails\n            console.error('[api/onboarding/business-info] Fatal error setting cookies:', cookieError);\n            return createSafeResponse({\n                success: false,\n                error: 'Critical error updating business information',\n                message: error.message,\n                fallback: true\n            }, 500);\n        }\n    }\n}\n/**\n * Get existing business information\n */ async function GET(request) {\n    try {\n        console.log('[api/onboarding/business-info] GET request received');\n        // Simplified error handling - get cookies first\n        let cookieStore;\n        try {\n            cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n            console.log('[api/onboarding/business-info] Got cookies successfully');\n        } catch (cookieError) {\n            console.error('[api/onboarding/business-info] Error accessing cookies:', cookieError);\n            // Return empty response that won't break the client\n            return createSafeResponse({\n                businessInfo: {},\n                error: 'Failed to access cookies'\n            });\n        }\n        // Get values from cookies as fallback data source\n        const businessNameCookie = cookieStore.get('businessName')?.value || '';\n        const businessTypeCookie = cookieStore.get('businessType')?.value || '';\n        const countryCookie = cookieStore.get('businessCountry')?.value || '';\n        const legalStructureCookie = cookieStore.get('legalStructure')?.value || '';\n        console.log('[api/onboarding/business-info] Read cookies:', {\n            hasBusinessName: !!businessNameCookie,\n            hasBusinessType: !!businessTypeCookie\n        });\n        // Try to get user but don't fail if not available\n        let user = null;\n        try {\n            console.log('[api/onboarding/business-info] Attempting to get server user');\n            user = await (0,_utils_getServerUser__WEBPACK_IMPORTED_MODULE_2__.getServerUser)(request);\n            console.log('[api/onboarding/business-info] Got user successfully');\n        } catch (authError) {\n            console.warn('[api/onboarding/business-info] Auth error but continuing:', {\n                message: authError.message,\n                code: authError.code\n            });\n        // Continue without user\n        }\n        // Get values from user attributes as another data source\n        const userBusinessName = user?.attributes?.['custom:businessname'] || '';\n        const userBusinessType = user?.attributes?.['custom:businesstype'] || '';\n        const userCountry = user?.attributes?.['custom:businesscountry'] || '';\n        const userLegalStructure = user?.attributes?.['custom:legalstructure'] || '';\n        // Combine values, preferring cookies over user attributes\n        const businessName = businessNameCookie || userBusinessName || '';\n        const businessType = businessTypeCookie || userBusinessType || '';\n        const country = countryCookie || userCountry || '';\n        const legalStructure = legalStructureCookie || userLegalStructure || '';\n        console.log('[api/onboarding/business-info] Assembled business info from sources');\n        // Create a safe response\n        return createSafeResponse({\n            businessInfo: {\n                businessName,\n                businessType,\n                country,\n                legalStructure\n            },\n            source: businessNameCookie ? 'cookies' : userBusinessName ? 'user' : 'empty'\n        });\n    } catch (error) {\n        // Log error but return a valid empty response\n        console.error('[api/onboarding/business-info] GET: Error retrieving business info:', {\n            message: error.message,\n            stack: error.stack\n        });\n        // Return minimal valid response that won't break the client\n        return createSafeResponse({\n            businessInfo: {},\n            error: 'Failed to retrieve business information'\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9vbmJvYXJkaW5nL2J1c2luZXNzLWluZm8vcm91dGUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQSxxRUFBcUU7QUFFMUI7QUFDSjtBQUNlO0FBRXRELHNEQUFzRDtBQUN0RCxNQUFNRyxpQkFBaUIsSUFBSSxLQUFLLEtBQUs7QUFDckMsTUFBTUMsaUJBQWlCO0lBQ3JCQyxNQUFNO0lBQ05DLFFBQVFIO0lBQ1JJLFVBQVU7SUFDVkMsVUFBVTtBQUNaO0FBRUE7O0NBRUMsR0FDRCxTQUFTQyxtQkFBbUJDLElBQUksRUFBRUMsU0FBUyxHQUFHLEVBQUVDLG9CQUFvQixJQUFJO0lBQ3RFLElBQUk7UUFDRixzQ0FBc0M7UUFDdEMsTUFBTUMsVUFBVUQscUJBQXFCLElBQUlFO1FBQ3pDRCxRQUFRRSxNQUFNLENBQUMsZ0JBQWdCO1FBQy9CRixRQUFRRSxNQUFNLENBQUMsaUJBQWlCO1FBRWhDLDhDQUE4QztRQUM5Q0YsUUFBUUUsTUFBTSxDQUFDLGdCQUFnQjtRQUUvQixPQUFPZixxREFBWUEsQ0FBQ2dCLElBQUksQ0FBQ04sTUFBTTtZQUM3QkM7WUFDQUU7UUFDRjtJQUNGLEVBQUUsT0FBT0ksT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsMkRBQTJEQTtRQUN6RSxxREFBcUQ7UUFDckQsTUFBTUosVUFBVSxJQUFJQztRQUNwQkQsUUFBUUUsTUFBTSxDQUFDLGdCQUFnQjtRQUMvQkYsUUFBUUUsTUFBTSxDQUFDLGlCQUFpQjtRQUNoQ0YsUUFBUUUsTUFBTSxDQUFDLGdCQUFnQjtRQUUvQixPQUFPLElBQUlJLFNBQVNDLEtBQUtDLFNBQVMsQ0FBQztZQUFFQyxTQUFTO1lBQU9MLE9BQU87UUFBNEIsSUFBSTtZQUMxRk4sUUFBUTtZQUNSRTtRQUNGO0lBQ0Y7QUFDRjtBQUVBOztDQUVDLEdBQ00sZUFBZVUsS0FBS0MsT0FBTztJQUNoQyxJQUFJO1FBQ0ZOLFFBQVFPLEdBQUcsQ0FBQztRQUVaLHVEQUF1RDtRQUN2RCxJQUFJZixP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QUMsNkRBQTZEO2dCQUN4RUMsU0FBU2UsVUFBVWYsT0FBTztnQkFDMUJnQixNQUFNRCxVQUFVQyxJQUFJO1lBQ3RCO1FBQ0Esd0JBQXdCO1FBQzFCO1FBRUEseURBQXlEO1FBQ3pELE1BQU1vQixtQkFBbUJ2QixNQUFNTSxZQUFZLENBQUMsc0JBQXNCLElBQUk7UUFDdEUsTUFBTWtCLG1CQUFtQnhCLE1BQU1NLFlBQVksQ0FBQyxzQkFBc0IsSUFBSTtRQUN0RSxNQUFNbUIsY0FBY3pCLE1BQU1NLFlBQVksQ0FBQyx5QkFBeUIsSUFBSTtRQUNwRSxNQUFNb0IscUJBQXFCMUIsTUFBTU0sWUFBWSxDQUFDLHdCQUF3QixJQUFJO1FBRTFFLDBEQUEwRDtRQUMxRCxNQUFNRCxlQUFlVSxzQkFBc0JRLG9CQUFvQjtRQUMvRCxNQUFNaEIsZUFBZVcsc0JBQXNCTSxvQkFBb0I7UUFDL0QsTUFBTWhCLFVBQVVXLGlCQUFpQk0sZUFBZTtRQUNoRCxNQUFNaEIsaUJBQWlCVyx3QkFBd0JNLHNCQUFzQjtRQUVyRXJELFFBQVFPLEdBQUcsQ0FBQztRQUVaLHlCQUF5QjtRQUN6QixPQUFPaEIsbUJBQW1CO1lBQ3hCK0MsY0FBYztnQkFDWk47Z0JBQ0FFO2dCQUNBQztnQkFDQUM7WUFDRjtZQUNBa0IsUUFBUVoscUJBQXFCLFlBQWFRLG1CQUFtQixTQUFTO1FBQ3hFO0lBQ0YsRUFBRSxPQUFPbkQsT0FBTztRQUNkLDhDQUE4QztRQUM5Q0MsUUFBUUQsS0FBSyxDQUFDLHVFQUF1RTtZQUNuRmUsU0FBU2YsTUFBTWUsT0FBTztZQUN0QnlCLE9BQU94QyxNQUFNd0MsS0FBSztRQUNwQjtRQUVBLDREQUE0RDtRQUM1RCxPQUFPaEQsbUJBQW1CO1lBQ3hCK0MsY0FBYyxDQUFDO1lBQ2Z2QyxPQUFPO1FBQ1Q7SUFDRjtBQUNGIiwic291cmNlcyI6WyIvVXNlcnMva3VvbGRlbmcvcHJvamVjdHgvZnJvbnRlbmQvcHlmYWN0b3JfbmV4dC9zcmMvYXBwL2FwaS9vbmJvYXJkaW5nL2J1c2luZXNzLWluZm8vcm91dGUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gU2VydmVyIGNvbXBvbmVudCAtIG5vICd1c2UgY2xpZW50JyBkaXJlY3RpdmUgbmVlZGVkIGZvciBBUEkgcm91dGVzXG5cbmltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcbmltcG9ydCB7IGNvb2tpZXMgfSBmcm9tICduZXh0L2hlYWRlcnMnO1xuaW1wb3J0IHsgZ2V0U2VydmVyVXNlciB9IGZyb20gJ0AvdXRpbHMvZ2V0U2VydmVyVXNlcic7XG5cbi8vIEluY3JlYXNlZCBjb29raWUgZXhwaXJhdGlvbiBmb3Igb25ib2FyZGluZyAoNyBkYXlzKVxuY29uc3QgQ09PS0lFX01BWF9BR0UgPSA3ICogMjQgKiA2MCAqIDYwO1xuY29uc3QgQ09PS0lFX09QVElPTlMgPSB7XG4gIHBhdGg6ICcvJyxcbiAgbWF4QWdlOiBDT09LSUVfTUFYX0FHRSxcbiAgaHR0cE9ubHk6IGZhbHNlLFxuICBzYW1lU2l0ZTogJ2xheCdcbn07XG5cbi8qKlxuICogRW5zdXJlIGEgcHJvcGVyIHJlc3BvbnNlIGlzIGFsd2F5cyByZXR1cm5lZFxuICovXG5mdW5jdGlvbiBjcmVhdGVTYWZlUmVzcG9uc2UoZGF0YSwgc3RhdHVzID0gMjAwLCBhZGRpdGlvbmFsSGVhZGVycyA9IG51bGwpIHtcbiAgdHJ5IHtcbiAgICAvLyBDcmVhdGUgcmVzcG9uc2Ugb2JqZWN0IHdpdGggaGVhZGVyc1xuICAgIGNvbnN0IGhlYWRlcnMgPSBhZGRpdGlvbmFsSGVhZGVycyB8fCBuZXcgSGVhZGVycygpO1xuICAgIGhlYWRlcnMuYXBwZW5kKCdDb250ZW50LVR5cGUnLCAnYXBwbGljYXRpb24vanNvbicpO1xuICAgIGhlYWRlcnMuYXBwZW5kKCdDYWNoZS1Db250cm9sJywgJ25vLWNhY2hlLCBuby1zdG9yZScpO1xuICAgIFxuICAgIC8vIEFkZCBuYXZpZ2F0aW9uIGhlYWRlciBmb3Igc3Vic2NyaXB0aW9uIHBhZ2VcbiAgICBoZWFkZXJzLmFwcGVuZCgnWC1OZXh0LVJvdXRlJywgJy9vbmJvYXJkaW5nL3N1YnNjcmlwdGlvbicpO1xuICAgIFxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihkYXRhLCB7IFxuICAgICAgc3RhdHVzLCBcbiAgICAgIGhlYWRlcnMgXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignW2FwaS9vbmJvYXJkaW5nL2J1c2luZXNzLWluZm9dIEVycm9yIGNyZWF0aW5nIHJlc3BvbnNlOicsIGVycm9yKTtcbiAgICAvLyBBYnNvbHV0ZWx5IG1pbmltYWwgcmVzcG9uc2UgdGhhdCBzaG91bGQgbmV2ZXIgZmFpbFxuICAgIGNvbnN0IGhlYWRlcnMgPSBuZXcgSGVhZGVycygpO1xuICAgIGhlYWRlcnMuYXBwZW5kKCdDb250ZW50LVR5cGUnLCAnYXBwbGljYXRpb24vanNvbicpO1xuICAgIGhlYWRlcnMuYXBwZW5kKCdDYWNoZS1Db250cm9sJywgJ25vLWNhY2hlLCBuby1zdG9yZScpO1xuICAgIGhlYWRlcnMuYXBwZW5kKCdYLU5leHQtUm91dGUnLCAnL29uYm9hcmRpbmcvc3Vic2NyaXB0aW9uJyk7XG4gICAgXG4gICAgcmV0dXJuIG5ldyBSZXNwb25zZShKU09OLnN0cmluZ2lmeSh7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0ZhaWxlZCB0byBjcmVhdGUgcmVzcG9uc2UnIH0pLCB7XG4gICAgICBzdGF0dXM6IDUwMCxcbiAgICAgIGhlYWRlcnNcbiAgICB9KTtcbiAgfVxufVxuXG4vKipcbiAqIEhhbmRsZSBidXNpbmVzcyBpbmZvcm1hdGlvbiB1cGRhdGVcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnNvbGUubG9nKCdbYXBpL29uYm9hcmRpbmcvYnVzaW5lc3MtaW5mb10gUE9TVCByZXF1ZXN0IHJlY2VpdmVkJyk7XG4gICAgXG4gICAgLy8gR2V0IHJlcXVlc3QgYm9keSwgaGFuZGxpbmcgZW1wdHkgcmVxdWVzdHMgZ3JhY2VmdWxseVxuICAgIGxldCBkYXRhID0ge307XG4gICAgdHJ5IHtcbiAgICAgIGlmIChyZXF1ZXN0LmJvZHkpIHtcbiAgICAgICAgZGF0YSA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xuICAgICAgICBjb25zb2xlLmxvZygnW2FwaS9vbmJvYXJkaW5nL2J1c2luZXNzLWluZm9dIFJlcXVlc3QgYm9keSBwYXJzZWQ6JywgeyBmaWVsZHM6IE9iamVjdC5rZXlzKGRhdGEpIH0pO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKHBhcnNlRXJyb3IpIHtcbiAgICAgIGNvbnNvbGUud2FybignW2FwaS9vbmJvYXJkaW5nL2J1c2luZXNzLWluZm9dIEVycm9yIHBhcnNpbmcgcmVxdWVzdCBib2R5OicsIHBhcnNlRXJyb3IubWVzc2FnZSk7XG4gICAgICAvLyBDb250aW51ZSB3aXRoIGVtcHR5IGRhdGEgb2JqZWN0XG4gICAgfVxuICAgIFxuICAgIGNvbnNvbGUubG9nKCdbYXBpL29uYm9hcmRpbmcvYnVzaW5lc3MtaW5mb10gU2V0dGluZyB1cCByZXNwb25zZSBkYXRhJyk7XG4gICAgXG4gICAgLy8gU3RhcnQgdGhlIGNvb2tpZSBzZXR1cCBlYXJseVxuICAgIGNvbnN0IHJlc3BvbnNlRGF0YSA9IHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBtZXNzYWdlOiAnQnVzaW5lc3MgaW5mb3JtYXRpb24gdXBkYXRlZCBzdWNjZXNzZnVsbHknLFxuICAgICAgbmV4dFJvdXRlOiAnL29uYm9hcmRpbmcvc3Vic2NyaXB0aW9uJ1xuICAgIH07XG4gICAgXG4gICAgY29uc29sZS5sb2coJ1thcGkvb25ib2FyZGluZy9idXNpbmVzcy1pbmZvXSBBYm91dCB0byBhY2Nlc3MgY29va2llcycpO1xuICAgIFxuICAgIC8vIFNldCBjcml0aWNhbCBjb29raWVzIGltbWVkaWF0ZWx5XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGNvb2tpZVN0b3JlID0gYXdhaXQgY29va2llcygpO1xuICAgICAgXG4gICAgICBjb25zb2xlLmxvZygnW2FwaS9vbmJvYXJkaW5nL2J1c2luZXNzLWluZm9dIFNldHRpbmcgY29va2llcycpO1xuICAgICAgXG4gICAgICAvLyBNYXJrIGJ1c2luZXNzIGluZm8gc3RlcCBhcyBjb21wbGV0ZWRcbiAgICAgIGF3YWl0IGNvb2tpZVN0b3JlLnNldCgnYnVzaW5lc3NJbmZvQ29tcGxldGVkJywgJ3RydWUnLCBDT09LSUVfT1BUSU9OUyk7XG4gICAgICBhd2FpdCBjb29raWVTdG9yZS5zZXQoJ29uYm9hcmRpbmdTdGVwJywgJ3N1YnNjcmlwdGlvbicsIENPT0tJRV9PUFRJT05TKTtcbiAgICAgIGF3YWl0IGNvb2tpZVN0b3JlLnNldCgnb25ib2FyZGVkU3RhdHVzJywgJ0JVU0lORVNTX0lORk8nLCBDT09LSUVfT1BUSU9OUyk7XG4gICAgICBcbiAgICAgIC8vIFNldCB0aW1lc3RhbXAgZm9yIHRva2VuIHZlcmlmaWNhdGlvblxuICAgICAgYXdhaXQgY29va2llU3RvcmUuc2V0KCdsYXN0T25ib2FyZGluZ1VwZGF0ZScsIG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSwgQ09PS0lFX09QVElPTlMpO1xuICAgICAgXG4gICAgICBjb25zb2xlLmxvZygnW2FwaS9vbmJvYXJkaW5nL2J1c2luZXNzLWluZm9dIENvb2tpZXMgc2V0IHN1Y2Nlc3NmdWxseScpO1xuICAgIH0gY2F0Y2ggKGNvb2tpZUVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbYXBpL29uYm9hcmRpbmcvYnVzaW5lc3MtaW5mb10gRXJyb3Igc2V0dGluZyBjb29raWVzOicsIGNvb2tpZUVycm9yKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgQ29va2llIGVycm9yOiAke2Nvb2tpZUVycm9yLm1lc3NhZ2V9YCk7XG4gICAgfVxuICAgIFxuICAgIC8vIENoZWNrIGZvciBmYXN0ZXIgcGF0aCBoZWFkZXJcbiAgICBjb25zdCBoZWFkZXJzID0gT2JqZWN0LmZyb21FbnRyaWVzKHJlcXVlc3QuaGVhZGVycy5lbnRyaWVzKCkpO1xuICAgIGNvbnN0IGlzRmFzdFBhdGggPSBoZWFkZXJzWyd4LWZhc3QtcGF0aCddID09PSAndHJ1ZSc7XG4gICAgXG4gICAgLy8gU2V0IG5hdmlnYXRpb24gcmVzcG9uc2UgaGVhZGVyIHRvIGhlbHAgd2l0aCByZWRpcmVjdFxuICAgIGNvbnN0IHJlc3BvbnNlSGVhZGVycyA9IG5ldyBIZWFkZXJzKCk7XG4gICAgcmVzcG9uc2VIZWFkZXJzLmFwcGVuZCgnWC1OZXh0LVJvdXRlJywgJy9vbmJvYXJkaW5nL3N1YnNjcmlwdGlvbicpO1xuICAgIFxuICAgIC8vIElmIGZhc3QgcGF0aCwgcmV0dXJuIGltbWVkaWF0ZWx5IHdpdGgganVzdCB0aGUgbmF2aWdhdGlvbiBjb29raWVzXG4gICAgaWYgKGlzRmFzdFBhdGgpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdbYXBpL29uYm9hcmRpbmcvYnVzaW5lc3MtaW5mb10gVXNpbmcgZmFzdCBwYXRoLCByZXR1cm5pbmcgZWFybHknKTtcbiAgICAgIHJldHVybiBjcmVhdGVTYWZlUmVzcG9uc2UocmVzcG9uc2VEYXRhLCAyMDAsIHJlc3BvbnNlSGVhZGVycyk7XG4gICAgfVxuICAgIFxuICAgIGNvbnNvbGUubG9nKCdbYXBpL29uYm9hcmRpbmcvYnVzaW5lc3MtaW5mb10gR2V0dGluZyBzZXJ2ZXIgdXNlcicpO1xuICAgIFxuICAgIC8vIFRyeSB0byBnZXQgYXV0aGVudGljYXRlZCB1c2VyIGJ1dCBkb24ndCBmYWlsIGlmIG5vdCBwcmVzZW50XG4gICAgbGV0IHVzZXIgPSBudWxsO1xuICAgIHRyeSB7XG4gICAgICB1c2VyID0gYXdhaXQgZ2V0U2VydmVyVXNlcihyZXF1ZXN0KTtcbiAgICAgIGNvbnNvbGUubG9nKCdbYXBpL29uYm9hcmRpbmcvYnVzaW5lc3MtaW5mb10gVXNlciByZXRyaWV2ZWQ6JywgeyBoYXNVc2VyOiAhIXVzZXIgfSk7XG4gICAgfSBjYXRjaCAoYXV0aEVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbYXBpL29uYm9hcmRpbmcvYnVzaW5lc3MtaW5mb10gQXV0aCBlcnJvcjonLCB7XG4gICAgICAgIG1lc3NhZ2U6IGF1dGhFcnJvci5tZXNzYWdlLFxuICAgICAgICBjb2RlOiBhdXRoRXJyb3IuY29kZSxcbiAgICAgICAgbmFtZTogYXV0aEVycm9yLm5hbWVcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICAvLyBDb250aW51ZSBwcm9jZXNzaW5nIHdpdGhvdXQgdXNlclxuICAgIH1cbiAgICBcbiAgICAvLyBFbnN1cmUgd2UgaGF2ZSBhdCBsZWFzdCBzb21lIGRhdGEgLSB1c2UgZGVmYXVsdHMgaWYgbmVjZXNzYXJ5XG4gICAgY29uc3QgYnVzaW5lc3NOYW1lID0gZGF0YS5idXNpbmVzc05hbWUgfHwgdXNlcj8uYXR0cmlidXRlcz8uWydjdXN0b206YnVzaW5lc3NuYW1lJ10gfHwgJyc7XG4gICAgY29uc3QgYnVzaW5lc3NUeXBlID0gZGF0YS5idXNpbmVzc1R5cGUgfHwgdXNlcj8uYXR0cmlidXRlcz8uWydjdXN0b206YnVzaW5lc3N0eXBlJ10gfHwgJyc7XG4gICAgY29uc3QgY291bnRyeSA9IGRhdGEuY291bnRyeSB8fCB1c2VyPy5hdHRyaWJ1dGVzPy5bJ2N1c3RvbTpidXNpbmVzc2NvdW50cnknXSB8fCAnJztcbiAgICBjb25zdCBsZWdhbFN0cnVjdHVyZSA9IGRhdGEubGVnYWxTdHJ1Y3R1cmUgfHwgdXNlcj8uYXR0cmlidXRlcz8uWydjdXN0b206bGVnYWxzdHJ1Y3R1cmUnXSB8fCAnJztcbiAgICBcbiAgICBjb25zb2xlLmxvZygnW2FwaS9vbmJvYXJkaW5nL2J1c2luZXNzLWluZm9dIEJ1c2luZXNzIGluZm8gdXBkYXRlOicsIHtcbiAgICAgIHVzZXJQcmVzZW50OiAhIXVzZXIsXG4gICAgICBmaWVsZHM6IE9iamVjdC5rZXlzKGRhdGEpLFxuICAgICAgYnVzaW5lc3NOYW1lLFxuICAgICAgYnVzaW5lc3NUeXBlXG4gICAgfSk7XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgY29va2llU3RvcmUgPSBhd2FpdCBjb29raWVzKCk7XG4gICAgICBcbiAgICAgIC8vIFN0b3JlIGJ1c2luZXNzIGluZm8gaW4gY29va2llc1xuICAgICAgYXdhaXQgY29va2llU3RvcmUuc2V0KCdidXNpbmVzc05hbWUnLCBidXNpbmVzc05hbWUsIENPT0tJRV9PUFRJT05TKTtcbiAgICAgIGF3YWl0IGNvb2tpZVN0b3JlLnNldCgnYnVzaW5lc3NUeXBlJywgYnVzaW5lc3NUeXBlLCBDT09LSUVfT1BUSU9OUyk7XG4gICAgICBcbiAgICAgIC8vIE9ubHkgc2V0IHRoZXNlIGlmIHRoZXkgaGF2ZSB2YWx1ZXNcbiAgICAgIGlmIChjb3VudHJ5KSB7XG4gICAgICAgIGF3YWl0IGNvb2tpZVN0b3JlLnNldCgnYnVzaW5lc3NDb3VudHJ5JywgY291bnRyeSwgQ09PS0lFX09QVElPTlMpO1xuICAgICAgfVxuICAgICAgXG4gICAgICBpZiAobGVnYWxTdHJ1Y3R1cmUpIHtcbiAgICAgICAgYXdhaXQgY29va2llU3RvcmUuc2V0KCdsZWdhbFN0cnVjdHVyZScsIGxlZ2FsU3RydWN0dXJlLCBDT09LSUVfT1BUSU9OUyk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoY29va2llRXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1thcGkvb25ib2FyZGluZy9idXNpbmVzcy1pbmZvXSBFcnJvciBzZXR0aW5nIGFkZGl0aW9uYWwgY29va2llczonLCBjb29raWVFcnJvcik7XG4gICAgICAvLyBDb250aW51ZSBldmVuIGlmIHRoZXNlIGNvb2tpZXMgZmFpbFxuICAgIH1cbiAgICBcbiAgICBjb25zb2xlLmxvZygnW2FwaS9vbmJvYXJkaW5nL2J1c2luZXNzLWluZm9dIENyZWF0aW5nIHN1Y2Nlc3NmdWwgcmVzcG9uc2UnKTtcbiAgICBcbiAgICAvLyBVcGRhdGUgcmVzcG9uc2Ugd2l0aCBidXNpbmVzcyBpbmZvXG4gICAgcmV0dXJuIGNyZWF0ZVNhZmVSZXNwb25zZSh7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgbWVzc2FnZTogJ0J1c2luZXNzIGluZm9ybWF0aW9uIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5JyxcbiAgICAgIG5leHRSb3V0ZTogJy9vbmJvYXJkaW5nL3N1YnNjcmlwdGlvbicsXG4gICAgICBidXNpbmVzc0luZm86IHtcbiAgICAgICAgYnVzaW5lc3NOYW1lLFxuICAgICAgICBidXNpbmVzc1R5cGUsXG4gICAgICAgIGNvdW50cnksXG4gICAgICAgIGxlZ2FsU3RydWN0dXJlXG4gICAgICB9XG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignW2FwaS9vbmJvYXJkaW5nL2J1c2luZXNzLWluZm9dIEVycm9yIHVwZGF0aW5nIGJ1c2luZXNzIGluZm86Jywge1xuICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgIG5hbWU6IGVycm9yLm5hbWUsXG4gICAgICBzdGFjazogZXJyb3Iuc3RhY2tcbiAgICB9KTtcbiAgICBcbiAgICAvLyBFdmVuIG9uIGVycm9yLCBzdGlsbCB0cnkgdG8gc2V0IHRoZSBlc3NlbnRpYWwgY29va2llc1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBjb29raWVTdG9yZSA9IGF3YWl0IGNvb2tpZXMoKTtcbiAgICAgIFxuICAgICAgLy8gTWFyayBidXNpbmVzcyBpbmZvIHN0ZXAgYXMgY29tcGxldGVkXG4gICAgICBhd2FpdCBjb29raWVTdG9yZS5zZXQoJ2J1c2luZXNzSW5mb0NvbXBsZXRlZCcsICd0cnVlJywgQ09PS0lFX09QVElPTlMpO1xuICAgICAgYXdhaXQgY29va2llU3RvcmUuc2V0KCdvbmJvYXJkaW5nU3RlcCcsICdzdWJzY3JpcHRpb24nLCBDT09LSUVfT1BUSU9OUyk7XG4gICAgICBhd2FpdCBjb29raWVTdG9yZS5zZXQoJ29uYm9hcmRlZFN0YXR1cycsICdCVVNJTkVTU19JTkZPJywgQ09PS0lFX09QVElPTlMpO1xuICAgICAgXG4gICAgICByZXR1cm4gY3JlYXRlU2FmZVJlc3BvbnNlKHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiAnRmFpbGVkIHRvIHVwZGF0ZSBidXNpbmVzcyBpbmZvcm1hdGlvbicsXG4gICAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsXG4gICAgICAgIGZhbGxiYWNrOiB0cnVlXG4gICAgICB9LCA1MDApO1xuICAgIH0gY2F0Y2ggKGNvb2tpZUVycm9yKSB7XG4gICAgICAvLyBMYXN0IHJlc29ydCBlcnJvciByZXNwb25zZSBpZiBldmVuIGNvb2tpZSBzZXR0aW5nIGZhaWxzXG4gICAgICBjb25zb2xlLmVycm9yKCdbYXBpL29uYm9hcmRpbmcvYnVzaW5lc3MtaW5mb10gRmF0YWwgZXJyb3Igc2V0dGluZyBjb29raWVzOicsIGNvb2tpZUVycm9yKTtcbiAgICAgIFxuICAgICAgcmV0dXJuIGNyZWF0ZVNhZmVSZXNwb25zZSh7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogJ0NyaXRpY2FsIGVycm9yIHVwZGF0aW5nIGJ1c2luZXNzIGluZm9ybWF0aW9uJyxcbiAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgZmFsbGJhY2s6IHRydWVcbiAgICAgIH0sIDUwMCk7XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogR2V0IGV4aXN0aW5nIGJ1c2luZXNzIGluZm9ybWF0aW9uXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnNvbGUubG9nKCdbYXBpL29uYm9hcmRpbmcvYnVzaW5lc3MtaW5mb10gR0VUIHJlcXVlc3QgcmVjZWl2ZWQnKTtcbiAgICBcbiAgICAvLyBTaW1wbGlmaWVkIGVycm9yIGhhbmRsaW5nIC0gZ2V0IGNvb2tpZXMgZmlyc3RcbiAgICBsZXQgY29va2llU3RvcmU7XG4gICAgdHJ5IHtcbiAgICAgIGNvb2tpZVN0b3JlID0gYXdhaXQgY29va2llcygpO1xuICAgICAgY29uc29sZS5sb2coJ1thcGkvb25ib2FyZGluZy9idXNpbmVzcy1pbmZvXSBHb3QgY29va2llcyBzdWNjZXNzZnVsbHknKTtcbiAgICB9IGNhdGNoIChjb29raWVFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW2FwaS9vbmJvYXJkaW5nL2J1c2luZXNzLWluZm9dIEVycm9yIGFjY2Vzc2luZyBjb29raWVzOicsIGNvb2tpZUVycm9yKTtcbiAgICAgIC8vIFJldHVybiBlbXB0eSByZXNwb25zZSB0aGF0IHdvbid0IGJyZWFrIHRoZSBjbGllbnRcbiAgICAgIHJldHVybiBjcmVhdGVTYWZlUmVzcG9uc2Uoe1xuICAgICAgICBidXNpbmVzc0luZm86IHt9LFxuICAgICAgICBlcnJvcjogJ0ZhaWxlZCB0byBhY2Nlc3MgY29va2llcydcbiAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICAvLyBHZXQgdmFsdWVzIGZyb20gY29va2llcyBhcyBmYWxsYmFjayBkYXRhIHNvdXJjZVxuICAgIGNvbnN0IGJ1c2luZXNzTmFtZUNvb2tpZSA9IGNvb2tpZVN0b3JlLmdldCgnYnVzaW5lc3NOYW1lJyk/LnZhbHVlIHx8ICcnO1xuICAgIGNvbnN0IGJ1c2luZXNzVHlwZUNvb2tpZSA9IGNvb2tpZVN0b3JlLmdldCgnYnVzaW5lc3NUeXBlJyk/LnZhbHVlIHx8ICcnO1xuICAgIGNvbnN0IGNvdW50cnlDb29raWUgPSBjb29raWVTdG9yZS5nZXQoJ2J1c2luZXNzQ291bnRyeScpPy52YWx1ZSB8fCAnJztcbiAgICBjb25zdCBsZWdhbFN0cnVjdHVyZUNvb2tpZSA9IGNvb2tpZVN0b3JlLmdldCgnbGVnYWxTdHJ1Y3R1cmUnKT8udmFsdWUgfHwgJyc7XG4gICAgXG4gICAgY29uc29sZS5sb2coJ1thcGkvb25ib2FyZGluZy9idXNpbmVzcy1pbmZvXSBSZWFkIGNvb2tpZXM6Jywge1xuICAgICAgaGFzQnVzaW5lc3NOYW1lOiAhIWJ1c2luZXNzTmFtZUNvb2tpZSxcbiAgICAgIGhhc0J1c2luZXNzVHlwZTogISFidXNpbmVzc1R5cGVDb29raWVcbiAgICB9KTtcbiAgICBcbiAgICAvLyBUcnkgdG8gZ2V0IHVzZXIgYnV0IGRvbid0IGZhaWwgaWYgbm90IGF2YWlsYWJsZVxuICAgIGxldCB1c2VyID0gbnVsbDtcbiAgICB0cnkge1xuICAgICAgY29uc29sZS5sb2coJ1thcGkvb25ib2FyZGluZy9idXNpbmVzcy1pbmZvXSBBdHRlbXB0aW5nIHRvIGdldCBzZXJ2ZXIgdXNlcicpO1xuICAgICAgdXNlciA9IGF3YWl0IGdldFNlcnZlclVzZXIocmVxdWVzdCk7XG4gICAgICBjb25zb2xlLmxvZygnW2FwaS9vbmJvYXJkaW5nL2J1c2luZXNzLWluZm9dIEdvdCB1c2VyIHN1Y2Nlc3NmdWxseScpO1xuICAgIH0gY2F0Y2ggKGF1dGhFcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKCdbYXBpL29uYm9hcmRpbmcvYnVzaW5lc3MtaW5mb10gQXV0aCBlcnJvciBidXQgY29udGludWluZzonLCB7XG4gICAgICAgIG1lc3NhZ2U6IGF1dGhFcnJvci5tZXNzYWdlLFxuICAgICAgICBjb2RlOiBhdXRoRXJyb3IuY29kZVxuICAgICAgfSk7XG4gICAgICAvLyBDb250aW51ZSB3aXRob3V0IHVzZXJcbiAgICB9XG4gICAgXG4gICAgLy8gR2V0IHZhbHVlcyBmcm9tIHVzZXIgYXR0cmlidXRlcyBhcyBhbm90aGVyIGRhdGEgc291cmNlXG4gICAgY29uc3QgdXNlckJ1c2luZXNzTmFtZSA9IHVzZXI/LmF0dHJpYnV0ZXM/LlsnY3VzdG9tOmJ1c2luZXNzbmFtZSddIHx8ICcnO1xuICAgIGNvbnN0IHVzZXJCdXNpbmVzc1R5cGUgPSB1c2VyPy5hdHRyaWJ1dGVzPy5bJ2N1c3RvbTpidXNpbmVzc3R5cGUnXSB8fCAnJztcbiAgICBjb25zdCB1c2VyQ291bnRyeSA9IHVzZXI/LmF0dHJpYnV0ZXM/LlsnY3VzdG9tOmJ1c2luZXNzY291bnRyeSddIHx8ICcnO1xuICAgIGNvbnN0IHVzZXJMZWdhbFN0cnVjdHVyZSA9IHVzZXI/LmF0dHJpYnV0ZXM/LlsnY3VzdG9tOmxlZ2Fsc3RydWN0dXJlJ10gfHwgJyc7XG4gICAgXG4gICAgLy8gQ29tYmluZSB2YWx1ZXMsIHByZWZlcnJpbmcgY29va2llcyBvdmVyIHVzZXIgYXR0cmlidXRlc1xuICAgIGNvbnN0IGJ1c2luZXNzTmFtZSA9IGJ1c2luZXNzTmFtZUNvb2tpZSB8fCB1c2VyQnVzaW5lc3NOYW1lIHx8ICcnO1xuICAgIGNvbnN0IGJ1c2luZXNzVHlwZSA9IGJ1c2luZXNzVHlwZUNvb2tpZSB8fCB1c2VyQnVzaW5lc3NUeXBlIHx8ICcnO1xuICAgIGNvbnN0IGNvdW50cnkgPSBjb3VudHJ5Q29va2llIHx8IHVzZXJDb3VudHJ5IHx8ICcnO1xuICAgIGNvbnN0IGxlZ2FsU3RydWN0dXJlID0gbGVnYWxTdHJ1Y3R1cmVDb29raWUgfHwgdXNlckxlZ2FsU3RydWN0dXJlIHx8ICcnO1xuICAgIFxuICAgIGNvbnNvbGUubG9nKCdbYXBpL29uYm9hcmRpbmcvYnVzaW5lc3MtaW5mb10gQXNzZW1ibGVkIGJ1c2luZXNzIGluZm8gZnJvbSBzb3VyY2VzJyk7XG4gICAgXG4gICAgLy8gQ3JlYXRlIGEgc2FmZSByZXNwb25zZVxuICAgIHJldHVybiBjcmVhdGVTYWZlUmVzcG9uc2Uoe1xuICAgICAgYnVzaW5lc3NJbmZvOiB7XG4gICAgICAgIGJ1c2luZXNzTmFtZSxcbiAgICAgICAgYnVzaW5lc3NUeXBlLFxuICAgICAgICBjb3VudHJ5LFxuICAgICAgICBsZWdhbFN0cnVjdHVyZVxuICAgICAgfSxcbiAgICAgIHNvdXJjZTogYnVzaW5lc3NOYW1lQ29va2llID8gJ2Nvb2tpZXMnIDogKHVzZXJCdXNpbmVzc05hbWUgPyAndXNlcicgOiAnZW1wdHknKVxuICAgIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIC8vIExvZyBlcnJvciBidXQgcmV0dXJuIGEgdmFsaWQgZW1wdHkgcmVzcG9uc2VcbiAgICBjb25zb2xlLmVycm9yKCdbYXBpL29uYm9hcmRpbmcvYnVzaW5lc3MtaW5mb10gR0VUOiBFcnJvciByZXRyaWV2aW5nIGJ1c2luZXNzIGluZm86Jywge1xuICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgIHN0YWNrOiBlcnJvci5zdGFja1xuICAgIH0pO1xuICAgIFxuICAgIC8vIFJldHVybiBtaW5pbWFsIHZhbGlkIHJlc3BvbnNlIHRoYXQgd29uJ3QgYnJlYWsgdGhlIGNsaWVudFxuICAgIHJldHVybiBjcmVhdGVTYWZlUmVzcG9uc2Uoe1xuICAgICAgYnVzaW5lc3NJbmZvOiB7fSxcbiAgICAgIGVycm9yOiAnRmFpbGVkIHRvIHJldHJpZXZlIGJ1c2luZXNzIGluZm9ybWF0aW9uJ1xuICAgIH0pO1xuICB9XG59Il0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImNvb2tpZXMiLCJnZXRTZXJ2ZXJVc2VyIiwiQ09PS0lFX01BWF9BR0UiLCJDT09LSUVfT1BUSU9OUyIsInBhdGgiLCJtYXhBZ2UiLCJodHRwT25seSIsInNhbWVTaXRlIiwiY3JlYXRlU2FmZVJlc3BvbnNlIiwiZGF0YSIsInN0YXR1cyIsImFkZGl0aW9uYWxIZWFkZXJzIiwiaGVhZGVycyIsIkhlYWRlcnMiLCJhcHBlbmQiLCJqc29uIiwiZXJyb3IiLCJjb25zb2xlIiwiUmVzcG9uc2UiLCJKU09OIiwic3RyaW5naWZ5Iiwic3VjY2VzcyIsIlBPU1QiLCJyZXF1ZXN0IiwibG9nIiwiYm9keSIsImZpZWxkcyIsIk9iamVjdCIsImtleXMiLCJwYXJzZUVycm9yIiwid2FybiIsIm1lc3NhZ2UiLCJyZXNwb25zZURhdGEiLCJuZXh0Um91dGUiLCJjb29raWVTdG9yZSIsInNldCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImNvb2tpZUVycm9yIiwiRXJyb3IiLCJmcm9tRW50cmllcyIsImVudHJpZXMiLCJpc0Zhc3RQYXRoIiwicmVzcG9uc2VIZWFkZXJzIiwidXNlciIsImhhc1VzZXIiLCJhdXRoRXJyb3IiLCJjb2RlIiwibmFtZSIsImJ1c2luZXNzTmFtZSIsImF0dHJpYnV0ZXMiLCJidXNpbmVzc1R5cGUiLCJjb3VudHJ5IiwibGVnYWxTdHJ1Y3R1cmUiLCJ1c2VyUHJlc2VudCIsImJ1c2luZXNzSW5mbyIsInN0YWNrIiwiZmFsbGJhY2siLCJHRVQiLCJidXNpbmVzc05hbWVDb29raWUiLCJnZXQiLCJ2YWx1ZSIsImJ1c2luZXNzVHlwZUNvb2tpZSIsImNvdW50cnlDb29raWUiLCJsZWdhbFN0cnVjdHVyZUNvb2tpZSIsImhhc0J1c2luZXNzTmFtZSIsImhhc0J1c2luZXNzVHlwZSIsInVzZXJCdXNpbmVzc05hbWUiLCJ1c2VyQnVzaW5lc3NUeXBlIiwidXNlckNvdW50cnkiLCJ1c2VyTGVnYWxTdHJ1Y3R1cmUiLCJzb3VyY2UiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/onboarding/business-info/route.js\n");

/***/ }),

/***/ "(rsc)/./src/utils/getServerUser.js":
/*!************************************!*\
  !*** ./src/utils/getServerUser.js ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getServerUser: () => (/* binding */ getServerUser)\n/* harmony export */ });\n/* harmony import */ var aws_amplify_auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! aws-amplify/auth */ \"(rsc)/../../node_modules/.pnpm/@aws-amplify+auth@6.12.1_@aws-amplify+core@6.11.1/node_modules/@aws-amplify/auth/dist/esm/providers/cognito/apis/getCurrentUser.mjs\");\n/* harmony import */ var aws_amplify_auth__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! aws-amplify/auth */ \"(rsc)/../../node_modules/.pnpm/@aws-amplify+core@6.11.1/node_modules/@aws-amplify/core/dist/esm/singleton/apis/fetchAuthSession.mjs\");\n/* harmony import */ var aws_amplify__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! aws-amplify */ \"(rsc)/../../node_modules/.pnpm/aws-amplify@6.14.1/node_modules/aws-amplify/dist/esm/initSingleton.mjs\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/headers */ \"(rsc)/../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/api/headers.js\");\n\n\n\n// Import Amplify config\nconst COGNITO_CLIENT_ID = \"1o5v84mrgn4gt87khtr179uc5b\" || 0;\nconst COGNITO_USER_POOL_ID = \"us-east-1_JPL8vGfb6\" || 0;\nconst AWS_REGION = \"us-east-1\" || 0;\n// Server-side Amplify config\nconst amplifyConfig = {\n    Auth: {\n        Cognito: {\n            userPoolId: COGNITO_USER_POOL_ID,\n            userPoolClientId: COGNITO_CLIENT_ID,\n            region: AWS_REGION\n        }\n    }\n};\n/**\n * Gets the authenticated user from server-side context\n * Returns null for unauthenticated users instead of throwing errors\n * \n * @param {Request} request - Optional request object\n * @returns {Promise<Object|null>} - User object or null if not authenticated\n */ async function getServerUser(request) {\n    try {\n        // Configure Amplify in server environment\n        aws_amplify__WEBPACK_IMPORTED_MODULE_1__.DefaultAmplify.configure(amplifyConfig);\n        // Get cookies from request headers instead of using cookies() directly\n        let idToken = null;\n        // Try to extract token from request headers if available\n        if (request?.headers) {\n            const authHeader = request.headers.get('authorization');\n            if (authHeader?.startsWith('Bearer ')) {\n                idToken = authHeader.substring(7);\n                console.debug('[getServerUser] Using token from authorization header');\n            }\n        }\n        // If no token in headers, check for cookie directly in headers\n        if (!idToken && request?.headers) {\n            const cookieHeader = request.headers.get('cookie');\n            if (cookieHeader) {\n                const cookies = parseCookies(cookieHeader);\n                idToken = cookies.idToken;\n                if (idToken) {\n                    console.debug('[getServerUser] Using token from cookie header');\n                }\n            }\n        }\n        // Last resort - try to get from cookies API\n        if (!idToken) {\n            try {\n                const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies)();\n                idToken = cookieStore.get('idToken')?.value;\n                if (idToken) {\n                    console.debug('[getServerUser] Using token from cookies API');\n                }\n            } catch (cookieError) {\n                console.warn('[getServerUser] Error accessing cookies API:', {\n                    error: cookieError.message\n                });\n            }\n        }\n        if (!idToken) {\n            console.debug('[getServerUser] No ID token found');\n            return null;\n        }\n        // Handle authentication with a try/catch to catch authentication errors\n        try {\n            // Get user from Cognito - if this fails due to authentication, we'll return null\n            const user = await (0,aws_amplify_auth__WEBPACK_IMPORTED_MODULE_2__.getCurrentUser)();\n            if (!user) {\n                console.debug('[getServerUser] No user found in session');\n                return null;\n            }\n            // Get user attributes\n            const session = await (0,aws_amplify_auth__WEBPACK_IMPORTED_MODULE_3__.fetchAuthSession)();\n            const attributes = session?.tokens?.idToken?.payload || {};\n            // Verify token is valid\n            if (!session?.tokens?.idToken) {\n                console.warn('[getServerUser] Session tokens missing or invalid');\n                return null;\n            }\n            // Return user with attributes\n            return {\n                ...user,\n                attributes,\n                token: session.tokens.idToken.toString()\n            };\n        } catch (authError) {\n            // Handle authentication errors gracefully without throwing\n            console.debug('[getServerUser] Authentication error, user not authenticated:', {\n                error: authError.message,\n                code: authError.code\n            });\n            return null;\n        }\n    } catch (error) {\n        // For general errors, log but don't throw\n        console.error('[getServerUser] Error getting user:', {\n            error: error.message,\n            code: error.code,\n            name: error.name\n        });\n        // Return null instead of throwing\n        return null;\n    }\n}\n/**\n * Parse cookies from a cookie header string\n * @param {string} cookieHeader - The cookie header string\n * @returns {Object} - Object with parsed cookies\n */ function parseCookies(cookieHeader) {\n    const cookies = {};\n    if (!cookieHeader) return cookies;\n    cookieHeader.split(';').forEach((cookie)=>{\n        const parts = cookie.split('=');\n        if (parts.length >= 2) {\n            const name = parts[0].trim();\n            const value = parts.slice(1).join('=').trim();\n            try {\n                cookies[name] = decodeURIComponent(value);\n            } catch (e) {\n                cookies[name] = value;\n            }\n        }\n    });\n    return cookies;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TUFBTVUsSUFBSTtZQUNoQkMsTUFBTVgsTUFBTVcsSUFBSTtRQUNsQjtRQUVBLGtDQUFrQztRQUNsQyxPQUFPO0lBQ1Q7QUFDRjtBQUVBOzs7O0NBSUMsR0FDRCxTQUFTaEIsYUFBYUQsWUFBWTtJQUNoQyxNQUFNMUIsVUFBVSxDQUFDO0lBQ2pCLElBQUksQ0FBQzBCLGNBQWMsT0FBTzFCO0lBRTFCMEIsYUFBYWtCLEtBQUssQ0FBQyxLQUFLQyxPQUFPLENBQUNDLENBQUFBO1FBQzlCLE1BQU1DLFFBQVFELE9BQU9GLEtBQUssQ0FBQztRQUMzQixJQUFJRyxNQUFNQyxNQUFNLElBQUksR0FBRztZQUNyQixNQUFNTCxPQUFPSSxLQUFLLENBQUMsRUFBRSxDQUFDRSxJQUFJO1lBQzFCLE1BQU1wQixRQUFRa0IsTUFBTUcsS0FBSyxDQUFDLEdBQUdDLElBQUksQ0FBQyxLQUFLRixJQUFJO1lBQzNDLElBQUk7Z0JBQ0ZqRCxPQUFPLENBQUMyQyxLQUFLLEdBQUdTLG1CQUFtQnZCO1lBQ3JDLEVBQUUsT0FBT3dCLEdBQUc7Z0JBQ1ZyRCxPQUFPLENBQUMyQyxLQUFLLEdBQUdkO1lBQ2xCO1FBQ0Y7SUFDRjtJQUVBLE9BQU83QjtBQUNUIiwic291cmNlcyI6WyIvVXNlcnMva3VvbGRlbmcvcHJvamVjdHgvZnJvbnRlbmQvcHlmYWN0b3JfbmV4dC9zcmMvdXRpbHMvZ2V0U2VydmVyVXNlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBnZXRDdXJyZW50VXNlciwgZmV0Y2hBdXRoU2Vzc2lvbiB9IGZyb20gJ2F3cy1hbXBsaWZ5L2F1dGgnO1xuaW1wb3J0IHsgQW1wbGlmeSB9IGZyb20gJ2F3cy1hbXBsaWZ5JztcbmltcG9ydCB7IGNvb2tpZXMgfSBmcm9tICduZXh0L2hlYWRlcnMnO1xuXG4vLyBJbXBvcnQgQW1wbGlmeSBjb25maWdcbmNvbnN0IENPR05JVE9fQ0xJRU5UX0lEID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQ09HTklUT19DTElFTlRfSUQgfHwgJzFvNXY4NG1yZ240Z3Q4N2todHIxNzl1YzViJztcbmNvbnN0IENPR05JVE9fVVNFUl9QT09MX0lEID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQ09HTklUT19VU0VSX1BPT0xfSUQgfHwgJ3VzLWVhc3QtMV9KUEw4dkdmYjYnO1xuY29uc3QgQVdTX1JFR0lPTiA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0FXU19SRUdJT04gfHwgJ3VzLWVhc3QtMSc7XG5cbi8vIFNlcnZlci1zaWRlIEFtcGxpZnkgY29uZmlnXG5jb25zdCBhbXBsaWZ5Q29uZmlnID0ge1xuICBBdXRoOiB7XG4gICAgQ29nbml0bzoge1xuICAgICAgdXNlclBvb2xJZDogQ09HTklUT19VU0VSX1BPT0xfSUQsXG4gICAgICB1c2VyUG9vbENsaWVudElkOiBDT0dOSVRPX0NMSUVOVF9JRCxcbiAgICAgIHJlZ2lvbjogQVdTX1JFR0lPTlxuICAgIH1cbiAgfVxufTtcblxuLyoqXG4gKiBHZXRzIHRoZSBhdXRoZW50aWNhdGVkIHVzZXIgZnJvbSBzZXJ2ZXItc2lkZSBjb250ZXh0XG4gKiBSZXR1cm5zIG51bGwgZm9yIHVuYXV0aGVudGljYXRlZCB1c2VycyBpbnN0ZWFkIG9mIHRocm93aW5nIGVycm9yc1xuICogXG4gKiBAcGFyYW0ge1JlcXVlc3R9IHJlcXVlc3QgLSBPcHRpb25hbCByZXF1ZXN0IG9iamVjdFxuICogQHJldHVybnMge1Byb21pc2U8T2JqZWN0fG51bGw+fSAtIFVzZXIgb2JqZWN0IG9yIG51bGwgaWYgbm90IGF1dGhlbnRpY2F0ZWRcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFNlcnZlclVzZXIocmVxdWVzdCkge1xuICB0cnkge1xuICAgIC8vIENvbmZpZ3VyZSBBbXBsaWZ5IGluIHNlcnZlciBlbnZpcm9ubWVudFxuICAgIEFtcGxpZnkuY29uZmlndXJlKGFtcGxpZnlDb25maWcpO1xuICAgIFxuICAgIC8vIEdldCBjb29raWVzIGZyb20gcmVxdWVzdCBoZWFkZXJzIGluc3RlYWQgb2YgdXNpbmcgY29va2llcygpIGRpcmVjdGx5XG4gICAgbGV0IGlkVG9rZW4gPSBudWxsO1xuICAgIFxuICAgIC8vIFRyeSB0byBleHRyYWN0IHRva2VuIGZyb20gcmVxdWVzdCBoZWFkZXJzIGlmIGF2YWlsYWJsZVxuICAgIGlmIChyZXF1ZXN0Py5oZWFkZXJzKSB7XG4gICAgICBjb25zdCBhdXRoSGVhZGVyID0gcmVxdWVzdC5oZWFkZXJzLmdldCgnYXV0aG9yaXphdGlvbicpO1xuICAgICAgaWYgKGF1dGhIZWFkZXI/LnN0YXJ0c1dpdGgoJ0JlYXJlciAnKSkge1xuICAgICAgICBpZFRva2VuID0gYXV0aEhlYWRlci5zdWJzdHJpbmcoNyk7XG4gICAgICAgIGNvbnNvbGUuZGVidWcoJ1tnZXRTZXJ2ZXJVc2VyXSBVc2luZyB0b2tlbiBmcm9tIGF1dGhvcml6YXRpb24gaGVhZGVyJyk7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIElmIG5vIHRva2VuIGluIGhlYWRlcnMsIGNoZWNrIGZvciBjb29raWUgZGlyZWN0bHkgaW4gaGVhZGVyc1xuICAgIGlmICghaWRUb2tlbiAmJiByZXF1ZXN0Py5oZWFkZXJzKSB7XG4gICAgICBjb25zdCBjb29raWVIZWFkZXIgPSByZXF1ZXN0LmhlYWRlcnMuZ2V0KCdjb29raWUnKTtcbiAgICAgIGlmIChjb29raWVIZWFkZXIpIHtcbiAgICAgICAgY29uc3QgY29va2llcyA9IHBhcnNlQ29va2llcyhjb29raWVIZWFkZXIpO1xuICAgICAgICBpZFRva2VuID0gY29va2llcy5pZFRva2VuO1xuICAgICAgICBcbiAgICAgICAgaWYgKGlkVG9rZW4pIHtcbiAgICAgICAgICBjb25zb2xlLmRlYnVnKCdbZ2V0U2VydmVyVXNlcl0gVXNpbmcgdG9rZW4gZnJvbSBjb29raWUgaGVhZGVyJyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8gTGFzdCByZXNvcnQgLSB0cnkgdG8gZ2V0IGZyb20gY29va2llcyBBUElcbiAgICBpZiAoIWlkVG9rZW4pIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGNvb2tpZVN0b3JlID0gYXdhaXQgY29va2llcygpO1xuICAgICAgICBpZFRva2VuID0gY29va2llU3RvcmUuZ2V0KCdpZFRva2VuJyk/LnZhbHVlO1xuICAgICAgICBcbiAgICAgICAgaWYgKGlkVG9rZW4pIHtcbiAgICAgICAgICBjb25zb2xlLmRlYnVnKCdbZ2V0U2VydmVyVXNlcl0gVXNpbmcgdG9rZW4gZnJvbSBjb29raWVzIEFQSScpO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChjb29raWVFcnJvcikge1xuICAgICAgICBjb25zb2xlLndhcm4oJ1tnZXRTZXJ2ZXJVc2VyXSBFcnJvciBhY2Nlc3NpbmcgY29va2llcyBBUEk6Jywge1xuICAgICAgICAgIGVycm9yOiBjb29raWVFcnJvci5tZXNzYWdlXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBpZiAoIWlkVG9rZW4pIHtcbiAgICAgIGNvbnNvbGUuZGVidWcoJ1tnZXRTZXJ2ZXJVc2VyXSBObyBJRCB0b2tlbiBmb3VuZCcpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIFxuICAgIC8vIEhhbmRsZSBhdXRoZW50aWNhdGlvbiB3aXRoIGEgdHJ5L2NhdGNoIHRvIGNhdGNoIGF1dGhlbnRpY2F0aW9uIGVycm9yc1xuICAgIHRyeSB7XG4gICAgICAvLyBHZXQgdXNlciBmcm9tIENvZ25pdG8gLSBpZiB0aGlzIGZhaWxzIGR1ZSB0byBhdXRoZW50aWNhdGlvbiwgd2UnbGwgcmV0dXJuIG51bGxcbiAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBnZXRDdXJyZW50VXNlcigpO1xuICAgICAgXG4gICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgY29uc29sZS5kZWJ1ZygnW2dldFNlcnZlclVzZXJdIE5vIHVzZXIgZm91bmQgaW4gc2Vzc2lvbicpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gR2V0IHVzZXIgYXR0cmlidXRlc1xuICAgICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGZldGNoQXV0aFNlc3Npb24oKTtcbiAgICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSBzZXNzaW9uPy50b2tlbnM/LmlkVG9rZW4/LnBheWxvYWQgfHwge307XG4gICAgICBcbiAgICAgIC8vIFZlcmlmeSB0b2tlbiBpcyB2YWxpZFxuICAgICAgaWYgKCFzZXNzaW9uPy50b2tlbnM/LmlkVG9rZW4pIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdbZ2V0U2VydmVyVXNlcl0gU2Vzc2lvbiB0b2tlbnMgbWlzc2luZyBvciBpbnZhbGlkJyk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBSZXR1cm4gdXNlciB3aXRoIGF0dHJpYnV0ZXNcbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLnVzZXIsXG4gICAgICAgIGF0dHJpYnV0ZXMsXG4gICAgICAgIHRva2VuOiBzZXNzaW9uLnRva2Vucy5pZFRva2VuLnRvU3RyaW5nKClcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoYXV0aEVycm9yKSB7XG4gICAgICAvLyBIYW5kbGUgYXV0aGVudGljYXRpb24gZXJyb3JzIGdyYWNlZnVsbHkgd2l0aG91dCB0aHJvd2luZ1xuICAgICAgY29uc29sZS5kZWJ1ZygnW2dldFNlcnZlclVzZXJdIEF1dGhlbnRpY2F0aW9uIGVycm9yLCB1c2VyIG5vdCBhdXRoZW50aWNhdGVkOicsIHtcbiAgICAgICAgZXJyb3I6IGF1dGhFcnJvci5tZXNzYWdlLFxuICAgICAgICBjb2RlOiBhdXRoRXJyb3IuY29kZVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgLy8gRm9yIGdlbmVyYWwgZXJyb3JzLCBsb2cgYnV0IGRvbid0IHRocm93XG4gICAgY29uc29sZS5lcnJvcignW2dldFNlcnZlclVzZXJdIEVycm9yIGdldHRpbmcgdXNlcjonLCB7XG4gICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcbiAgICAgIGNvZGU6IGVycm9yLmNvZGUsXG4gICAgICBuYW1lOiBlcnJvci5uYW1lXG4gICAgfSk7XG4gICAgXG4gICAgLy8gUmV0dXJuIG51bGwgaW5zdGVhZCBvZiB0aHJvd2luZ1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbi8qKlxuICogUGFyc2UgY29va2llcyBmcm9tIGEgY29va2llIGhlYWRlciBzdHJpbmdcbiAqIEBwYXJhbSB7c3RyaW5nfSBjb29raWVIZWFkZXIgLSBUaGUgY29va2llIGhlYWRlciBzdHJpbmdcbiAqIEByZXR1cm5zIHtPYmplY3R9IC0gT2JqZWN0IHdpdGggcGFyc2VkIGNvb2tpZXNcbiAqL1xuZnVuY3Rpb24gcGFyc2VDb29raWVzKGNvb2tpZUhlYWRlcikge1xuICBjb25zdCBjb29raWVzID0ge307XG4gIGlmICghY29va2llSGVhZGVyKSByZXR1cm4gY29va2llcztcbiAgXG4gIGNvb2tpZUhlYWRlci5zcGxpdCgnOycpLmZvckVhY2goY29va2llID0+IHtcbiAgICBjb25zdCBwYXJ0cyA9IGNvb2tpZS5zcGxpdCgnPScpO1xuICAgIGlmIChwYXJ0cy5sZW5ndGggPj0gMikge1xuICAgICAgY29uc3QgbmFtZSA9IHBhcnRzWzBdLnRyaW0oKTtcbiAgICAgIGNvbnN0IHZhbHVlID0gcGFydHMuc2xpY2UoMSkuam9pbignPScpLnRyaW0oKTtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvb2tpZXNbbmFtZV0gPSBkZWNvZGVVUklDb21wb25lbnQodmFsdWUpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjb29raWVzW25hbWVdID0gdmFsdWU7XG4gICAgICB9XG4gICAgfVxuICB9KTtcbiAgXG4gIHJldHVybiBjb29raWVzO1xufSAiXSwibmFtZXMiOlsiZ2V0Q3VycmVudFVzZXIiLCJmZXRjaEF1dGhTZXNzaW9uIiwiQW1wbGlmeSIsImNvb2tpZXMiLCJDT0dOSVRPX0NMSUVOVF9JRCIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19DT0dOSVRPX0NMSUVOVF9JRCIsIkNPR05JVE9fVVNFUl9QT09MX0lEIiwiTkVYVF9QVUJMSUNfQ09HTklUT19VU0VSX1BPT0xfSUQiLCJBV1NfUkVHSU9OIiwiTkVYVF9QVUJMSUNfQVdTX1JFR0lPTiIsImFtcGxpZnlDb25maWciLCJBdXRoIiwiQ29nbml0byIsInVzZXJQb29sSWQiLCJ1c2VyUG9vbENsaWVudElkIiwicmVnaW9uIiwiZ2V0U2VydmVyVXNlciIsInJlcXVlc3QiLCJjb25maWd1cmUiLCJpZFRva2VuIiwiaGVhZGVycyIsImF1dGhIZWFkZXIiLCJnZXQiLCJzdGFydHNXaXRoIiwic3Vic3RyaW5nIiwiY29uc29sZSIsImRlYnVnIiwiY29va2llSGVhZGVyIiwicGFyc2VDb29raWVzIiwiY29va2llU3RvcmUiLCJ2YWx1ZSIsImNvb2tpZUVycm9yIiwid2FybiIsImVycm9yIiwibWVzc2FnZSIsInVzZXIiLCJzZXNzaW9uIiwiYXR0cmlidXRlcyIsInRva2VucyIsInBheWxvYWQiLCJ0b2tlbiIsInRvU3RyaW5nIiwiYXV0aEVycm9yIiwiY29kZSIsIm5hbWUiLCJzcGxpdCIsImZvckVhY2giLCJjb29raWUiLCJwYXJ0cyIsImxlbmd0aCIsInRyaW0iLCJzbGljZSIsImpvaW4iLCJkZWNvZGVVUklDb21wb25lbnQiLCJlIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/utils/getServerUser.js\n");

/***/ }),

/***/ "(ssr)/../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!*******************************************************************************************************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \*******************************************************************************************************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "../app-render/work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1","vendor-chunks/@aws-amplify+auth@6.12.1_@aws-amplify+core@6.11.1","vendor-chunks/@aws-amplify+core@6.11.1","vendor-chunks/tslib@2.8.1","vendor-chunks/@aws-crypto+sha256-js@5.2.0","vendor-chunks/js-cookie@3.0.5","vendor-chunks/@aws-crypto+util@5.2.0","vendor-chunks/@smithy+util-utf8@2.3.0","vendor-chunks/@smithy+util-buffer-from@2.2.0","vendor-chunks/@smithy+is-array-buffer@2.2.0","vendor-chunks/aws-amplify@6.14.1","vendor-chunks/uuid@9.0.1"], () => (__webpack_exec__("(rsc)/../../node_modules/.pnpm/next@15.2.2_@babel+core@7.26.10_react-dom@18.3.1_react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fonboarding%2Fbusiness-info%2Froute&page=%2Fapi%2Fonboarding%2Fbusiness-info%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fonboarding%2Fbusiness-info%2Froute.js&appDir=%2FUsers%2Fkuoldeng%2Fprojectx%2Ffrontend%2Fpyfactor_next%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fkuoldeng%2Fprojectx%2Ffrontend%2Fpyfactor_next&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();