option_settings:
  aws:elasticbeanstalk:application:environment:
    DJANGO_SETTINGS_MODULE: pyfactor.settings_eb
    PYTHONPATH: /var/app/current
    EB_ENV_NAME: pyfactor-prod
    DEBUG: "False"
    
  aws:elasticbeanstalk:container:python:
    WSGIPath: application.py
    
  aws:elasticbeanstalk:environment:proxy:
    ProxyServer: apache
    
  aws:elasticbeanstalk:environment:process:default:
    HealthCheckPath: /health/
    HealthCheckTimeout: 30
    HealthCheckInterval: 30
    
  aws:autoscaling:launchconfiguration:
    DisableIMDSv1: true
    IamInstanceProfile: aws-elasticbeanstalk-ec2-role
    InstanceType: t3.small
    
  aws:elasticbeanstalk:cloudwatch:logs:
    StreamLogs: true
    DeleteOnTerminate: false
    RetentionInDays: 7

packages:
  yum:
    # postgresql-devel removed for AL2023 compatibility
    gcc: []
    python3-devel: []

commands:
  01_setup_environment:
    command: |
      echo 'export PYTHONPATH=/var/app/current' >> /etc/environment
      echo 'export DJANGO_SETTINGS_MODULE=pyfactor.settings_eb' >> /etc/environment
