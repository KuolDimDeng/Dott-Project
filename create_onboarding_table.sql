CREATE TABLE onboarding_onboardingprogress (id uuid PRIMARY KEY, user_id uuid NOT NULL UNIQUE REFERENCES custom_auth_user(id) ON DELETE CASCADE, business_id uuid NULL, onboarding_status varchar(50) NOT NULL DEFAULT 'business-info', current_step varchar(50) NOT NULL DEFAULT 'business-info', next_step varchar(50) NOT NULL DEFAULT 'subscription', completed_steps jsonb NOT NULL DEFAULT '[]', selected_plan varchar(20) NOT NULL DEFAULT 'free', subscription_plan varchar(20) NULL DEFAULT 'free', subscription_status varchar(20) NULL, billing_cycle varchar(20) NULL DEFAULT 'monthly', payment_completed boolean NOT NULL DEFAULT false, payment_method varchar(50) NULL, payment_id varchar(100) NULL, payment_timestamp timestamptz NULL, rls_setup_completed boolean NOT NULL DEFAULT false, rls_setup_timestamp timestamptz NULL, setup_completed boolean NOT NULL DEFAULT false, setup_timestamp timestamptz NULL, setup_error text NULL, database_setup_task_id varchar(255) NULL, schema_name varchar(63) NULL, created_at timestamptz NOT NULL DEFAULT now(), updated_at timestamptz NOT NULL DEFAULT now(), completed_at timestamptz NULL, account_status varchar(20) NOT NULL DEFAULT 'pending', user_role varchar(20) NOT NULL DEFAULT 'owner', attribute_version varchar(10) NOT NULL DEFAULT '1.0.0', preferences jsonb NULL, metadata jsonb NULL);
